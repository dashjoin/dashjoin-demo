"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[421],{13837:function(e,t,n){n.r(t),n.d(t,{Workbook:function(){return eD}});var l=n(40393),o=n(67294),a=n(12902),r=n(96486),c=n.n(r);function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);t&&(l=l.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,l)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach(function(t){d(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function s(e,t,n,l,o,a,r){try{var c=e[a](r),i=c.value}catch(e){n(e);return}c.done?t(i):Promise.resolve(i).then(l,o)}function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function m(){return(m=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var l in n)Object.prototype.hasOwnProperty.call(n,l)&&(e[l]=n[l])}return e}).apply(this,arguments)}function f(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,l,o=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=o){var a=[],r=!0,c=!1;try{for(o=o.call(e);!(r=(n=o.next()).done)&&(a.push(n.value),!t||a.length!==t);r=!0);}catch(e){c=!0,l=e}finally{try{r||null==o.return||o.return()}finally{if(c)throw l}}return a}}(e,t)||v(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(e){return function(e){if(Array.isArray(e))return p(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||v(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(e,t){if(e){if("string"==typeof e)return p(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return p(e,t)}}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,l=Array(t);n<t;n++)l[n]=e[n];return l}var y={globalCache:{undoList:[],redoList:[]},cellInput:o.createRef(),fxInput:o.createRef(),canvas:o.createRef(),cellArea:o.createRef(),workbookContainer:o.createRef()},k=o.createContext({context:(0,l.OfP)(y),setContext:function(){},settings:l.heV,handleUndo:function(){},handleRedo:function(){},refs:{globalCache:{undoList:[],redoList:[]},cellInput:o.createRef(),fxInput:o.createRef(),canvas:o.createRef(),scrollbarX:o.createRef(),scrollbarY:o.createRef(),cellArea:o.createRef(),workbookContainer:o.createRef()}}),g=function(e){var t=e.width,n=e.height,l=e.name,a=e.style;return o.createElement("svg",{width:void 0===t?24:t,height:void 0===n?24:n,style:a},o.createElement("use",{xlinkHref:"#".concat(l)}))},E=function(){var e,t=(0,o.useContext)(k),n=t.context,a=t.setContext,r=t.settings,i=t.refs,u=(0,o.useRef)(null),s=(0,o.useRef)(null),d=f((0,o.useState)({col:-1,col_pre:-1,col_index:-1}),2),m=d[0],h=d[1],v=f((0,o.useState)(!1),2),p=v[0],y=v[1],E=f((0,o.useState)([]),2),C=E[0],b=E[1],x=(0,o.useRef)(!0),w=(0,l.Q8D)(n,n.currentSheetId),N=null==w?null:n.luckysheetfile[w],_=(0,o.useMemo)(function(){var e,t,o,a,r,c;return(null==N?void 0:null===(e=N.frozen)||void 0===e?void 0:e.type)==="column"||(null==N?void 0:null===(t=N.frozen)||void 0===t?void 0:t.type)==="rangeColumn"||(null==N?void 0:null===(o=N.frozen)||void 0===o?void 0:o.type)==="rangeBoth"||(null==N?void 0:null===(a=N.frozen)||void 0===a?void 0:a.type)==="both"?(0,l.Fzq)((null==N?void 0:null===(r=N.frozen)||void 0===r?void 0:null===(c=r.range)||void 0===c?void 0:c.column_focus)||0,n.visibledatacolumn)[1]-2+n.scrollLeft:n.scrollLeft},[n.visibledatacolumn,null==N?void 0:N.frozen,n.scrollLeft]),R=(0,o.useCallback)(function(e){if(!n.luckysheet_cols_change_size){var t,o=e.pageX-u.current.getBoundingClientRect().left-window.scrollX,a=o+u.current.scrollLeft,r=null===(t=i.globalCache.freezen)||void 0===t?void 0:t[n.currentSheetId],s=(0,l.Aph)(r,a,0,o,0),d=s.x,v=s.inVerticalFreeze,p=(0,l.l_B)(d,n.visibledatacolumn),k=f(p,3),g=k[0],E=k[1],C=k[2];C!==m.col_index&&(h({col_pre:g,col:E,col_index:C}),y(v));var b=(0,l.Fkv)(n);c().isNil(b)||(x.current=(0,l.RhZ)(n)&&(0,l.RhZ)(n,[{row:[0,b.length-1],column:p}]))}},[n,m.col_index,i.globalCache.freezen]),M=(0,o.useCallback)(function(e){var t=e.nativeEvent;a(function(e){(0,l.z5o)(e,i.globalCache,t,u.current,i.cellInput.current,i.fxInput.current)})},[i.globalCache,i.cellInput,i.fxInput,a]),S=(0,o.useCallback)(function(){n.luckysheet_cols_change_size||h({col:-1,col_pre:-1,col_index:-1})},[n.luckysheet_cols_change_size]),L=(0,o.useCallback)(function(e){var t=e.nativeEvent;a(function(e){(0,l.dj7)(e,i.globalCache,t,u.current,i.workbookContainer.current,i.cellArea.current)}),e.stopPropagation()},[i.cellArea,i.globalCache,i.workbookContainer,a]),V=(0,o.useCallback)(function(e){var t=e.nativeEvent;a(function(e){(0,l.NfN)(e,i.globalCache,t,u.current,i.workbookContainer.current,i.cellArea.current)}),e.stopPropagation()},[i.cellArea,i.globalCache,i.workbookContainer,a]),H=(0,o.useCallback)(function(e){var t=e.nativeEvent;a(function(e){(0,l.keM)(e,r,t,i.workbookContainer.current,i.cellArea.current,"columnHeader")})},[i.workbookContainer,a,r,i.cellArea]);return(0,o.useEffect)(function(){var e=n.luckysheet_select_save;if(!c().isNil(e)){for(var t={},o=0;o<e.length;o+=1){var a=e[o].column[0],r=e[o].column[1];t=(0,l.RF$)(t,a,r)}for(var i=(0,l.Ir3)(t),u=[],s=0;s<i.length;s+=1){var d=i[s][0],m=i[s][i[s].length-1],f=(0,l.Fzq)(m,n.visibledatacolumn)[1],h=(0,l.Fzq)(d,n.visibledatacolumn)[0];c().isNumber(f)&&c().isNumber(h)&&u.push({col:f,col_pre:h,c1:d,c2:m})}b(u)}},[n.luckysheet_select_save,n.visibledatacolumn]),(0,o.useEffect)(function(){u.current.scrollLeft=n.scrollLeft},[n.scrollLeft]),o.createElement("div",{ref:u,className:"fortune-col-header",style:{height:n.columnHeaderHeight-1.5},onMouseMove:R,onMouseDown:M,onMouseLeave:S,onContextMenu:H},o.createElement("div",{className:"fortune-cols-freeze-handle",onMouseDown:V,style:{left:_}}),o.createElement("div",{className:"fortune-cols-change-size",ref:s,id:"fortune-cols-change-size",onMouseDown:L,style:{left:m.col-5+(p?n.scrollLeft:0),opacity:n.luckysheet_cols_change_size?1:0}}),!n.luckysheet_cols_change_size&&m.col_index>=0?o.createElement("div",{className:"fortune-col-header-hover",style:c().assign({left:m.col_pre,width:m.col-m.col_pre-1,display:"block"},(0,l.gDh)(n,m.col_index,m.col_index,null===(e=i.globalCache.freezen)||void 0===e?void 0:e[n.currentSheetId]))},x.current&&o.createElement("span",{className:"header-arrow",onClick:function(e){a(function(t){t.contextMenu={x:e.pageX,y:90,headerMenu:!0}})}},o.createElement(g,{name:"headDownArrow",width:12}))):null,C.map(function(e,t){var a,r=e.col,u=e.col_pre,s=e.c1,d=e.c2;return o.createElement("div",{className:"fortune-col-header-selected",key:t,style:c().assign({left:u,width:r-u-1,display:"block",backgroundColor:"rgba(76, 76, 76, 0.1)"},(0,l.gDh)(n,s,d,null===(a=i.globalCache.freezen)||void 0===a?void 0:a[n.currentSheetId]))})}),o.createElement("div",{className:"luckysheet-cols-h-cells luckysheetsheetchange",id:"luckysheet-cols-h-cells_0",style:{width:n.ch_width,height:1}},o.createElement("div",{className:"luckysheet-cols-h-cells-c"},o.createElement("div",{className:"luckysheet-grdblkpush"}))))},C=function(){var e,t=(0,o.useContext)(k),n=t.context,a=t.setContext,r=t.settings,i=t.refs,u=(0,o.useRef)(null),s=(0,o.useRef)(null),d=f((0,o.useState)({row:-1,row_pre:-1,row_index:-1}),2),m=d[0],h=d[1],v=f((0,o.useState)(!1),2),p=v[0],y=v[1],g=f((0,o.useState)([]),2),E=g[0],C=g[1],b=(0,l.Q8D)(n,n.currentSheetId),x=null==b?null:n.luckysheetfile[b],w=(0,o.useMemo)(function(){var e,t,o,a,r,c;return(null==x?void 0:null===(e=x.frozen)||void 0===e?void 0:e.type)==="row"||(null==x?void 0:null===(t=x.frozen)||void 0===t?void 0:t.type)==="rangeRow"||(null==x?void 0:null===(o=x.frozen)||void 0===o?void 0:o.type)==="rangeBoth"||(null==x?void 0:null===(a=x.frozen)||void 0===a?void 0:a.type)==="both"?(0,l.L3O)((null==x?void 0:null===(r=x.frozen)||void 0===r?void 0:null===(c=r.range)||void 0===c?void 0:c.row_focus)||0,n.visibledatarow)[1]+n.scrollTop:n.scrollTop},[n.visibledatarow,null==x?void 0:x.frozen,n.scrollTop]),N=(0,o.useCallback)(function(e){if(!n.luckysheet_rows_change_size){var t,o=e.pageY-s.current.getBoundingClientRect().top-window.scrollY,a=o+s.current.scrollTop,r=null===(t=i.globalCache.freezen)||void 0===t?void 0:t[n.currentSheetId],c=(0,l.Aph)(r,0,a,0,o),u=c.y,d=c.inHorizontalFreeze,v=f((0,l.svo)(u,n.visibledatarow),3),p=v[0],k=v[1],g=v[2];(p!==m.row_pre||k!==m.row)&&(h({row_pre:p,row:k,row_index:g}),y(d))}},[n.luckysheet_rows_change_size,n.visibledatarow,m.row,m.row_pre,i.globalCache.freezen,n.currentSheetId]),_=(0,o.useCallback)(function(e){var t=e.nativeEvent;a(function(e){(0,l.R9c)(e,i.globalCache,t,s.current,i.cellInput.current,i.fxInput.current)})},[i.globalCache,i.cellInput,i.fxInput,a]),R=(0,o.useCallback)(function(){n.luckysheet_rows_change_size||h({row:-1,row_pre:-1,row_index:-1})},[n.luckysheet_rows_change_size]),M=(0,o.useCallback)(function(e){var t=e.nativeEvent;a(function(e){(0,l.yXF)(e,i.globalCache,t,s.current,i.workbookContainer.current,i.cellArea.current)}),e.stopPropagation()},[i.cellArea,i.globalCache,i.workbookContainer,a]),S=(0,o.useCallback)(function(e){var t=e.nativeEvent;a(function(e){(0,l.bhZ)(e,i.globalCache,t,s.current,i.workbookContainer.current,i.cellArea.current)}),e.stopPropagation()},[i.cellArea,i.globalCache,i.workbookContainer,a]),L=(0,o.useCallback)(function(e){var t=e.nativeEvent;a(function(e){(0,l.keM)(e,r,t,i.workbookContainer.current,i.cellArea.current,"rowHeader")})},[i.workbookContainer,a,r,i.cellArea]);return(0,o.useEffect)(function(){for(var e=n.luckysheet_select_save||[],t={},o=0;o<e.length;o+=1){var a=e[o].row[0],r=e[o].row[1];t=(0,l.RF$)(t,a,r)}for(var i=(0,l.Ir3)(t),u=[],s=0;s<i.length;s+=1){var d=i[s][0],m=i[s][i[s].length-1],f=(0,l.L3O)(m,n.visibledatarow)[1],h=(0,l.L3O)(d,n.visibledatarow)[0];c().isNumber(h)&&c().isNumber(f)&&u.push({row:f,row_pre:h,r1:d,r2:m})}C(u)},[n.luckysheet_select_save,n.visibledatarow]),(0,o.useEffect)(function(){s.current.scrollTop=n.scrollTop},[n.scrollTop]),o.createElement("div",{ref:s,className:"fortune-row-header",style:{width:n.rowHeaderWidth-1.5,height:n.cellmainHeight},onMouseMove:N,onMouseDown:_,onMouseLeave:R,onContextMenu:L},o.createElement("div",{className:"fortune-rows-freeze-handle",onMouseDown:S,style:{top:w}}),o.createElement("div",{className:"fortune-rows-change-size",ref:u,onMouseDown:M,style:{top:m.row-3+(p?n.scrollTop:0),opacity:n.luckysheet_rows_change_size?1:0}}),!n.luckysheet_rows_change_size&&m.row_index>=0?o.createElement("div",{className:"fortune-row-header-hover",style:c().assign({top:m.row_pre,height:m.row-m.row_pre-1,display:"block"},(0,l.Xlg)(n,m.row_index,m.row_index,null===(e=i.globalCache.freezen)||void 0===e?void 0:e[n.currentSheetId]))}):null,E.map(function(e,t){var a,r=e.row,u=e.row_pre,s=e.r1,d=e.r2;return o.createElement("div",{className:"fortune-row-header-selected",key:t,style:c().assign({top:u,height:r-u-1,display:"block",backgroundColor:"rgba(76, 76, 76, 0.1)"},(0,l.Xlg)(n,s,d,null===(a=i.globalCache.freezen)||void 0===a?void 0:a[n.currentSheetId]))})}),o.createElement("div",{style:{height:n.rh_height,width:1},id:"luckysheetrowHeader_0",className:"luckysheetsheetchange"}))},b=function(e){var t=m({},e),n=(0,o.useRef)(""),l=(0,o.useRef)(null),a=t.autoFocus,r=t.initialContent,i=t.onChange;(0,o.useEffect)(function(){if(a){var e;null===(e=l.current)||void 0===e||e.focus()}},[a]),(0,o.useEffect)(function(){r&&null!=l.current&&(l.current.innerHTML=r)},[r]);var s=(0,o.useCallback)(function(e,t){var o;null!=l.current&&(o=l.current.innerHTML),i&&o!==n.current&&i(o||"",t),n.current=o||""},[l,i]),d=t.innerRef,f=t.onBlur,h=t.allowEdit;return c().isNil(h)&&(h=!0),o.createElement("div",u(u({onDoubleClick:function(e){return e.stopPropagation()},onClick:function(e){return e.stopPropagation()}},c().omit(t,"innerRef","onChange","html","onBlur","autoFocus","allowEdit","initialContent")),{},{ref:function(e){l.current=e,null==d||d(e)},tabIndex:0,onInput:s,onBlur:function(e){s(null,!0),null==f||f(e)},contentEditable:h}))},x=function(e){var t=(0,o.useContext)(k).context;return c().isEmpty(t.functionCandidates)?null:o.createElement("div",u(u({},e),{},{id:"luckysheet-formula-search-c",className:"luckysheet-formula-search-c"}),t.functionCandidates.map(function(e){return o.createElement("div",{key:e.n,"data-func":e.n,className:"luckysheet-formula-search-item"},o.createElement("div",{className:"luckysheet-formula-search-func"},e.n),o.createElement("div",{className:"luckysheet-formula-search-detail"},e.d))}))},w=function(e){var t=(0,o.useContext)(k).context,n=(0,l.SP8)(t).formulaMore;if(!t.functionHint)return null;var a=t.formulaCache.functionlistMap[t.functionHint];return a?o.createElement("div",u(u({},e),{},{id:"luckysheet-formula-help-c",className:"luckysheet-formula-help-c"}),o.createElement("div",{className:"luckysheet-formula-help-close",title:"关闭"},o.createElement("i",{className:"fa fa-times","aria-hidden":"true"})),o.createElement("div",{className:"luckysheet-formula-help-collapse",title:"收起"},o.createElement("i",{className:"fa fa-angle-up","aria-hidden":"true"})),o.createElement("div",{className:"luckysheet-formula-help-title"},o.createElement("div",{className:"luckysheet-formula-help-title-formula"},o.createElement("span",{className:"luckysheet-arguments-help-function-name"},a.n),o.createElement("span",{className:"luckysheet-arguments-paren"},"("),o.createElement("span",{className:"luckysheet-arguments-parameter-holder"},a.p.map(function(e,t){var n=e.name;return"y"===e.repeat&&(n+=", ..."),"o"===e.require&&(n="[".concat(n,"]")),o.createElement("span",{className:"luckysheet-arguments-help-parameter",dir:"auto",key:n},n,t!==a.p.length-1&&", ")})),o.createElement("span",{className:"luckysheet-arguments-paren"},")"))),o.createElement("div",{className:"luckysheet-formula-help-content"},o.createElement("div",{className:"luckysheet-formula-help-content-example"},o.createElement("div",{className:"luckysheet-arguments-help-section-title"},n.helpExample),o.createElement("div",{className:"luckysheet-arguments-help-formula"},o.createElement("span",{className:"luckysheet-arguments-help-function-name"},a.n),o.createElement("span",{className:"luckysheet-arguments-paren"},"("),o.createElement("span",{className:"luckysheet-arguments-parameter-holder"},a.p.map(function(e,t){return o.createElement("span",{key:e.name,className:"luckysheet-arguments-help-parameter",dir:"auto"},e.example,t!==a.p.length-1&&", ")})),o.createElement("span",{className:"luckysheet-arguments-paren"},")"))),o.createElement("div",{className:"luckysheet-formula-help-content-detail"},o.createElement("div",{className:"luckysheet-arguments-help-section"},o.createElement("div",{className:"luckysheet-arguments-help-section-title luckysheet-arguments-help-parameter-name"},n.helpAbstract),o.createElement("span",{className:"luckysheet-arguments-help-parameter-content"},a.d))),o.createElement("div",{className:"luckysheet-formula-help-content-param"},a.p.map(function(e){return o.createElement("div",{className:"luckysheet-arguments-help-section",key:e.name},o.createElement("div",{className:"luckysheet-arguments-help-section-title"},e.name,"y"===e.repeat&&o.createElement("span",{className:"luckysheet-arguments-help-argument-info"},"...-",n.allowRepeatText),"o"===e.require&&o.createElement("span",{className:"luckysheet-arguments-help-argument-info"},"-[",n.allowOptionText,"]")),o.createElement("span",{className:"luckysheet-arguments-help-parameter-content"},e.detail))}))),o.createElement("div",{className:"luckysheet-formula-help-foot"})):null};function N(e){var t=(0,o.useRef)();return(0,o.useEffect)(function(){t.current=e},[e]),t.current}var _=function(){var e,t,n=(0,o.useContext)(k),a=n.context,r=n.setContext,i=n.refs,s=(0,o.useRef)(null),d=(0,o.useRef)(),m=N(a.luckysheetCellUpdate),h=N(a.currentSheetId),v=f((0,o.useState)(!1),2),p=v[0],y=v[1],g=null===(e=a.luckysheet_select_save)||void 0===e?void 0:e[0],E=null==g?void 0:g.row_focus,C=null==g?void 0:g.column_focus,_=(0,o.useRef)(""),R=(0,o.useMemo)(function(){if(g&&a.luckysheetCellUpdate.length>0){var e=(0,l.Fkv)(a);return e?(0,l.ivN)(a,e,g.row_focus,g.column_focus):{}}return{}},[a.luckysheetfile,a.currentSheetId,a.luckysheetCellUpdate,g]);(0,o.useLayoutEffect)(function(){if(a.allowEdit||r(function(e){var t=(0,l.Fkv)(e);if(!c().isNil(t)&&e.forceFormulaRef){var n=(0,l.C_)(E,C,t,"f");(0,l.TdQ)(e,n)}}),g&&a.luckysheetCellUpdate.length>0){if(i.globalCache.doNotUpdateCell){delete i.globalCache.doNotUpdateCell;return}if(!c().isEqual(m,a.luckysheetCellUpdate)||h!==a.currentSheetId){var e,t=(0,l.Fkv)(a),n=null==t?void 0:null===(e=t[E])||void 0===e?void 0:e[C],o="";n&&!i.globalCache.overwriteCell&&((0,l.Zhd)(n)?o=(0,l.S$h)(E,C,t):n.f?(o=(0,l.C_)(E,C,t,"f"),r(function(e){(0,l.TdQ)(e,o)})):(o=(0,l.U2_)(E,C,t),1===Number(n.qp)&&(o=o?"".concat(o):o))),i.globalCache.overwriteCell=!1,i.globalCache.ignoreWriteCell||(s.current.innerHTML=(0,l.ndh)((0,l.n9Q)(o))),i.globalCache.ignoreWriteCell=!1,i.globalCache.doNotFocus||setTimeout(function(){(0,l.ALw)(s.current)}),delete i.globalCache.doNotFocus}}},[a.luckysheetCellUpdate,a.luckysheetfile,a.currentSheetId,g]),(0,o.useEffect)(function(){c().isEmpty(a.luckysheetCellUpdate)&&s.current&&(s.current.innerHTML="")},[a.luckysheetCellUpdate]),(0,o.useEffect)(function(){y((0,l.zwZ)(a))},[a.luckysheet_select_save]);var M=(0,o.useCallback)(function(e){d.current=new KeyboardEvent(e.type,e.nativeEvent),_.current=s.current.innerText,"Escape"===e.key&&a.luckysheetCellUpdate.length>0?(r(function(e){(0,l.bGp)(e),(0,l.aP1)(e,"down",0,"rangeOfSelect")}),e.preventDefault()):"Enter"===e.key&&a.luckysheetCellUpdate.length>0?(e.altKey||e.metaKey)&&(document.execCommand("insertHTML",!1,"\n "),document.execCommand("delete",!1),e.stopPropagation()):"Tab"===e.key&&a.luckysheetCellUpdate.length>0?(r(function(e){(0,l.wWT)(e,e.luckysheetCellUpdate[0],e.luckysheetCellUpdate[1],i.cellInput.current),(0,l.aP1)(e,"right",1,"rangeOfSelect")}),e.preventDefault(),e.stopPropagation()):"F4"===e.key&&a.luckysheetCellUpdate.length>0&&e.preventDefault()},[a.luckysheetCellUpdate.length,i.cellInput,r]),S=(0,o.useCallback)(function(e,t){var n=d.current;if(n){var o=n.keyCode;o&&(!(o>=112&&o<=123||o<=46||144===o||108===o||n.ctrlKey||n.altKey||n.shiftKey&&(37===o||38===o||39===o||40===o))||8===o||32===o||46===o||n.ctrlKey&&86===o)&&r(function(e){(!(e.formulaCache.rangestart||e.formulaCache.rangedrag_column_start||e.formulaCache.rangedrag_row_start||(0,l.k4$)(e))||!t)&&(0,l.RhZ)(e,e.luckysheet_select_save)&&(0,l.BTV)(e,i.fxInput.current,i.cellInput.current,o,_.current)})}},[i.cellInput,i.fxInput,r]),L=(0,o.useCallback)(function(e){c().isEmpty(a.luckysheetCellUpdate)&&e.preventDefault()},[a.luckysheetCellUpdate]),V=a.config||{},H=V.rowReadOnly||{},z=!(((V.colReadOnly||{})[C]||H[E])&&!0===a.allowEdit);return o.createElement("div",{className:"luckysheet-input-box",style:!g||(null===(t=a.rangeDialog)||void 0===t?void 0:t.show)?{left:-1e4,top:-1e4,display:"block"}:{left:g.left,top:g.top,zIndex:c().isEmpty(a.luckysheetCellUpdate)?-1:19,display:"block"},onMouseDown:function(e){return e.stopPropagation()},onMouseUp:function(e){return e.stopPropagation()}},o.createElement("div",{className:"luckysheet-input-box-inner",style:g?u({minWidth:g.width,minHeight:g.height},R):{}},o.createElement(b,{innerRef:function(e){s.current=e,i.cellInput.current=e},className:"luckysheet-cell-input",id:"luckysheet-rich-text-editor",style:{transform:"scale(".concat(a.zoomRatio,")"),transformOrigin:"left top",width:"".concat(100/a.zoomRatio,"%"),height:"".concat(100/a.zoomRatio,"%")},"aria-autocomplete":"list",onChange:S,onKeyDown:M,onPaste:L,allowEdit:z?!p:z})),document.activeElement===s.current&&o.createElement(o.Fragment,null,o.createElement(x,{style:{top:((null==g?void 0:g.height_move)||0)+4}}),o.createElement(w,{style:{top:((null==g?void 0:g.height_move)||0)+4}})))},R=function(e){var t=e.axis,n=(0,o.useContext)(k),l=n.context,a=n.refs,r=n.setContext;return(0,o.useEffect)(function(){"x"===t?a.scrollbarX.current.scrollLeft=l.scrollLeft:a.scrollbarY.current.scrollTop=l.scrollTop},["x"===t?l.scrollLeft:l.scrollTop]),o.createElement("div",{ref:"x"===t?a.scrollbarX:a.scrollbarY,style:"x"===t?{left:l.rowHeaderWidth,width:"calc(100% - ".concat(l.rowHeaderWidth,"px)")}:{height:"100%"},className:"luckysheet-scrollbars luckysheet-scrollbar-ltr luckysheet-scrollbar-".concat(t),onScroll:function(){"x"===t?r(function(e){e.scrollLeft=a.scrollbarX.current.scrollLeft}):r(function(e){e.scrollTop=a.scrollbarY.current.scrollTop})}},o.createElement("div",{style:"x"===t?{width:l.ch_width,height:10}:{width:10,height:l.rh_height}}))},M=function(e){var t=e.type,n=e.onOk,a=e.onCancel,r=e.children,c=e.containerStyle,i=e.contentStyle,u=(0,o.useContext)(k).context,s=(0,l.SP8)(u).button;return o.createElement("div",{className:"fortune-dialog",style:c},o.createElement("div",{className:"fortune-modal-dialog-header"},o.createElement("div",{className:"fortune-modal-dialog-icon-close",onClick:a},o.createElement(g,{name:"close",style:{padding:7,cursor:"pointer"}}))),o.createElement("div",{className:"fortune-dialog-box-content",style:i},r),null!=t&&o.createElement("div",{className:"fortune-dialog-box-button-container"},"ok"===t?o.createElement("div",{className:"fortune-message-box-button button-default",onClick:n},s.confirm):o.createElement(o.Fragment,null,o.createElement("div",{className:"fortune-message-box-button button-primary",onClick:n},s.confirm),o.createElement("div",{className:"fortune-message-box-button button-default",onClick:a},s.cancel))))},S=function(e){var t=e.type,n=e.onOk,l=e.onCancel,a=e.children;return o.createElement(M,{type:void 0===t?"yesno":t,onOk:n,onCancel:l,contentStyle:{width:300,paddingTop:20,paddingBottom:30,display:"flex",justifyContent:"center",alignItems:"center"}},a)},L=o.createContext({component:null,showModal:function(){},hideModal:function(){}}),V=function(e){var t=e.children,n=f((0,o.useState)(null),2),l=n[0],a=n[1],r=(0,o.useCallback)(function(e){a(e)},[]),c=(0,o.useCallback)(function(){a(null)},[]),i=(0,o.useMemo)(function(){return{component:null,showModal:r,hideModal:c}},[c,r]);return o.createElement(L.Provider,{value:i},t,l&&o.createElement("div",{onMouseDown:function(e){return e.stopPropagation()},onMouseMove:function(e){return e.stopPropagation()},onMouseUp:function(e){return e.stopPropagation()},onContextMenu:function(e){return e.stopPropagation()},className:"fortune-popover-backdrop fortune-modal-container"},l))};function H(){var e=(0,o.useContext)(L),t=e.showModal,n=e.hideModal;return{showAlert:(0,o.useCallback)(function(e){var l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"ok",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:n,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:n;t(o.createElement(S,{type:l,onOk:a,onCancel:r},e))},[n,t]),hideAlert:n}}var z=function(e){var t=e.getContainer,n=(0,o.useContext)(k),r=n.context,i=n.setContext,u=n.refs,s=(0,l.SP8)(r),d=s.findAndReplace,m=s.button,h=f((0,o.useState)(""),2),v=h[0],p=h[1],y=f((0,o.useState)(""),2),E=y[0],C=y[1],b=f((0,o.useState)(r.showReplace),2),x=b[0],w=b[1],N=f((0,o.useState)([]),2),_=N[0],R=N[1],M=f((0,o.useState)(),2),S=M[0],L=M[1],V=H().showAlert,z=f((0,o.useState)({regCheck:!1,wordCheck:!1,caseCheck:!1}),2),I=z[0],D=z[1],F=(0,o.useCallback)(function(){c().set(u.globalCache,"searchDialog.mouseEnter",!1),i(function(e){e.showSearch=!1,e.showReplace=!1})},[u.globalCache,i]),T=(0,o.useCallback)(function(e,t){return D((0,a.ZP)(function(n){c().set(n,e,t)}))},[]),B=(0,o.useCallback)(function(e){var t=e.getBoundingClientRect();return{left:(t.width-500)/2,top:(t.height-200)/3}},[]);return o.createElement("div",{id:"fortune-search-replace",className:"fortune-search-replace fortune-dialog",style:B(t()),onMouseEnter:function(){c().set(u.globalCache,"searchDialog.mouseEnter",!0)},onMouseLeave:function(){c().set(u.globalCache,"searchDialog.mouseEnter",!1)},onMouseDown:function(e){var n=e.nativeEvent;(0,l.i6T)(u.globalCache,n,t()),e.stopPropagation()}},o.createElement("div",{className:"container",onMouseDown:function(e){return e.stopPropagation()}},o.createElement("div",{className:"icon-close fortune-modal-dialog-icon-close",onClick:F},o.createElement(g,{name:"close",style:{padding:7,cursor:"pointer"}})),o.createElement("div",{className:"tabBox"},o.createElement("span",{id:"searchTab",className:x?"":"on",onClick:function(){return w(!1)}},d.find),o.createElement("span",{id:"replaceTab",className:x?"on":"",onClick:function(){return w(!0)}},d.replace)),o.createElement("div",{className:"ctBox"},o.createElement("div",{className:"row"},o.createElement("div",{className:"inputBox"},o.createElement("div",{className:"textboxs",id:"searchInput"},d.findTextbox,"：",o.createElement("input",{className:"formulaInputFocus",autoFocus:!0,spellCheck:"false",onKeyDown:function(e){return e.stopPropagation()},value:v,onChange:function(e){return p(e.target.value)}})),x&&o.createElement("div",{className:"textboxs",id:"replaceInput"},d.replaceTextbox,"：",o.createElement("input",{className:"formulaInputFocus",spellCheck:"false",onKeyDown:function(e){return e.stopPropagation()},value:E,onChange:function(e){return C(e.target.value)}}))),o.createElement("div",{className:"checkboxs"},o.createElement("div",{id:"regCheck"},o.createElement("input",{type:"checkbox",onChange:function(e){return T("regCheck",e.target.checked)}}),o.createElement("span",null,d.regexTextbox)),o.createElement("div",{id:"wordCheck"},o.createElement("input",{type:"checkbox",onChange:function(e){return T("wordCheck",e.target.checked)}}),o.createElement("span",null,d.wholeTextbox)),o.createElement("div",{id:"caseCheck"},o.createElement("input",{type:"checkbox",onChange:function(e){return T("caseCheck",e.target.checked)}}),o.createElement("span",null,d.distinguishTextbox)))),o.createElement("div",{className:"btnBox"},x&&o.createElement(o.Fragment,null,o.createElement("div",{id:"replaceAllBtn",className:"fortune-message-box-button button-default",onClick:function(){i(function(e){L(void 0),V((0,l.kon)(e,v,E,I))})}},d.allReplaceBtn),o.createElement("div",{id:"replaceBtn",className:"fortune-message-box-button button-default",onClick:function(){return i(function(e){L(void 0);var t=(0,l.gxs)(e,v,E,I);null!=t&&V(t)})}},d.replaceBtn)),o.createElement("div",{id:"searchAllBtn",className:"fortune-message-box-button button-default",onClick:function(){return i(function(e){if(L(void 0),v){var t=(0,l.feP)(e,v,I);R(t),c().isEmpty(t)&&V(d.noFindTip)}})}},d.allFindBtn),o.createElement("div",{id:"searchNextBtn",className:"fortune-message-box-button button-default",onClick:function(){return i(function(e){R([]);var t=(0,l.Xpz)(e,v,I);null!=t&&V(t)})}},d.findBtn))),o.createElement("div",{className:"close-button fortune-message-box-button button-default",onClick:F},m.close),_.length>0&&o.createElement("div",{id:"searchAllbox"},o.createElement("div",{className:"boxTitle"},o.createElement("span",null,d.searchTargetSheet),o.createElement("span",null,d.searchTargetCell),o.createElement("span",null,d.searchTargetValue)),o.createElement("div",{className:"boxMain"},_.map(function(e){return o.createElement("div",{className:"boxItem ".concat(c().isEqual(S,{r:e.r,c:e.c})?"on":""),key:e.cellPosition,onClick:function(){i(function(t){t.luckysheet_select_save=(0,l.FK$)(t,[{row:[e.r,e.r],column:[e.c,e.c]}]),(0,l._X8)(t,e.r,e.c)}),L({r:e.r,c:e.c})}},o.createElement("span",null,e.sheetName),o.createElement("span",null,e.cellPosition),o.createElement("span",null,e.value))})))))},I=function(e){var t=e.r,n=e.c,a=e.rc,r=e.originText,i=e.originType,s=e.originAddress,d=e.isEditing,m=e.position,h=e.selectingCellRange,v=(0,o.useContext)(k),p=v.context,y=v.setContext,E=v.refs,C=f((0,o.useState)(r),2),b=C[0],x=C[1],w=f((0,o.useState)(s),2),N=w[0],_=w[1],R=f((0,o.useState)(i),2),M=R[0],S=R[1],L=(0,l.SP8)(p),V=L.insertLink,H=L.linkTypeList,z=L.button,I=(0,o.useRef)((0,l.FK$)(p,[{row:[t,t],column:[n,n]}])),D=(0,o.useRef)(!0),F=(0,l.dYA)(p,M,N),T=o.createElement("div",{className:"validation-input-tip"},F.tooltip),B=(0,o.useCallback)(function(){c().set(E.globalCache,"linkCard.mouseEnter",!1),y(function(e){e.linkCard=void 0})},[E.globalCache,y]),A=(0,o.useCallback)(function(e){return y(function(t){t.luckysheet_select_save=I.current,null!=t.linkCard&&(t.linkCard.selectingCellRange=e)})},[y]),P=(0,o.useMemo)(function(){return{onMouseEnter:function(){return c().set(E.globalCache,"linkCard.mouseEnter",!0)},onMouseLeave:function(){return c().set(E.globalCache,"linkCard.mouseEnter",!1)},onMouseDown:function(e){return e.stopPropagation()},onMouseMove:function(e){return e.stopPropagation()},onMouseUp:function(e){return e.stopPropagation()},onKeyDown:function(e){return e.stopPropagation()},onDoubleClick:function(e){return e.stopPropagation()}}},[E.globalCache]),W=(0,o.useCallback)(function(e,t){return o.createElement("div",{className:"button-group"},o.createElement("div",{className:"button-basic button-default",onClick:t},z.cancel),o.createElement("div",{className:"button-basic button-primary",onClick:e},z.confirm))},[z]),O=(0,o.useCallback)(function(e,t){return o.createElement("div",{className:"fortune-toolbar-button",onClick:t},o.createElement(g,{name:e,style:{width:18,height:18}}))},[]);return((0,o.useLayoutEffect)(function(){_(s),x(r),S(i)},[a,s,r,i]),(0,o.useLayoutEffect)(function(){h&&(D.current=!0)},[h]),(0,o.useLayoutEffect)(function(){if(D.current){D.current=!1;return}if(h){var e=c().size(p.luckysheet_select_save);e>0&&_((0,l.ADb)(p,p.currentSheetId,p.luckysheet_select_save[e-1],""))}},[p,h]),d)?h?o.createElement("div",u(u({className:"fortune-link-modify-modal range-selection-modal",style:{left:m.cellLeft,top:m.cellBottom+5}},c().omit(P,["onMouseDown","onMouseMove","onMouseUp"])),{},{onMouseDown:function(e){var t=e.nativeEvent;(0,l.eeH)(p,E.globalCache,t),e.stopPropagation()}}),o.createElement("div",{className:"modal-icon-close",onClick:function(){return A(!1)}},o.createElement(g,{name:"close"})),o.createElement("div",{className:"modal-title"},V.selectCellRange),o.createElement("input",u(u({},P),{},{className:"range-selection-input ".concat(!N||F.isValid?"":"error-input"),placeholder:V.cellRangePlaceholder,onChange:function(e){return _(e.target.value)},value:N})),T,o.createElement("div",{className:"modal-footer"},W(function(){F.isValid&&A(!1)},function(){_(s),A(!1)}))):o.createElement("div",u({className:"fortune-link-modify-modal",style:{left:m.cellLeft+20,top:m.cellBottom}},P),o.createElement("div",{className:"fortune-link-modify-line"},o.createElement("div",{className:"fortune-link-modify-title"},V.linkText),o.createElement("input",{className:"fortune-link-modify-input",spellCheck:"false",autoFocus:!0,value:b,onChange:function(e){return x(e.target.value)}})),o.createElement("div",{className:"fortune-link-modify-line"},o.createElement("div",{className:"fortune-link-modify-title"},V.linkType),o.createElement("select",{className:"fortune-link-modify-select",value:M,onChange:function(e){"sheet"===e.target.value?(b||x(p.luckysheetfile[0].name),_(p.luckysheetfile[0].name)):_(""),"cellrange"===e.target.value&&A(!0),S(e.target.value)}},H.map(function(e){return o.createElement("option",{key:e.value,value:e.value},e.text)}))),o.createElement("div",{className:"fortune-link-modify-line"},"webpage"===M&&o.createElement(o.Fragment,null,o.createElement("div",{className:"fortune-link-modify-title"},V.linkAddress),o.createElement("input",{className:"fortune-link-modify-input ".concat(!N||F.isValid?"":"error-input"),spellCheck:"false",value:N,onChange:function(e){return _(e.target.value)}}),T),"cellrange"===M&&o.createElement(o.Fragment,null,o.createElement("div",{className:"fortune-link-modify-title"},V.linkCell),o.createElement("input",{className:"fortune-link-modify-input ".concat(!N||F.isValid?"":"error-input"),spellCheck:"false",value:N,onChange:function(e){return _(e.target.value)}}),o.createElement("div",{className:"fortune-link-modify-cell-selector",onClick:function(){return A(!0)}},o.createElement(g,{name:"border-all"})),T),"sheet"===M&&o.createElement(o.Fragment,null,o.createElement("div",{className:"fortune-link-modify-title"},V.linkSheet),o.createElement("select",{className:"fortune-link-modify-select",onChange:function(e){b||x(e.target.value),_(e.target.value)},value:N},p.luckysheetfile.map(function(e){return o.createElement("option",{key:e.id,value:e.name},e.name)})),T)),o.createElement("div",{className:"modal-footer"},W(function(){F.isValid&&(c().set(E.globalCache,"linkCard.mouseEnter",!1),y(function(e){return(0,l.UI6)(e,t,n,b,M,N)}))},B))):o.createElement("div",u(u({},P),{},{onKeyDown:function(e){e.stopPropagation()},className:"fortune-link-modify-modal link-toolbar",style:{left:m.cellLeft+20,top:m.cellBottom}}),o.createElement("div",{className:"link-content",onClick:function(){y(function(e){return(0,l.iFb)(e,t,n,M,N,E.scrollbarX.current,E.scrollbarY.current)})}},"webpage"===M?V.openLink:(0,l.yhK)(V.goTo,{linkAddress:N})),!0===p.allowEdit&&o.createElement("div",{className:"divider"}),!0===p.allowEdit&&"webpage"===M&&O("copy",function(){navigator.clipboard.writeText(s),B()}),!0===p.allowEdit&&O("pencil",function(){return y(function(e){null!=e.linkCard&&e.allowEdit&&(e.linkCard.isEditing=!0)})}),!0===p.allowEdit&&o.createElement("div",{className:"divider"}),!0===p.allowEdit&&O("unlink",function(){return y(function(e){c().set(E.globalCache,"linkCard.mouseEnter",!1),(0,l.Th5)(e,t,n)})}))},D=function(e){var t,n,a,r,i=e.getContainer,s=(0,o.useContext)(k),d=s.context,m=s.setContext,f=s.refs,h=d.filterOptions,v=d.currentSheetId,p=d.filter,y=d.visibledatarow,E=d.visibledatacolumn,C=(0,l.Q8D)(d,d.currentSheetId),b=d.luckysheetfile[C],x=b.filter_select,w=b.frozen;(0,o.useEffect)(function(){m(function(e){var t=(0,l.Q8D)(e,e.currentSheetId);null!=t&&(e.luckysheet_filter_save=e.luckysheetfile[t].filter_select,e.filter=e.luckysheetfile[t].filter||{},(0,l.DjA)(e,e.luckysheet_filter_save,void 0))})},[y,E,m,v,x]);var N=(0,o.useCallback)(function(e,t){null!=h&&m(function(n){var l,o;(null===(l=n.filterContextMenu)||void 0===l?void 0:l.col)!==h.startCol+t&&(n.filterContextMenu={x:e.left+n.rowHeaderWidth-f.scrollbarX.current.scrollLeft,y:e.top+23+n.toolbarHeight+n.calculatebarHeight+n.columnHeaderHeight-f.scrollbarY.current.scrollTop,col:h.startCol+t,startRow:h.startRow,endRow:h.endRow,startCol:h.startCol,endCol:h.endCol,hiddenRows:c().keys(null===(o=n.filter[t])||void 0===o?void 0:o.rowhidden).map(function(e){return parseInt(e,10)}),listBoxMaxHeight:400})})},[h,i,f.scrollbarX,f.scrollbarY,f.workbookContainer,m]),_=null==w?void 0:w.type,R=-1,M=-1;return"row"===_?M=0:"column"===_?R=0:"both"===_?(R=0,M=0):(R=(null==w?void 0:null===(a=w.range)||void 0===a?void 0:a.column_focus)||-1,M=(null==w?void 0:null===(r=w.range)||void 0===r?void 0:r.row_focus)||-1),null==h?o.createElement("div",null):o.createElement(o.Fragment,null,o.createElement("div",{id:"luckysheet-filter-selected-sheet",className:"luckysheet-cell-selected luckysheet-filter-selected",style:c().assign({left:h.left,width:h.width,top:h.top,height:h.height,display:"block"},(0,l.Xlg)(d,h.startRow,h.endRow,null===(t=f.globalCache.freezen)||void 0===t?void 0:t[d.currentSheetId]),(0,l.gDh)(d,h.startCol,h.endCol,null===(n=f.globalCache.freezen)||void 0===n?void 0:n[d.currentSheetId]))}),h.items.map(function(e,t){var n,a,r=p[t],i=(0,l.gDh)(d,t+h.startCol,t+h.startCol,null===(n=f.globalCache.freezen)||void 0===n?void 0:n[d.currentSheetId]),s=(0,l.Xlg)(d,h.startRow,h.startRow,null===(a=f.globalCache.freezen)||void 0===a?void 0:a[d.currentSheetId]),m=E[e.col],v=e.col>0?E[e.col-1]:0,y=e.col<=R&&i.left?i.left+m-v-20:e.left,k=h.startRow<=M&&s.top?s.top:e.top,C=u(u({},e),{},{left:y,top:k});return o.createElement("div",{onMouseDown:function(e){return e.stopPropagation()},onClick:function(e){e.stopPropagation(),N(C,t)},onDoubleClick:function(e){return e.stopPropagation()},key:t,style:c().assign(s,i,{left:y,top:k,height:void 0,width:void 0}),className:"luckysheet-filter-options ".concat(null==r?"":"luckysheet-filter-options-active")},null==r?o.createElement("div",{className:"caret down"}):o.createElement(g,{name:"filter-fill-white",style:{width:15,height:15}}))}))},F=function(){var e,t=(0,o.useContext)(k),n=t.context,a=t.setContext,r=t.refs,i=(0,o.useMemo)(function(){return c().find(n.insertedImgs,{id:n.activeImg})},[n.activeImg,n.insertedImgs]);return o.createElement("div",{id:"luckysheet-image-showBoxs"},i&&o.createElement("div",{id:"luckysheet-modal-dialog-activeImage",className:"luckysheet-modal-dialog",style:{padding:0,position:"absolute",zIndex:300,width:i.width*n.zoomRatio,height:i.height*n.zoomRatio,left:i.left*n.zoomRatio,top:i.top*n.zoomRatio}},o.createElement("div",{className:"luckysheet-modal-dialog-border",style:{position:"absolute"}}),o.createElement("div",{className:"luckysheet-modal-dialog-content",style:{width:i.width*n.zoomRatio,height:i.height*n.zoomRatio,backgroundImage:"url(".concat(i.src,")"),backgroundSize:"".concat(i.width*n.zoomRatio,"px ").concat(i.height*n.zoomRatio,"px"),backgroundRepeat:"no-repeat"},onMouseDown:function(e){var t=e.nativeEvent;(0,l.Oph)(n,r.globalCache,t),e.stopPropagation()}}),o.createElement("div",{className:"luckysheet-modal-dialog-resize"},["lt","mt","lm","rm","rt","lb","mb","rb"].map(function(e){return o.createElement("div",{key:e,className:"luckysheet-modal-dialog-resize-item luckysheet-modal-dialog-resize-item-".concat(e),"data-type":e,onMouseDown:function(t){var n=t.nativeEvent;(0,l.XOd)(r.globalCache,n,e),t.stopPropagation()}})})),o.createElement("div",{className:"luckysheet-modal-dialog-controll"},o.createElement("span",{className:"luckysheet-modal-controll-btn luckysheet-modal-controll-crop",role:"button",tabIndex:0,"aria-label":"裁剪",title:"裁剪"},o.createElement("i",{className:"fa fa-pencil","aria-hidden":"true"})),o.createElement("span",{className:"luckysheet-modal-controll-btn luckysheet-modal-controll-restore",role:"button",tabIndex:0,"aria-label":"恢复原图",title:"恢复原图"},o.createElement("i",{className:"fa fa-window-maximize","aria-hidden":"true"})),o.createElement("span",{className:"luckysheet-modal-controll-btn luckysheet-modal-controll-del",role:"button",tabIndex:0,"aria-label":"删除",title:"删除"},o.createElement("i",{className:"fa fa-trash","aria-hidden":"true"})))),o.createElement("div",{className:"img-list"},null===(e=n.insertedImgs)||void 0===e?void 0:e.map(function(e){var t=e.id,l=e.left,r=e.top,c=e.width,i=e.height,u=e.src;return e.id===n.activeImg?null:o.createElement("div",{id:t,key:t,className:"luckysheet-modal-dialog luckysheet-modal-dialog-image",style:{width:c*n.zoomRatio,height:i*n.zoomRatio,padding:0,position:"absolute",left:l*n.zoomRatio,top:r*n.zoomRatio,zIndex:200},onMouseDown:function(e){return e.stopPropagation()},onClick:function(e){a(function(e){e.activeImg=t}),e.stopPropagation()}},o.createElement("div",{className:"luckysheet-modal-dialog-content",style:{width:"100%",height:"100%",overflow:"hidden",position:"relative"}},o.createElement("img",{src:u,alt:"",style:{width:c*n.zoomRatio,height:i*n.zoomRatio}})),o.createElement("div",{className:"luckysheet-modal-dialog-border"}))})),o.createElement("div",{id:"luckysheet-modal-dialog-cropping",className:"luckysheet-modal-dialog",style:{display:"none",padding:0,position:"absolute",zIndex:300}},o.createElement("div",{className:"cropping-mask"}),o.createElement("div",{className:"cropping-content"}),o.createElement("div",{className:"luckysheet-modal-dialog-border",style:{position:"absolute"}}),o.createElement("div",{className:"luckysheet-modal-dialog-resize"},o.createElement("div",{className:"resize-item lt","data-type":"lt"}),o.createElement("div",{className:"resize-item mt","data-type":"mt"}),o.createElement("div",{className:"resize-item lm","data-type":"lm"}),o.createElement("div",{className:"resize-item rm","data-type":"rm"}),o.createElement("div",{className:"resize-item rt","data-type":"rt"}),o.createElement("div",{className:"resize-item lb","data-type":"lb"}),o.createElement("div",{className:"resize-item mb","data-type":"mb"}),o.createElement("div",{className:"resize-item rb","data-type":"rb"})),o.createElement("div",{className:"luckysheet-modal-dialog-controll"},o.createElement("span",{className:"luckysheet-modal-controll-btn luckysheet-modal-controll-crop",role:"button",tabIndex:0,"aria-label":"裁剪",title:"裁剪"},o.createElement("i",{className:"fa fa-pencil","aria-hidden":"true"})),o.createElement("span",{className:"luckysheet-modal-controll-btn luckysheet-modal-controll-restore",role:"button",tabIndex:0,"aria-label":"恢复原图",title:"恢复原图"},o.createElement("i",{className:"fa fa-window-maximize","aria-hidden":"true"})),o.createElement("span",{className:"luckysheet-modal-controll-btn luckysheet-modal-controll-del",role:"button",tabIndex:0,"aria-label":"删除",title:"删除"},o.createElement("i",{className:"fa fa-trash","aria-hidden":"true"})))),o.createElement("div",{className:"cell-date-picker"}))},T=function(){var e,t=(0,o.useContext)(k),n=t.context,a=t.setContext,r=t.refs,i=(0,l.Fkv)(n);return(0,o.useEffect)(function(){if(i){for(var e=[],t=0;t<i.length;t+=1)for(var n=0;n<i[t].length;n+=1){var o,r=i[t][n];r&&(null===(o=r.ps)||void 0===o?void 0:o.isShow)&&e.push({r:t,c:n})}a(function(t){return(0,l.Q83)(t,e)})}},[i,a]),o.createElement("div",{id:"luckysheet-postil-showBoxs"},c().concat(null===(e=n.commentBoxes)||void 0===e?void 0:e.filter(function(e){var t;return(null==e?void 0:e.rc)!==(null===(t=n.editingCommentBox)||void 0===t?void 0:t.rc)}),[n.editingCommentBox,n.hoveredCommentBox]).map(function(e){if(!e)return null;var t,c=e.r,u=e.c,s=e.rc,d=e.left,m=e.top,f=e.width,h=e.height,v=e.value,p=e.autoFocus,y=e.size,k=(null===(t=n.editingCommentBox)||void 0===t?void 0:t.rc)===s,g="comment-box-".concat(s);return o.createElement("div",{key:s},o.createElement("canvas",{id:"arrowCanvas-".concat(s),className:"arrowCanvas",width:y.width,height:y.height,style:{position:"absolute",left:y.left,top:y.top,zIndex:100,pointerEvents:"none"}}),o.createElement("div",{id:g,className:"luckysheet-postil-show-main",style:{width:f,height:h,color:"#000",padding:5,border:"1px solid #000",backgroundColor:"rgb(255,255,225)",position:"absolute",left:d,top:m,boxSizing:"border-box",zIndex:k?200:100},onMouseDown:function(e){var t=e.nativeEvent;a(function(e){i&&(0,l.Uyj)(e,i,c,u)}),(0,l.kCA)(n,r.globalCache,t,{r:c,c:u,rc:s},g),e.stopPropagation()}},o.createElement("div",{className:"luckysheet-postil-dialog-move"},["t","r","b","l"].map(function(e){return o.createElement("div",{key:e,className:"luckysheet-postil-dialog-move-item luckysheet-postil-dialog-move-item-".concat(e),"data-type":e})})),k&&o.createElement("div",{className:"luckysheet-postil-dialog-resize"},["lt","mt","lm","rm","rt","lb","mb","rb"].map(function(e){return o.createElement("div",{key:e,className:"luckysheet-postil-dialog-resize-item luckysheet-postil-dialog-resize-item-".concat(e),"data-type":e,onMouseDown:function(t){var o=t.nativeEvent;(0,l.qKQ)(n,r.globalCache,o,{r:c,c:u,rc:s},g,e),t.stopPropagation()}})})),o.createElement("div",{style:{width:"100%",height:"100%",overflow:"hidden"}},o.createElement(b,{id:"comment-editor-".concat(s),autoFocus:p,style:{width:"100%",height:"100%",lineHeight:"20px",boxSizing:"border-box",textAlign:"center",wordBreak:"break-all",outline:"none"},allowEdit:n.allowEdit,spellCheck:!1,"data-r":c,"data-c":u,onKeyDown:function(e){return e.stopPropagation()},onFocus:function(e){!1!==n.allowEdit&&(r.globalCache.editingCommentBoxEle=e.target)},onMouseDown:function(e){a(function(e){i&&(0,l.Uyj)(e,i,c,u)}),e.stopPropagation()},onDoubleClick:function(e){e.stopPropagation()},initialContent:v}))))}))};function B(){var e=(0,o.useContext)(L),t=e.showModal,n=e.hideModal;return{showDialog:(0,o.useCallback)(function(e,l){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:n,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:n;t(o.createElement(M,{type:l,onOk:a,onCancel:r},e))},[n,t]),hideDialog:n}}var A=function(){var e,t,n,a,r,c,i,s,d,m,h,v,p,y,E,C,b,x,w,N,_,R,M,S,L,V=(0,o.useContext)(k),H=V.context,z=V.setContext,I=B(),D=I.showDialog,F=I.hideDialog,T=(0,l.SP8)(H),A=T.dataVerification,P=T.toolbar,W=T.button,O=T.generalDialog,U=f((0,o.useState)(["between","notBetween","equal","notEqualTo","moreThanThe","lessThan","greaterOrEqualTo","lessThanOrEqualTo"]),1)[0],Z=f((0,o.useState)(["between","notBetween","equal","notEqualTo","earlierThan","noEarlierThan","laterThan","noLaterThan"]),1)[0],j=(0,o.useCallback)(function(e,t){F(),z(function(n){n.rangeDialog.show=!0,n.rangeDialog.type=e,n.rangeDialog.rangeTxt=t})},[F,z]),K=(0,o.useCallback)(function(e){"confirm"===e?z(function(e){if((0,l.AUX)(e,O,A)){var t,n,o,a=(0,l.mD4)(e,null===(t=e.dataVerification)||void 0===t?void 0:null===(n=t.dataRegulation)||void 0===n?void 0:n.rangeTxt);if(0!==a.length){var r=e.dataVerification.dataRegulation,c=null==r?void 0:r.type,i=r.value1,s=u(u({},r),{},{checked:!1});if("dropdown"===c){var d=(0,l.I2z)(e,i);s.value1=d.join(",")}var m=null!==(o=e.luckysheetfile[(0,l.Q8D)(e,e.currentSheetId)].dataVerification)&&void 0!==o?o:{},f=a[a.length-1].row[0],h=a[a.length-1].row[1],v=a[a.length-1].column[0],p=a[a.length-1].column[1],y=(0,l.Fkv)(e);if(y){for(var k=f;k<=h;k+=1)for(var g=v;g<=p;g+=1)m["".concat(k,"_").concat(g)]=s,"checkbox"===r.type&&(0,l.dNW)(e,k,g,y,s.value2);e.luckysheetfile[(0,l.Q8D)(e,e.currentSheetId)].dataVerification=m}}}}):"delete"===e&&z(function(e){var t,n,o,a=(0,l.mD4)(e,null===(t=e.dataVerification)||void 0===t?void 0:null===(n=t.dataRegulation)||void 0===n?void 0:n.rangeTxt);if(0===a.length){D(O.noSeletionError,"ok");return}for(var r=null!==(o=e.luckysheetfile[(0,l.Q8D)(e,e.currentSheetId)].dataVerification)&&void 0!==o?o:{},c=a[a.length-1].row[0],i=a[a.length-1].row[1],u=a[a.length-1].column[0],s=a[a.length-1].column[1],d=c;d<=i;d+=1)for(var m=u;m<=s;m+=1)delete r["".concat(d,"_").concat(m)]}),F()},[A,O,F,z,D]);return(0,o.useEffect)(function(){z(function(e){var t="";if(e.luckysheet_select_save){var n=e.luckysheet_select_save[e.luckysheet_select_save.length-1];t=(0,l.ADb)(H,H.currentSheetId,n,H.currentSheetId)}var o=(0,l.Q8D)(e,e.currentSheetId),a=e.luckysheetfile[o].dataVerification;if(a){if(!e.luckysheet_select_save)return;var r,c,i,s=e.luckysheet_select_save[e.luckysheet_select_save.length-1],d=s.row_focus,m=s.column_focus;if(null==d||null==m)return;var f=a["".concat(d,"_").concat(m)],h=null!==(r=(null!=f?f:{}).value1)&&void 0!==r?r:"";(null===(c=e.rangeDialog)||void 0===c?void 0:c.type)==="dropDown"&&e.dataVerification&&e.dataVerification.dataRegulation&&e.dataVerification.dataRegulation.rangeTxt?(t=e.dataVerification.dataRegulation.rangeTxt,h=e.rangeDialog.rangeTxt):(null===(i=e.rangeDialog)||void 0===i?void 0:i.type)==="rangeTxt"&&e.dataVerification&&e.dataVerification.dataRegulation&&e.dataVerification.dataRegulation.value1&&(h=e.dataVerification.dataRegulation.value1,t=e.rangeDialog.rangeTxt),e.rangeDialog.type="",f?e.dataVerification.dataRegulation=u(u({},f),{},{value1:h,rangeTxt:t}):e.dataVerification.dataRegulation={type:"dropdown",type2:"",rangeTxt:t,value1:h,value2:"",validity:"",remote:!1,prohibitInput:!1,hintShow:!1,hintValue:""}}else e.dataVerification.dataRegulation={type:"dropdown",type2:"",rangeTxt:t,value1:"",value2:"",validity:"",remote:!1,prohibitInput:!1,hintShow:!1,hintValue:""}})},[]),o.createElement("div",{id:"fortune-data-verification"},o.createElement("div",{className:"title"},P.dataVerification),o.createElement("div",{className:"box"},o.createElement("div",{className:"box-item",style:{borderTop:"1px solid #E1E4E8"}},o.createElement("div",{className:"box-item-title"},A.cellRange),o.createElement("div",{className:"data-verification-range"},o.createElement("input",{className:"formulaInputFocus",spellCheck:"false",value:null===(e=H.dataVerification.dataRegulation)||void 0===e?void 0:e.rangeTxt,onChange:function(e){var t=e.target.value;z(function(e){e.dataVerification.dataRegulation.rangeTxt=t})}}),o.createElement("i",{className:"icon","aria-hidden":"true",onClick:function(){F(),j("rangeTxt",H.dataVerification.dataRegulation.value1)}},o.createElement(g,{name:"tab",width:18})))),o.createElement("div",{className:"box-item"},o.createElement("div",{className:"box-item-title"},A.verificationCondition),o.createElement("select",{className:"data-verification-type-select",value:H.dataVerification.dataRegulation.type,onChange:function(e){var t=e.target.value;z(function(e){e.dataVerification.dataRegulation.type=t,"dropdown"===t||"checkbox"===t?e.dataVerification.dataRegulation.type2="":"number"===t||"number_integer"===t||"number_decimal"===t||"text_length"===t||"date"===t?e.dataVerification.dataRegulation.type2="between":"text_content"===t?e.dataVerification.dataRegulation.type2="include":"validity"===t&&(e.dataVerification.dataRegulation.type2="identificationNumber"),e.dataVerification.dataRegulation.value1="",e.dataVerification.dataRegulation.value2=""})}},["dropdown","checkbox","number","number_integer","number_decimal","text_content","text_length","date","validity"].map(function(e){return o.createElement("option",{value:e,key:e},A[e])})),(null===(t=H.dataVerification)||void 0===t?void 0:null===(n=t.dataRegulation)||void 0===n?void 0:n.type)==="dropdown"&&o.createElement("div",{className:"show-box-item"},o.createElement("div",{className:"data-verification-range"},o.createElement("input",{className:"formulaInputFocus",spellCheck:"false",value:H.dataVerification.dataRegulation.value1,placeholder:A.placeholder1,onChange:function(e){var t=e.target.value;z(function(e){e.dataVerification.dataRegulation.value1=t})}}),o.createElement("i",{className:"icon","aria-hidden":"true",onClick:function(){return j("dropDown",H.dataVerification.dataRegulation.value1)}},o.createElement(g,{name:"tab",width:18}))),o.createElement("div",{className:"check"},o.createElement("input",{type:"checkbox",checked:"true"===H.dataVerification.dataRegulation.type2,id:"mul",onChange:function(e){var t=e.target.checked;z(function(e){e.dataVerification.dataRegulation.type2="".concat(t)})}}),o.createElement("label",{htmlFor:"mul"},A.allowMultiSelect))),(null===(a=H.dataVerification)||void 0===a?void 0:null===(r=a.dataRegulation)||void 0===r?void 0:r.type)==="checkbox"&&o.createElement("div",{className:"show-box-item"},o.createElement("div",{className:"check-box"},o.createElement("span",null,A.selected," —— "),o.createElement("input",{type:"text",className:"data-verification-value1",placeholder:A.placeholder2,value:null===(c=H.dataVerification)||void 0===c?void 0:null===(i=c.dataRegulation)||void 0===i?void 0:i.value1,onChange:function(e){var t=e.target.value;z(function(e){e.dataVerification.dataRegulation.value1=t})}})),o.createElement("div",{className:"check-box"},o.createElement("span",null,A.notSelected," —— "),o.createElement("input",{type:"text",className:"data-verification-value2",placeholder:A.placeholder2,value:null===(s=H.dataVerification)||void 0===s?void 0:null===(d=s.dataRegulation)||void 0===d?void 0:d.value2,onChange:function(e){var t=e.target.value;z(function(e){e.dataVerification.dataRegulation.value2=t})}}))),((null===(m=H.dataVerification)||void 0===m?void 0:null===(h=m.dataRegulation)||void 0===h?void 0:h.type)==="number"||(null===(v=H.dataVerification)||void 0===v?void 0:null===(p=v.dataRegulation)||void 0===p?void 0:p.type)==="number_integer"||(null===(y=H.dataVerification)||void 0===y?void 0:null===(E=y.dataRegulation)||void 0===E?void 0:E.type)==="number_decimal"||(null===(C=H.dataVerification)||void 0===C?void 0:null===(b=C.dataRegulation)||void 0===b?void 0:b.type)==="text_length")&&o.createElement("div",{className:"show-box-item"},o.createElement("select",{className:"data-verification-type-select",value:H.dataVerification.dataRegulation.type2,onChange:function(e){var t=e.target.value;z(function(e){e.dataVerification.dataRegulation.type2=t,e.dataVerification.dataRegulation.value1="",e.dataVerification.dataRegulation.value2=""})}},U.map(function(e){return o.createElement("option",{value:e,key:e},A[e])})),"between"===H.dataVerification.dataRegulation.type2||"notBetween"===H.dataVerification.dataRegulation.type2?o.createElement("div",{className:"input-box"},o.createElement("input",{type:"number",placeholder:"1",value:H.dataVerification.dataRegulation.value1,onChange:function(e){var t=e.target.value;z(function(e){e.dataVerification.dataRegulation.value1=t})}}),o.createElement("span",null,"-"),o.createElement("input",{type:"number",placeholder:"100",value:H.dataVerification.dataRegulation.value2,onChange:function(e){var t=e.target.value;z(function(e){e.dataVerification.dataRegulation.value2=t})}})):o.createElement("div",{className:"input-box"},o.createElement("input",{type:"number",style:{width:"100%"},placeholder:A.placeholder3,value:H.dataVerification.dataRegulation.value1,onChange:function(e){var t=e.target.value;z(function(e){e.dataVerification.dataRegulation.value1=t})}}))),(null===(x=H.dataVerification)||void 0===x?void 0:null===(w=x.dataRegulation)||void 0===w?void 0:w.type)==="text_content"&&o.createElement("div",{className:"show-box-item"},o.createElement("select",{className:"data-verification-type-select",value:H.dataVerification.dataRegulation.type2,onChange:function(e){var t=e.target.value;z(function(e){e.dataVerification.dataRegulation.type2=t,e.dataVerification.dataRegulation.value1="",e.dataVerification.dataRegulation.value2=""})}},["include","exclude","equal"].map(function(e){return o.createElement("option",{value:e,key:e},A[e])})),o.createElement("div",{className:"input-box"},o.createElement("input",{type:"text",style:{width:"100%"},placeholder:A.placeholder4,value:H.dataVerification.dataRegulation.value1,onChange:function(e){var t=e.target.value;z(function(e){e.dataVerification.dataRegulation.value1=t})}}))),(null===(N=H.dataVerification)||void 0===N?void 0:null===(_=N.dataRegulation)||void 0===_?void 0:_.type)==="date"&&o.createElement("div",{className:"show-box-item"},o.createElement("select",{className:"data-verification-type-select",value:H.dataVerification.dataRegulation.type2,onChange:function(e){var t=e.target.value;z(function(e){e.dataVerification.dataRegulation.type2=t,e.dataVerification.dataRegulation.value1="",e.dataVerification.dataRegulation.value2=""})}},Z.map(function(e){return o.createElement("option",{value:e,key:e},A[e])})),"between"===H.dataVerification.dataRegulation.type2||"notBetween"===H.dataVerification.dataRegulation.type2?o.createElement("div",{className:"input-box"},o.createElement("input",{type:"date",placeholder:"1",value:H.dataVerification.dataRegulation.value1,onChange:function(e){var t=e.target.value;z(function(e){e.dataVerification.dataRegulation.value1=t})}}),o.createElement("span",null,"-"),o.createElement("input",{type:"date",placeholder:"100",value:H.dataVerification.dataRegulation.value2,onChange:function(e){var t=e.target.value;z(function(e){e.dataVerification.dataRegulation.value2=t})}})):o.createElement("div",{className:"input-box"},o.createElement("input",{type:"date",style:{width:"100%"},placeholder:A.placeholder3,value:H.dataVerification.dataRegulation.value1,onChange:function(e){var t=e.target.value;z(function(e){e.dataVerification.dataRegulation.value1=t})}}))),(null===(R=H.dataVerification)||void 0===R?void 0:null===(M=R.dataRegulation)||void 0===M?void 0:M.type)==="validity"&&o.createElement("div",{className:"show-box-item"},o.createElement("select",{className:"data-verification-type-select",value:H.dataVerification.dataRegulation.type2,onChange:function(e){var t=e.target.value;z(function(e){e.dataVerification.dataRegulation.type2=t,e.dataVerification.dataRegulation.value1="",e.dataVerification.dataRegulation.value2=""})}},["identificationNumber","phoneNumber"].map(function(e){return o.createElement("option",{value:e,key:e},A[e])})))),o.createElement("div",{className:"box-item"},["prohibitInput","hintShow"].map(function(e){return o.createElement("div",{className:"check",key:"div".concat(e)},o.createElement("input",{type:"checkbox",id:e,key:"input".concat(e),checked:H.dataVerification.dataRegulation[e],onChange:function(){z(function(t){var n,l=null===(n=t.dataVerification)||void 0===n?void 0:n.dataRegulation;"prohibitInput"===e?l.prohibitInput=!l.prohibitInput:"hintShow"===e&&(l.hintShow=!l.hintShow)})}}),o.createElement("label",{htmlFor:e,key:"label".concat(e)},A[e]))}),(null===(S=H.dataVerification)||void 0===S?void 0:null===(L=S.dataRegulation)||void 0===L?void 0:L.hintShow)&&o.createElement("div",{className:"input-box"},o.createElement("input",{type:"text",style:{width:"100%"},placeholder:A.placeholder5,value:H.dataVerification.dataRegulation.hintValue,onChange:function(e){var t=e.target.value;z(function(e){e.dataVerification.dataRegulation.hintValue=t})}})))),o.createElement("div",{className:"button-basic button-primary",onClick:function(){K("confirm")}},W.confirm),o.createElement("div",{className:"button-basic button-close",onClick:function(){K("delete")}},A.deleteVerification),o.createElement("div",{className:"button-basic button-close",onClick:function(){K("close")}},W.cancel))},P=function(e){var t=e.type,n=(0,o.useContext)(k),r=n.context,c=n.setContext,i=B().hideDialog,u=(0,l.SP8)(r),s=u.conditionformat,d=u.button,m=u.protection,h=u.generalDialog,v=f((0,o.useState)({textColor:"#000000",cellColor:"#000000"}),2),p=v[0],y=v[1],g=(0,o.useCallback)(function(e){"confirm"===e&&c(function(e){e.conditionRules.textColor.color=p.textColor,e.conditionRules.cellColor.color=p.cellColor,(0,l.NnS)(e,m,h,s,e.conditionRules)}),c(function(e){e.conditionRules={rulesType:"",rulesValue:"",textColor:{check:!0,color:"#000000"},cellColor:{check:!0,color:"#000000"},betweenValue:{value1:"",value2:""},dateValue:"",repeatValue:"0",projectValue:"10"}}),i()},[p,s,h,i,m,c]);return(0,o.useEffect)(function(){c(function(e){if(e.conditionRules.rulesType=t,e.rangeDialog){var n=e.rangeDialog.type,l=e.rangeDialog.rangeTxt;"conditionRulesbetween1"===n?e.conditionRules.betweenValue.value1=l:"conditionRulesbetween2"===n?e.conditionRules.betweenValue.value2=l:n.indexOf("conditionRules")>=0?e.conditionRules.rulesValue=l:""===n&&(e.conditionRules={rulesType:t,rulesValue:"",textColor:{check:!0,color:"#000000"},cellColor:{check:!0,color:"#000000"},betweenValue:{value1:"",value2:""},dateValue:"",repeatValue:"0",projectValue:"10"}),e.rangeDialog.type="",e.rangeDialog.rangeTxt=""}})},[]),o.createElement("div",{className:"condition-rules"},o.createElement("div",{className:"condition-rules-title"},s["conditionformat_".concat(t)]),o.createElement("div",{className:"conditin-rules-value"},s["conditionformat_".concat(t,"_title")]),("greaterThan"===t||"lessThan"===t||"equal"===t||"textContains"===t)&&o.createElement("div",{className:"condition-rules-inpbox"},o.createElement("input",{className:"condition-rules-input",type:"text",value:r.conditionRules.rulesValue,onChange:function(e){var t=e.target.value;c(function(e){e.conditionRules.rulesValue=t})}})),"between"===t&&o.createElement("div",{className:"condition-rules-between-box"},o.createElement("div",{className:"condition-rules-between-inpbox"},o.createElement("input",{className:"condition-rules-between-input",type:"text",value:r.conditionRules.betweenValue.value1,onChange:function(e){var t=e.target.value;c(function(e){e.conditionRules.betweenValue.value1=t})}})),o.createElement("span",{style:{margin:"0px 4px"}},s.to),o.createElement("div",{className:"condition-rules-between-inpbox"},o.createElement("input",{className:"condition-rules-between-input",type:"text",value:r.conditionRules.betweenValue.value2,onChange:function(e){var t=e.target.value;c(function(e){e.conditionRules.betweenValue.value2=t})}}))),"occurrenceDate"===t&&o.createElement("div",{className:"condition-rules-inpbox"},o.createElement("input",{type:"date",className:"condition-rules-date",value:r.conditionRules.dateValue,onChange:function(e){var t=e.target.value;c(function(e){e.conditionRules.dateValue=t})}})),"duplicateValue"===t&&o.createElement("select",{className:"condition-rules-select",onChange:function(e){var t=e.target.value;c(function(e){e.conditionRules.repeatValue=t})}},o.createElement("option",{value:"0"},s.duplicateValue),o.createElement("option",{value:"1"},s.uniqueValue)),("top10"===t||"top10_percent"===t||"last10"===t||"last10_percent"===t)&&o.createElement("div",{className:"condition-rules-project-box"},"top10"===t||"top10_percent"===t?s.top:s.last,o.createElement("input",{className:"condition-rules-project-input",type:"number",value:r.conditionRules.projectValue,onChange:function(e){var t=e.target.value;c(function(e){e.conditionRules.projectValue=t})}}),"top10"===t||"last10"===t?s.oneself:"%"),o.createElement("div",{className:"condition-rules-set-title"},"".concat(s.setAs,"：")),o.createElement("div",{className:"condition-rules-setbox"},o.createElement("div",{className:"condition-rules-set"},o.createElement("div",{className:"condition-rules-color"},o.createElement("input",{id:"checkTextColor",type:"checkbox",className:"condition-rules-check",checked:r.conditionRules.textColor.check,onChange:function(e){var t=e.target.checked;c(function(e){e.conditionRules.textColor.check=t})}}),o.createElement("label",{htmlFor:"checkTextColor",className:"condition-rules-label"},s.textColor),o.createElement("input",{type:"color",className:"condition-rules-select-color",value:p.textColor,onChange:function(e){var t=e.target.value;y((0,a.ZP)(function(e){e.textColor=t}))}}))),o.createElement("div",{className:"condition-rules-set"},o.createElement("div",{className:"condition-rules-color"},o.createElement("input",{id:"checkCellColor",type:"checkbox",className:"condition-rules-check",checked:r.conditionRules.cellColor.check,onChange:function(e){var t=e.target.checked;c(function(e){e.conditionRules.cellColor.check=t})}}),o.createElement("label",{htmlFor:"checkCellColor",className:"condition-rules-label"},s.cellColor),o.createElement("input",{type:"color",className:"condition-rules-select-color",value:p.cellColor,onChange:function(e){var t=e.target.value;y((0,a.ZP)(function(e){e.cellColor=t}))}})))),o.createElement("div",{className:"button-basic button-primary",onClick:function(){g("confirm")}},d.confirm),o.createElement("div",{className:"button-basic button-close",onClick:function(){g("close")}},d.cancel))},W=function(){var e,t,n=(0,o.useContext)(k),a=n.context,r=n.setContext,c=B().showDialog,i=(0,l.SP8)(a),u=i.dataVerification,s=i.button,d=f((0,o.useState)(null!==(e=null===(t=a.rangeDialog)||void 0===t?void 0:t.rangeTxt)&&void 0!==e?e:""),2),m=d[0],h=d[1],v=(0,o.useCallback)(function(){if(r(function(e){e.rangeDialog.show=!1,e.rangeDialog.singleSelect=!1}),a.rangeDialog){var e=a.rangeDialog.type;if(e.indexOf("between")>=0){c(o.createElement(P,{type:"between"}));return}if(e.indexOf("conditionRules")>=0){var t=e.substring(14,e.length);c(o.createElement(P,{type:t}));return}c(o.createElement(A,null))}},[a.rangeDialog,r,c]);return(0,o.useEffect)(function(){h(function(e){if(a.luckysheet_select_save){var t=a.luckysheet_select_save[a.luckysheet_select_save.length-1];return(0,l.ADb)(a,a.currentSheetId,t,a.currentSheetId)}return""})},[a,a.luckysheet_select_save]),o.createElement("div",{id:"range-dialog",onClick:function(e){return e.stopPropagation()},onChange:function(e){return e.stopPropagation()},onKeyDown:function(e){return e.stopPropagation()},onMouseDown:function(e){return e.stopPropagation()},onMouseUp:function(e){return e.stopPropagation()}},o.createElement("div",{className:"dialog-title"},u.selectCellRange),o.createElement("input",{readOnly:!0,placeholder:u.selectCellRange2,value:m}),o.createElement("div",{className:"button-basic button-primary",style:{marginLeft:"6px"},onClick:function(){r(function(e){e.rangeDialog.rangeTxt=m}),v()}},s.confirm),o.createElement("div",{className:"button-basic button-close",onClick:function(){v()}},s.close))};function O(e,t,n){(0,o.useEffect)(function(){function n(n){e.current&&!e.current.contains(n.target)&&t()}return document.addEventListener("mousedown",n),function(){document.removeEventListener("mousedown",n)}},n)}var U=function(){var e=(0,o.useContext)(k),t=e.context,n=e.setContext,a=(0,o.useRef)(null),r=f((0,o.useState)([]),2),c=r[0],i=r[1],u=f((0,o.useState)(!1),2),s=u[0],d=u[1],m=f((0,o.useState)(),2),h=m[0],v=m[1],p=f((0,o.useState)([]),2),y=p[0],E=p[1],C=(0,o.useCallback)(function(){n(function(e){e.dataVerificationDropDownList=!1})},[n]);return O(a,C,[C]),(0,o.useEffect)(function(){if(t.luckysheet_select_save){var e=t.luckysheet_select_save[t.luckysheet_select_save.length-1],n=e.row_focus,o=e.column_focus;if(null!=n&&null!=o){var a=t.visibledatarow[n],r=0===o?0:t.visibledatacolumn[o-1],c=(0,l.Fkv)(t);if(c){var u=(0,l.WEw)(t,c,n,o);u&&(a=f(u.row,2)[1],r=f(u.column,2)[0]);var s=(0,l.Q8D)(t,t.currentSheetId),m=t.luckysheetfile[s].dataVerification["".concat(n,"_").concat(o)],h=(0,l.I2z)(t,m.value1),p=(0,l.C_)(n,o,c);p&&E(p.toString().split(",")),i(h),v({left:r,top:a}),d("true"===m.type2)}}}},[]),(0,o.useEffect)(function(){if(t.luckysheet_select_save){var e=t.luckysheet_select_save[t.luckysheet_select_save.length-1],n=e.row_focus,o=e.column_focus;if(null!=n&&null!=o){var a=(0,l.Q8D)(t,t.currentSheetId);if("true"===t.luckysheetfile[a].dataVerification["".concat(n,"_").concat(o)].type2){var r=(0,l.Fkv)(t);if(r){var c=(0,l.C_)(n,o,r);c&&E(c.toString().split(","))}}}}},[t.luckysheetfile]),o.createElement("div",{id:"luckysheet-dataVerification-dropdown-List",style:h,ref:a,onClick:function(e){return e.stopPropagation()},onChange:function(e){return e.stopPropagation()},onKeyDown:function(e){return e.stopPropagation()},onMouseDown:function(e){return e.stopPropagation()},onMouseUp:function(e){return e.stopPropagation()}},c.map(function(e,t){return o.createElement("div",{className:"dropdown-List-item",key:t,onClick:function(){n(function(t){var n=y.indexOf(e);n<0?y.push(e):y.splice(n,1),E(y),(0,l.zH$)(t,e,y)})}},o.createElement(g,{name:"check",width:12,style:{verticalAlign:"middle",display:s&&y.indexOf(e)>=0?"inline":"none"}}),e)}))},Z=function(){var e,t,n,a,r,i,s,d,m,f,h,v,p,y,b,x=(0,o.useContext)(k),w=x.context,N=x.setContext,M=x.settings,S=x.refs,L=(0,l.SP8)(w),V=L.info,A=L.rightclick,P=B().showDialog,O=(0,o.useRef)(null),Z=(0,o.useRef)(null),j=(0,o.useRef)(null),K=H().showAlert,q=(0,o.useCallback)(function(e){var t=e.nativeEvent;2!==e.button&&N(function(e){var n;(0,l.q52)(e,S.globalCache,t,S.cellInput.current,S.cellArea.current,S.fxInput.current,S.canvas.current.getContext("2d")),!c().isEmpty(null===(n=e.luckysheet_select_save)||void 0===n?void 0:n[0])&&S.cellInput.current&&setTimeout(function(){var e;null===(e=S.cellInput.current)||void 0===e||e.focus()})})},[N,S.globalCache,S.cellInput,S.cellArea,S.fxInput,S.canvas]),X=(0,o.useCallback)(function(e){var t=e.nativeEvent;N(function(e){(0,l.keM)(e,M,t,S.workbookContainer.current,S.cellArea.current,"cell")})},[S.workbookContainer,N,M,S.cellArea]),Q=(0,o.useCallback)(function(e){var t=e.nativeEvent;N(function(e){(0,l.s4x)(e,S.globalCache,M,t,S.cellArea.current)})},[S.cellArea,S.globalCache,N,M]),Y=(0,o.useCallback)(function(){N(function(e){(0,l.td_)(e)})},[N]),G=(0,o.useMemo)(function(){return c().debounce(function(e,t,n,o){var a,r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];r||null!==(a=e.linkCard)&&void 0!==a&&a.mouseEnter||N(function(e){(0,l.HoT)(e,t,n,o)})},800)},[N]),$=(0,o.useCallback)(function(e,t,n,o,a,r){var c=(0,l.ccm)(e,n,o,a,r);null!=c&&(null==(0,l.eHR)(e,c.r,c.c)?G(t,c.r,c.c,!1):((0,l.HoT)(e,c.r,c.c,!1),G(t,c.r,c.c,!1,!0)))},[G]),J=(0,o.useCallback)(function(e){N(function(t){$(t,S.globalCache,e,O.current,S.scrollbarX.current,S.scrollbarY.current),(0,l.Gjx)(t,S.globalCache,e,S.cellInput.current,S.scrollbarX.current,S.scrollbarY.current,O.current,S.fxInput.current)})},[$,S.cellInput,S.fxInput,S.globalCache,S.scrollbarX,S.scrollbarY,N]),ee=(0,o.useCallback)(function(e){N(function(t){try{(0,l.S4X)(t,S.globalCache,M,e,S.scrollbarX.current,S.scrollbarY.current,O.current,S.cellInput.current,S.fxInput.current)}catch(e){K(e.message)}})},[S.cellInput,S.fxInput,S.globalCache,S.scrollbarX,S.scrollbarY,N,M,K]),et=(0,o.useCallback)(function(e){var t=(0,l.nl5)(e,w.zoomRatio);t!==w.zoomRatio&&N(function(e){e.zoomRatio=t,e.luckysheetfile[(0,l.Q8D)(e,e.currentSheetId)].zoomRatio=t})},[w.zoomRatio,N]),en=(0,o.useCallback)(function(e){var t=e.nativeEvent;N(function(e){(0,l.mXv)(e,t,S.globalCache)}),e.stopPropagation()},[S.globalCache,N]),el=(0,o.useCallback)(function(e){var t=e.nativeEvent;N(function(e){(0,l.r_m)(e,t,S.globalCache,S.scrollbarX.current,S.scrollbarY.current)})},[S.globalCache,S.scrollbarX,S.scrollbarY,N]),eo=(0,o.useCallback)(function(){(0,l.PW5)(S.globalCache)},[S.globalCache]),ea=(0,o.useCallback)(function(){var e,t=parseInt((null===(e=Z.current)||void 0===e?void 0:e.value)||w.addDefaultRows.toString(),10);if(!Number.isNaN(t)&&!(t<1)){var n={type:"row",index:w.luckysheetfile[(0,l.Q8D)(w,w.currentSheetId)].data.length-1,count:t,direction:"rightbottom",id:w.currentSheetId};N(function(e){try{(0,l.mco)(e,n,!1)}catch(e){"maxExceeded"===e.message&&K(A.rowOverLimit)}},{insertRowColOp:n})}},[w,A.rowOverLimit,N,K]);return(0,o.useEffect)(function(){w.warnDialog&&setTimeout(function(){P(w.warnDialog,"ok")},240)},[w.warnDialog]),(0,o.useEffect)(function(){S.cellArea.current.scrollLeft=w.scrollLeft,S.cellArea.current.scrollTop=w.scrollTop},[w.scrollLeft,w.scrollTop,S.cellArea,null===(a=S.cellArea.current)||void 0===a?void 0:a.scrollLeft,null===(r=S.cellArea.current)||void 0===r?void 0:r.scrollTop]),(0,o.useLayoutEffect)(function(){if(w.commentBoxes||w.hoveredCommentBox||w.editingCommentBox){var e;c().concat(null===(e=w.commentBoxes)||void 0===e?void 0:e.filter(function(e){var t;return e.rc!==(null===(t=w.editingCommentBox)||void 0===t?void 0:t.rc)}),[w.hoveredCommentBox,w.editingCommentBox]).forEach(function(e){e&&(0,l.xVY)(e.rc,e.size)})}},[w.commentBoxes,w.hoveredCommentBox,w.editingCommentBox]),(0,o.useEffect)(function(){return document.addEventListener("mousemove",J),function(){document.removeEventListener("mousemove",J)}},[J]),(0,o.useEffect)(function(){return document.addEventListener("mouseup",ee),function(){document.removeEventListener("mouseup",ee)}},[ee]),(0,o.useEffect)(function(){return document.addEventListener("keydown",et),function(){document.removeEventListener("keydown",et)}},[et]),o.createElement("div",{className:"fortune-sheet-overlay",ref:O,onTouchStart:en,onTouchMove:el,onTouchEnd:eo,tabIndex:-1,style:{width:w.luckysheetTableContentHW[0],height:w.luckysheetTableContentHW[1]}},o.createElement("div",{className:"fortune-col-header-wrap"},o.createElement("div",{className:"fortune-left-top",onClick:Y,style:{width:w.rowHeaderWidth-1.5,height:w.columnHeaderHeight-1.5}}),o.createElement(E,null)),(w.showSearch||w.showReplace)&&o.createElement(z,{getContainer:function(){return O.current}}),o.createElement("div",{className:"fortune-row-body"},o.createElement(C,null),o.createElement(R,{axis:"x"}),o.createElement(R,{axis:"y"}),o.createElement("div",{ref:S.cellArea,className:"fortune-cell-area",onMouseDown:q,onDoubleClick:Q,onContextMenu:X,style:{width:w.cellmainWidth,height:w.cellmainHeight,cursor:w.luckysheet_cell_selected_extend?"crosshair":"default"}},o.createElement("div",{id:"fortune-formula-functionrange"}),w.formulaRangeSelect&&o.createElement("div",{className:"fortune-selection-copy fortune-formula-functionrange-select",style:w.formulaRangeSelect},o.createElement("div",{className:"fortune-selection-copy-top fortune-copy"}),o.createElement("div",{className:"fortune-selection-copy-right fortune-copy"}),o.createElement("div",{className:"fortune-selection-copy-bottom fortune-copy"}),o.createElement("div",{className:"fortune-selection-copy-left fortune-copy"}),o.createElement("div",{className:"fortune-selection-copy-hc"})),w.formulaRangeHighlight.map(function(e){var t=e.rangeIndex,n=e.backgroundColor;return o.createElement("div",{key:t,id:"fortune-formula-functionrange-highlight",className:"fortune-selection-highlight fortune-formula-functionrange-highlight",style:c().omit(e,"backgroundColor")},["top","right","bottom","left"].map(function(e){return o.createElement("div",{key:e,"data-type":e,className:"fortune-selection-copy-".concat(e," fortune-copy"),style:{backgroundColor:n}})}),o.createElement("div",{className:"fortune-selection-copy-hc",style:{backgroundColor:n}}),["lt","rt","lb","rb"].map(function(e){return o.createElement("div",{key:e,"data-type":e,className:"fortune-selection-highlight-".concat(e," luckysheet-highlight"),style:{backgroundColor:n}})}))}),o.createElement("div",{className:"luckysheet-row-count-show luckysheet-count-show",id:"luckysheet-row-count-show"}),o.createElement("div",{className:"luckysheet-column-count-show luckysheet-count-show",id:"luckysheet-column-count-show"}),o.createElement("div",{className:"fortune-change-size-line",hidden:!w.luckysheet_cols_change_size&&!w.luckysheet_rows_change_size&&!w.luckysheet_cols_freeze_drag&&!w.luckysheet_rows_freeze_drag}),o.createElement("div",{className:"fortune-freeze-drag-line",hidden:!w.luckysheet_cols_freeze_drag&&!w.luckysheet_rows_freeze_drag}),o.createElement("div",{className:"luckysheet-cell-selected-focus",style:(null!==(i=null===(s=w.luckysheet_select_save)||void 0===s?void 0:s.length)&&void 0!==i?i:0)>0?(n=c().last(w.luckysheet_select_save),c().assign({left:n.left,top:n.top,width:n.width,height:n.height,display:"block"},(0,l.Xlg)(w,n.row_focus||0,n.row_focus||0,null===(e=S.globalCache.freezen)||void 0===e?void 0:e[w.currentSheetId]),(0,l.gDh)(w,n.column_focus||0,n.column_focus||0,null===(t=S.globalCache.freezen)||void 0===t?void 0:t[w.currentSheetId]))):{},onMouseDown:function(e){return e.preventDefault()}}),(null!==(d=null===(m=w.luckysheet_selection_range)||void 0===m?void 0:m.length)&&void 0!==d?d:0)>0&&o.createElement("div",{id:"fortune-selection-copy"},w.luckysheet_selection_range.map(function(e){var t=e.row[0],n=e.row[1],l=e.column[0],a=e.column[1],r=w.visibledatarow[n],c=t-1==-1?0:w.visibledatarow[t-1],i=w.visibledatacolumn[a],u=l-1==-1?0:w.visibledatacolumn[l-1];return o.createElement("div",{className:"fortune-selection-copy",key:"".concat(t,"-").concat(n,"-").concat(l,"-").concat(a),style:{left:u,width:i-u-1,top:c,height:r-c-1}},o.createElement("div",{className:"fortune-selection-copy-top fortune-copy"}),o.createElement("div",{className:"fortune-selection-copy-right fortune-copy"}),o.createElement("div",{className:"fortune-selection-copy-bottom fortune-copy"}),o.createElement("div",{className:"fortune-selection-copy-left fortune-copy"}),o.createElement("div",{className:"fortune-selection-copy-hc"}))})),o.createElement("div",{id:"luckysheet-chart-rangeShow"}),o.createElement("div",{className:"fortune-cell-selected-extend"}),o.createElement("div",{className:"fortune-cell-selected-move",id:"fortune-cell-selected-move",onMouseDown:function(e){return e.preventDefault()}}),(null!==(f=null===(h=w.luckysheet_select_save)||void 0===h?void 0:h.length)&&void 0!==f?f:0)>0&&o.createElement("div",{id:"luckysheet-cell-selected-boxs"},w.luckysheet_select_save.map(function(e,t){var n,a;return o.createElement("div",{key:t,id:"luckysheet-cell-selected",className:"luckysheet-cell-selected",style:c().assign({left:e.left_move,top:e.top_move,width:e.width_move,height:e.height_move,display:"block"},(0,l.Xlg)(w,e.row[0],e.row[1],null===(n=S.globalCache.freezen)||void 0===n?void 0:n[w.currentSheetId]),(0,l.gDh)(w,e.column[0],e.column[1],null===(a=S.globalCache.freezen)||void 0===a?void 0:a[w.currentSheetId])),onMouseDown:function(e){e.stopPropagation();var t=e.nativeEvent;N(function(e){(0,l.Rgy)(e,S.globalCache,t,S.scrollbarX.current,S.scrollbarY.current,O.current)})}},o.createElement("div",{className:"luckysheet-cs-inner-border"}),o.createElement("div",{className:"luckysheet-cs-fillhandle",onMouseDown:function(e){var t=e.nativeEvent;N(function(e){(0,l.G$u)(e,t,O.current)}),e.stopPropagation()}}),o.createElement("div",{className:"luckysheet-cs-inner-border"}),o.createElement("div",{className:"luckysheet-cs-draghandle-top luckysheet-cs-draghandle",onMouseDown:function(e){return e.preventDefault()}}),o.createElement("div",{className:"luckysheet-cs-draghandle-bottom luckysheet-cs-draghandle",onMouseDown:function(e){return e.preventDefault()}}),o.createElement("div",{className:"luckysheet-cs-draghandle-left luckysheet-cs-draghandle",onMouseDown:function(e){return e.preventDefault()}}),o.createElement("div",{className:"luckysheet-cs-draghandle-right luckysheet-cs-draghandle",onMouseDown:function(e){return e.preventDefault()}}),o.createElement("div",{className:"luckysheet-cs-touchhandle luckysheet-cs-touchhandle-lt"},o.createElement("div",{className:"luckysheet-cs-touchhandle-btn"})),o.createElement("div",{className:"luckysheet-cs-touchhandle luckysheet-cs-touchhandle-rb"},o.createElement("div",{className:"luckysheet-cs-touchhandle-btn"})))})),(null!==(v=null===(p=w.presences)||void 0===p?void 0:p.length)&&void 0!==v?v:0)>0&&w.presences.map(function(e,t){if(e.sheetId!==w.currentSheetId)return null;var n=e.selection,l=n.r,a=n.c,r=e.color,i=l-1==-1?0:w.visibledatarow[l-1],u=a-1==-1?0:w.visibledatacolumn[a-1],s=w.visibledatarow[l],d=w.visibledatacolumn[a]-u-1,m=s-i-1,f={maxWidth:d+1,backgroundColor:r};return c().set(f,0===l?"top":"bottom",m),o.createElement("div",{key:(null==e?void 0:e.userId)||t,className:"fortune-presence-selection",style:{left:u,top:i-2,width:d,height:m,borderColor:r,borderWidth:1}},o.createElement("div",{className:"fortune-presence-username",style:f},e.username))}),(null===(y=w.linkCard)||void 0===y?void 0:y.sheetId)===w.currentSheetId&&o.createElement(I,u({},w.linkCard)),(null===(b=w.rangeDialog)||void 0===b?void 0:b.show)&&o.createElement(W,null),o.createElement(D,{getContainer:function(){return O.current}}),o.createElement(_,null),o.createElement(T,null),o.createElement("div",{id:"luckysheet-multipleRange-show"}),o.createElement("div",{id:"luckysheet-dynamicArray-hightShow"}),o.createElement(F,null),o.createElement("div",{id:"luckysheet-dataVerification-dropdown-btn",onClick:function(){N(function(e){e.dataVerificationDropDownList=!0,j.current.style.display="none"})}},o.createElement(g,{name:"combo-arrow",width:16})),w.dataVerificationDropDownList&&o.createElement(U,null),o.createElement("div",{id:"luckysheet-dataVerification-showHintBox",className:"luckysheet-mousedown-cancel",ref:j}),o.createElement("div",{className:"luckysheet-cell-copy"}),o.createElement("div",{className:"luckysheet-grdblkflowpush"}),o.createElement("div",{id:"luckysheet-cell-flow_0",className:"luckysheet-cell-flow luckysheetsheetchange"},o.createElement("div",{className:"luckysheet-cell-flow-clip"},o.createElement("div",{className:"luckysheet-grdblkpush"}),o.createElement("div",{id:"luckysheetcoltable_0",className:"luckysheet-cell-flow-col"},o.createElement("div",{id:"luckysheet-sheettable_0",className:"luckysheet-cell-sheettable",style:{height:w.rh_height,width:w.ch_width}}),o.createElement("div",{id:"luckysheet-bottom-controll-row",className:"luckysheet-bottom-controll-row",onMouseDown:function(e){return e.stopPropagation()},onMouseUp:function(e){return e.stopPropagation()},onKeyDown:function(e){return e.stopPropagation()},onKeyUp:function(e){return e.stopPropagation()},onKeyPress:function(e){return e.stopPropagation()},onClick:function(e){return e.stopPropagation()},onDoubleClick:function(e){return e.stopPropagation()},style:{left:w.scrollLeft,display:w.allowEdit?"block":"none"}},o.createElement("div",{className:"fortune-add-row-button",onClick:function(){ea()}},V.add),o.createElement("input",{ref:Z,type:"text",style:{width:50},placeholder:w.addDefaultRows.toString()})," ",o.createElement("span",{style:{fontSize:14}},V.row)," ",o.createElement("span",{style:{fontSize:14,color:"#9c9c9c"}},"(",V.addLast,")"),o.createElement("span",{className:"fortune-add-row-button",onClick:function(){N(function(e){e.scrollTop=0})}},V.backTop))))))))},j=function(e){var t,n,a,r=e.sheet,c=r.data,i=(0,o.useRef)(null),u=(0,o.useRef)(null),s=(0,o.useContext)(k),d=s.context,m=s.setContext,h=s.refs,v=s.settings;(0,o.useEffect)(function(){function e(){c&&m(function(e){0===v.devicePixelRatio&&(e.devicePixelRatio=(globalThis||window).devicePixelRatio),(0,l.hcV)(e,c),(0,l.cqC)(e,h.canvas.current,u.current)})}return window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}},[c,h.canvas,m,v.devicePixelRatio]),(0,o.useEffect)(function(){c&&m(function(e){return(0,l.hcV)(e,c)})},[null===(t=d.config)||void 0===t?void 0:t.rowlen,null===(n=d.config)||void 0===n?void 0:n.columnlen,null===(a=d.config)||void 0===a?void 0:a.rowhidden,d.config.colhidden,c,d.zoomRatio,m]),(0,o.useEffect)(function(){m(function(e){return(0,l.cqC)(e,h.canvas.current,u.current)})},[h.canvas,m,d.rowHeaderWidth,d.columnHeaderHeight,d.devicePixelRatio]),(0,o.useEffect)(function(){(0,l.CJm)(d,h.globalCache,d.currentSheetId)},[h.globalCache,r.frozen,d.currentSheetId,d.visibledatacolumn,d.visibledatarow]),(0,o.useEffect)(function(){if(!(d.groupValuesRefreshData.length>0)){var e=new l.Xz7(h.canvas.current,d);if(null!=e){var t=null===(n=h.globalCache.freezen)||void 0===n?void 0:n[r.id];if((null==t?void 0:null===(o=t.horizontal)||void 0===o?void 0:o.freezenhorizontaldata)||(null==t?void 0:null===(a=t.vertical)||void 0===a?void 0:a.freezenverticaldata)){var n,o,a,c,i,u=null==t?void 0:null===(c=t.horizontal)||void 0===c?void 0:c.freezenhorizontaldata,s=null==t?void 0:null===(i=t.vertical)||void 0===i?void 0:i.freezenverticaldata;if(u&&s){var m=f(u,3),v=m[0],p=m[2],y=f(s,3),k=y[0],g=y[2];e.drawMain({scrollWidth:d.scrollLeft+k-g,scrollHeight:d.scrollTop+v-p,offsetLeft:k-g+d.rowHeaderWidth,offsetTop:v-p+d.columnHeaderHeight,clear:!0}),e.drawMain({scrollWidth:d.scrollLeft+k-g,scrollHeight:p,drawHeight:v,offsetLeft:k-g+d.rowHeaderWidth}),e.drawMain({scrollWidth:g,scrollHeight:d.scrollTop+v-p,drawWidth:k,offsetTop:v-p+d.columnHeaderHeight}),e.drawMain({scrollWidth:g,scrollHeight:p,drawWidth:k,drawHeight:v}),e.drawColumnHeader(d.scrollLeft+k-g,void 0,k-g+d.rowHeaderWidth),e.drawColumnHeader(g,k),e.drawRowHeader(d.scrollTop+v-p,void 0,v-p+d.columnHeaderHeight),e.drawRowHeader(p,v),e.drawFreezeLine({horizontalTop:v-p+d.columnHeaderHeight-2,verticalLeft:k-g+d.rowHeaderWidth-2})}else if(u){var E=f(u,3),C=E[0],b=E[2];e.drawMain({scrollWidth:d.scrollLeft,scrollHeight:d.scrollTop+C-b,offsetTop:C-b+d.columnHeaderHeight,clear:!0}),e.drawMain({scrollWidth:d.scrollLeft,scrollHeight:b,drawHeight:C}),e.drawColumnHeader(d.scrollLeft),e.drawRowHeader(d.scrollTop+C-b,void 0,C-b+d.columnHeaderHeight),e.drawRowHeader(b,C),e.drawFreezeLine({horizontalTop:C-b+d.columnHeaderHeight-2})}else if(s){var x=f(s,3),w=x[0],N=x[2];e.drawMain({scrollWidth:d.scrollLeft+w-N,scrollHeight:d.scrollTop,offsetLeft:w-N+d.rowHeaderWidth}),e.drawMain({scrollWidth:N,scrollHeight:d.scrollTop,drawWidth:w}),e.drawRowHeader(d.scrollTop),e.drawColumnHeader(d.scrollLeft+w-N,void 0,w-N+d.rowHeaderWidth),e.drawColumnHeader(N,w),e.drawFreezeLine({verticalLeft:w-N+d.rowHeaderWidth-2})}}else e.drawMain({scrollWidth:d.scrollLeft,scrollHeight:d.scrollTop,clear:!0}),e.drawColumnHeader(d.scrollLeft),e.drawRowHeader(d.scrollTop)}}},[d,h.canvas,h.globalCache.freezen,m,r.id]);var p=(0,o.useCallback)(function(e){m(function(t){(0,l.qA6)(t,e,h.globalCache,h.scrollbarX.current,h.scrollbarY.current)}),e.preventDefault()},[h.globalCache,h.scrollbarX,h.scrollbarY,m]);return(0,o.useEffect)(function(){var e=i.current;return null==e||e.addEventListener("wheel",p),function(){null==e||e.removeEventListener("wheel",p)}},[p]),o.createElement("div",{ref:i,className:"fortune-sheet-container"},o.createElement("div",{ref:u,className:"fortune-sheet-canvas-placeholder"}),o.createElement("canvas",{className:"fortune-sheet-canvas",ref:h.canvas}),o.createElement(Z,null))},K=function(e){var t=e.tooltip,n=e.onClick,l=e.iconId,a=e.disabled,r=e.selected,c=e.children;return o.createElement("div",{className:"fortune-toolbar-button fortune-toolbar-item",onClick:n,"data-tips":t,role:"button",style:r?{backgroundColor:"#E7E5EB"}:{}},o.createElement(g,{name:l,style:a?{opacity:.3}:{}}),t&&o.createElement("div",{className:"fortune-tooltip"},t),c)},q=function(){return o.createElement("div",{className:"fortune-toolbar-divider fortune-toolbar-item"})},X=function(){return o.createElement("div",{className:"fortune-toolbar-menu-divider"})},Q=function(e){var t=e.tooltip,n=e.onClick,l=e.text,a=e.iconId,r=e.children,c={userSelect:"none"},i=f((0,o.useState)(!1),2),u=i[0],s=i[1],d=f((0,o.useState)({left:0}),2),m=d[0],h=d[1],v=(0,o.useRef)(null),p=(0,o.useRef)(null);return O(v,function(){s(!1)}),(0,o.useLayoutEffect)(function(){if(v.current){u||h({left:0});var e=window.innerWidth,t=v.current.getBoundingClientRect(),n=t.width;t.left+n>e&&h({left:-t.width+p.current.clientWidth})}},[u]),o.createElement("div",{className:"fortune-toobar-combo-container fortune-toolbar-item"},o.createElement("div",{ref:p,className:"fortune-toolbar-combo"},o.createElement("div",{className:"fortune-toolbar-combo-button",onClick:function(e){n?n(e):s(!u)},"data-tips":t,role:"button",style:c},a?o.createElement(g,{name:a}):o.createElement("span",{className:"fortune-toolbar-combo-text"},l)),o.createElement("div",{className:"fortune-toolbar-combo-arrow",onClick:function(){return s(!u)},"data-tips":t,role:"button",style:c},o.createElement(g,{name:"combo-arrow",width:10})),t&&o.createElement("div",{className:"fortune-tooltip"},t)),u&&o.createElement("div",{ref:v,className:"fortune-toolbar-combo-popup",style:m},null==r?void 0:r(s)))},Y=function(e){var t=e.children,n=e.style;return o.createElement("div",{className:"fortune-toolbar-select",style:n},t)},G=function(e){var t=e.iconId,n=e.onClick,l=e.children,a=e.onMouseLeave,r=e.onMouseEnter;return o.createElement("div",{onClick:n,className:"fortune-toolbar-select-option",onMouseLeave:function(e){return null==a?void 0:a(e)},onMouseEnter:function(e){return null==r?void 0:r(e)}},t&&o.createElement(g,{name:t}),o.createElement("div",{className:"fortuen-toolbar-text"},l))},$=function(e){var t=e.onCancel,n=(0,o.useContext)(k),a=n.context,r=n.setContext,i=n.refs,u=i.cellInput,s=i.globalCache,d=f((0,o.useState)(0),2),m=d[0],h=d[1],v=f((0,o.useState)(0),2),p=v[0],y=v[1],g=f((0,o.useState)(""),2),E=g[0],C=g[1],b=(0,l.SP8)(a),x=b.formulaMore,w=b.functionlist,N=b.button,_=(0,o.useMemo)(function(){return[{t:0,n:x.Math},{t:1,n:x.Statistical},{t:2,n:x.Lookup},{t:3,n:x.luckysheet},{t:4,n:x.dataMining},{t:5,n:x.Database},{t:6,n:x.Date},{t:7,n:x.Filter},{t:8,n:x.Financial},{t:9,n:x.Engineering},{t:10,n:x.Logical},{t:11,n:x.Operator},{t:12,n:x.Text},{t:13,n:x.Parser},{t:14,n:x.Array},{t:-1,n:x.other}]},[x]),R=(0,o.useMemo)(function(){if(E){for(var e=[],t=c().cloneDeep(E.toUpperCase()),n=0;n<w.length;n+=1)/^[a-zA-Z]+$/.test(t)?-1!==w[n].n.indexOf(t)&&e.push(w[n]):-1!==w[n].a.indexOf(t)&&e.push(w[n]);return e}return c().filter(w,function(e){return e.t===m})},[w,m,E]),M=(0,o.useCallback)(function(){var e,n=null===(e=a.luckysheet_select_save)||void 0===e?void 0:e[a.luckysheet_select_save.length-1],o=null==n?void 0:n.row_focus,i=null==n?void 0:n.column_focus;n?(null==o&&(o=f(n.row,1)[0]),null==i&&(i=f(n.column,1)[0])):(o=0,i=0);var d='<span dir="auto" class="luckysheet-formula-text-color">=</span><span dir="auto" class="luckysheet-formula-text-color">'.concat(R[p].n.toUpperCase(),'</span><span dir="auto" class="luckysheet-formula-text-color">(</span>');r(function(e){if(null!=u.current){e.luckysheetCellUpdate=[o,i],s.doNotUpdateCell=!0,u.current.innerHTML=d;var n=u.current.childNodes;if(c().isEmpty(n)||(0,l.Mq9)(e,n[n.length-1],0,1),e.functionHint=R[p].n.toUpperCase(),e.functionCandidates=[],c().isEmpty(e.formulaCache.functionlistMap))for(var a=0;a<w.length;a+=1)e.formulaCache.functionlistMap[w[a].n]=w[a];t()}})},[u,a.luckysheet_select_save,R,s,p,r,t,w]),S=(0,o.useCallback)(function(){r(function(e){(0,l.bGp)(e),u.current&&(u.current.innerHTML="")}),t()},[t,u,r]);return o.createElement("div",{id:"luckysheet-search-formula"},o.createElement("div",{className:"inpbox"},o.createElement("div",null,x.findFunctionTitle,"："),o.createElement("input",{className:"formulaInputFocus",id:"searchFormulaListInput",placeholder:x.tipInputFunctionName,spellCheck:"false",onChange:function(e){return C(e.target.value)}})),o.createElement("div",{className:"selbox"},o.createElement("span",null,x.selectCategory,"："),o.createElement("select",{id:"formulaTypeSelect",onChange:function(e){h(parseInt(e.target.value,10)),y(0)}},_.map(function(e){return o.createElement("option",{key:e.t,value:e.t},e.n)}))),o.createElement("div",{className:"listbox",style:{height:200}},o.createElement("div",null,x.selectFunctionTitle,"："),o.createElement("div",{className:"formulaList"},R.map(function(e,t){return o.createElement("div",{className:"listBox".concat(t===p?" on":""),key:e.n,onClick:function(){return y(t)}},o.createElement("div",null,e.n),o.createElement("div",null,e.a))}))),o.createElement("div",{className:"fortune-dialog-box-button-container"},o.createElement("div",{className:"fortune-message-box-button button-primary",onClick:M},N.confirm),o.createElement("div",{className:"fortune-message-box-button button-default",onClick:S},N.cancel)))},J=function(){var e=(0,o.useContext)(k),t=e.context,n=e.setContext,a=(0,l.SP8)(t),r=a.splitText,i=a.button,u=f((0,o.useState)(""),2),s=u[0],d=u[1],m=f((0,o.useState)(!1),2),h=m[0],v=m[1],p=f((0,o.useState)([]),2),y=p[0],g=p[1],E=(0,o.useRef)(null),C=B(),b=C.showDialog,x=C.hideDialog,w=(0,o.useCallback)(function(){x();var e=(0,l.zs1)(s,t),o=t.luckysheet_select_save[0].row[0],a=t.luckysheet_select_save[0].column[0];if(1!==e[0].length){for(var i=!1,u=(0,l.Fkv)(t),d=0;d<e.length;d+=1)for(var m=1;m<e[0].length;m+=1){var f=u[o+d][a+m];if(!c().isNull(f)&&!c().isNull(f.v)){i=!0;break}}i?b(r.splitConfirmToExe,"yesno",function(){x(),n(function(t){(0,l.vIv)(o,a,e,t)})}):n(function(t){(0,l.vIv)(o,a,e,t)})}},[t,x,n,b,s,r.splitConfirmToExe]);return(0,o.useEffect)(function(){g(function(e){return(0,l.zs1)(s,t)})},[t,s]),o.createElement("div",{id:"fortune-split-column"},o.createElement("div",{className:"title"},r.splitTextTitle),o.createElement("div",{className:"splitDelimiters"},r.splitDelimiters),o.createElement("div",{className:"splitSymbols",ref:E},r.splitSymbols.map(function(e){return o.createElement("div",{key:e.value,className:"splitSymbol"},o.createElement("input",{id:e.value,name:e.value,type:"checkbox",onClick:function(){return d(function(e){var t;return(0,l.xsj)(e,null===(t=E.current)||void 0===t?void 0:t.childNodes)})}}),o.createElement("label",{htmlFor:e.value},e.name))}),o.createElement("div",{className:"splitSymbol"},o.createElement("input",{id:"other",name:"other",type:"checkbox",onClick:function(){v(!h),d(function(e){var t;return(0,l.xsj)(e,null===(t=E.current)||void 0===t?void 0:t.childNodes)})}}),o.createElement("label",{htmlFor:"other"},r.splitOther),o.createElement("input",{id:"otherValue",name:"otherValue",type:"text",onBlur:function(){h&&d(function(e){var t;return(0,l.xsj)(e,null===(t=E.current)||void 0===t?void 0:t.childNodes)})}})),o.createElement("div",{className:"splitSymbol splitSimple"},o.createElement("input",{id:"splitsimple",name:"splitsimple",type:"checkbox",onClick:function(){d(function(e){var t;return(0,l.xsj)(e,null===(t=E.current)||void 0===t?void 0:t.childNodes)})}}),o.createElement("label",{htmlFor:"splitsimple"},r.splitContinueSymbol))),o.createElement("div",{className:"splitDataPreview"},r.splitDataPreview),o.createElement("div",{className:"splitColumnData"},o.createElement("table",null,o.createElement("tbody",null,y.map(function(e,t){return e.length>=1?o.createElement("tr",{key:t},e.map(function(t){return o.createElement("td",{key:e+t},t)})):o.createElement("tr",null,o.createElement("td",null))})))),o.createElement("div",{className:"button-basic button-primary",onClick:function(){w()}},i.confirm),o.createElement("div",{className:"button-basic button-close",onClick:function(){x()}},i.cancel))},ee=function(){var e=(0,o.useContext)(k),t=e.context,n=e.setContext,r=B(),i=r.showDialog,u=r.hideDialog,s=(0,l.SP8)(t),d=s.findAndReplace,m=s.button,h=f((0,o.useState)("locationConstant"),2),v=h[0],p=h[1],y=f((0,o.useState)({locationDate:!0,locationDigital:!0,locationString:!0,locationBool:!0,locationError:!0}),2),g=y[0],E=y[1],C=f((0,o.useState)({locationDate:!0,locationDigital:!0,locationString:!0,locationBool:!0,locationError:!0}),2),b=C[0],x=C[1],w=(0,o.useCallback)(function(){if("locationConstant"===v){var e=(0,l.l_Z)(g),o=(0,l.Ayl)(t);n(function(t){0===(0,l.j7o)(o,v,e,t).length&&i(d.locationTipNotFindCell,"ok")})}else if("locationFormula"===v){var a=(0,l.l_Z)(b),r=(0,l.Ayl)(t);n(function(e){0===(0,l.j7o)(r,v,a,e).length&&i(d.locationTipNotFindCell,"ok")})}else if("locationRowSpan"===v){if((null===(u=t.luckysheet_select_save)||void 0===u?void 0:u.length)===0||(null===(s=t.luckysheet_select_save)||void 0===s?void 0:s.length)===1&&t.luckysheet_select_save[0].row[0]===t.luckysheet_select_save[0].row[1]){i(d.locationTiplessTwoRow,"ok");return}var u,s,m=c().assignIn([],t.luckysheet_select_save);n(function(e){0===(0,l.j7o)(m,v,void 0,e).length&&i(d.locationTipNotFindCell,"ok")})}else if("locationColumnSpan"===v){if((null===(f=t.luckysheet_select_save)||void 0===f?void 0:f.length)===0||(null===(h=t.luckysheet_select_save)||void 0===h?void 0:h.length)===1&&t.luckysheet_select_save[0].column[0]===t.luckysheet_select_save[0].column[1]){i(d.locationTiplessTwoColumn,"ok");return}var f,h,p=c().assignIn([],t.luckysheet_select_save);n(function(e){0===(0,l.j7o)(p,v,void 0,e).length&&i(d.locationTipNotFindCell,"ok")})}else{if((null===(y=t.luckysheet_select_save)||void 0===y?void 0:y.length)===0||(null===(k=t.luckysheet_select_save)||void 0===k?void 0:k.length)===1&&t.luckysheet_select_save[0].row[0]===t.luckysheet_select_save[0].row[1]&&t.luckysheet_select_save[0].column[0]===t.luckysheet_select_save[0].column[1]){var y,k,E,C=(0,l.Fkv)(t,t.currentSheetId);E=[{row:[0,C.length-1],column:[0,C[0].length-1]}]}else E=c().assignIn([],t.luckysheet_select_save);n(function(e){0===(0,l.j7o)(E,v,void 0,e).length&&i(d.locationTipNotFindCell,"ok")})}},[v,g,t,d.locationTipNotFindCell,d.locationTiplessTwoColumn,d.locationTiplessTwoRow,b,n,i]),N=(0,o.useCallback)(function(e){return v===e},[v]);return o.createElement("div",{id:"fortune-location-condition"},o.createElement("div",{className:"title"},d.location),o.createElement("div",{className:"listbox"},o.createElement("div",{className:"listItem"},o.createElement("input",{type:"radio",name:"locationType",id:"locationConstant",checked:N("locationConstant"),onChange:function(){p("locationConstant")}}),o.createElement("label",{htmlFor:"locationConstant"},d.locationConstant),o.createElement("div",{className:"subbox"},["locationDate","locationDigital","locationString","locationBool","locationError"].map(function(e){return o.createElement("div",{className:"subItem",key:e},o.createElement("input",{type:"checkbox",disabled:!N("locationConstant"),checked:g[e],onChange:function(){E((0,a.ZP)(function(t){c().set(t,e,!t[e])}))}}),o.createElement("label",{htmlFor:e,style:{color:N("locationConstant")?"#000":"#666"}},d[e]))}))),o.createElement("div",{className:"listItem"},o.createElement("input",{type:"radio",name:"locationType",id:"locationFormula",checked:N("locationFormula"),onChange:function(){p("locationFormula")}}),o.createElement("label",{htmlFor:"locationFormula"},d.locationFormula),o.createElement("div",{className:"subbox"},["locationDate","locationDigital","locationString","locationBool","locationError"].map(function(e){return o.createElement("div",{className:"subItem",key:e},o.createElement("input",{type:"checkbox",disabled:!N("locationFormula"),checked:b[e],onChange:function(){x((0,a.ZP)(function(t){c().set(t,e,!t[e])}))}}),o.createElement("label",{htmlFor:e,style:{color:N("locationFormula")?"#000":"#666"}},d[e]))}))),["locationNull","locationRowSpan","locationColumnSpan"].map(function(e){return o.createElement("div",{className:"listItem",key:e},o.createElement("input",{type:"radio",name:e,checked:N(e),onChange:function(){p(e)}}),o.createElement("label",{htmlFor:e},d[e]))})),o.createElement("div",{className:"button-basic button-primary",onClick:function(){u(),w()}},m.confirm),o.createElement("div",{className:"button-basic button-close",onClick:function(){u()}},m.cancel))},et=function(e){var t=e.items,n=e.setOpen,a=(0,o.useContext)(k),r=a.context,i=a.setContext,u=a.refs,s=B().showDialog,d=(0,l.SP8)(r).conditionformat,m=(0,o.useCallback)(function(e){var t=e.target,n="fortune-toolbar-menu-line"===t.className?t.parentElement:t,l=n.getBoundingClientRect(),o=u.workbookContainer.current.getBoundingClientRect(),a=n.querySelector(".condition-format-sub-menu");if(!c().isNil(a)){var r=parseFloat(window.getComputedStyle(n).getPropertyValue("padding-right").replace("px",""));o.right-l.right<parseFloat(a.style.width.replace("px",""))?(a.style.display="block",a.style.right="".concat(l.width-r,"px")):(a.style.display="block",a.style.right="".concat(-(parseFloat(a.style.width.replace("px",""))+r),"px"))}},[u.workbookContainer]),f=(0,o.useCallback)(function(e){var t=e.target;if("condition-format-sub-menu"===t.className){t.style.display="none";return}var n="condition-format-item"===t.className?t.parentElement:t.querySelector(".condition-format-sub-menu");c().isNil(n)||(n.style.display="none")},[]),h=(0,o.useCallback)(function(e){return"-"===e?o.createElement(X,{key:e}):"highlightCellRules"===e?o.createElement(G,{key:e,onMouseEnter:m,onMouseLeave:f},o.createElement("div",{className:"fortune-toolbar-menu-line",key:"div".concat(e)},d[e],o.createElement(g,{name:"rightArrow",width:18}),o.createElement("div",{className:"condition-format-sub-menu",style:{display:"none",width:150}},[{text:"greaterThan",value:">"},{text:"lessThan",value:"<"},{text:"between",value:"[]"},{text:"equal",value:"="},{text:"textContains",value:"()"},{text:"occurrenceDate",value:d.yesterday},{text:"duplicateValue",value:"##"}].map(function(e){return o.createElement("div",{className:"condition-format-item",key:e.text,onClick:function(){n(!1),s(o.createElement(P,{type:e.text}))}},d[e.text],o.createElement("span",null,e.value))})))):"itemSelectionRules"===e?o.createElement(G,{key:e,onMouseEnter:m,onMouseLeave:f},o.createElement("div",{className:"fortune-toolbar-menu-line"},d[e],o.createElement(g,{name:"rightArrow",width:18}),o.createElement("div",{className:"condition-format-sub-menu",style:{display:"none",width:180}},[{text:"top10",value:d.top10},{text:"top10_percent",value:d.top10_percent},{text:"last10",value:d.last10},{text:"last10_percent",value:d.last10_percent},{text:"aboveAverage",value:d.above},{text:"belowAverage",value:d.below}].map(function(e){return o.createElement("div",{className:"condition-format-item",key:e.text,onClick:function(){n(!1),s(o.createElement(P,{type:e.text}))}},d[e.text],o.createElement("span",null,e.value))})))):"dataBar"===e||"colorGradation"===e?o.createElement("div",{className:"fortune-toolbar-menu-line",key:"div".concat(e)},d[e],o.createElement(g,{name:"rightArrow",width:18})):"icons"===e||"newFormatRule"===e?o.createElement("div",{className:"fortune-toolbar-menu-line",key:"div".concat(e)},d[e]):"deleteRule"===e?o.createElement(G,{key:e,onMouseEnter:m,onMouseLeave:f},o.createElement("div",{className:"fortune-toolbar-menu-line"},d[e],o.createElement(g,{name:"rightArrow",width:18}),o.createElement("div",{className:"condition-format-sub-menu",style:{display:"none",width:150}},["deleteSheetRule"].map(function(e){return o.createElement("div",{className:"condition-format-item",key:e,style:{padding:"6px 10px"},onClick:function(){i(function(e){(0,l.$GW)(e,"delSheet")})}},d[e])})))):"manageRules"===e?o.createElement("div",{className:"fortune-toolbar-menu-line",key:"div".concat(e)},d[e]):o.createElement("div",null)},[d,f,i,n,s,m]);return o.createElement("div",{className:"condition-format"},o.createElement(Y,{style:{overflow:"visible"}},t.map(function(e){return o.createElement("div",{key:"option".concat(e)},h(e))})))},en=function(e){var t=e.iconName,n=e.width,l=void 0===n?24:n,a=e.height,r=void 0===a?24:a,c=e.content,i=(0,o.useMemo)(function(){return t?o.createElement("svg",{width:l,height:r},o.createElement("use",{xlinkHref:"#".concat(t)})):c||o.createElement("svg",{width:l,height:l},o.createElement("use",{xlinkHref:"#default"}))},[c,r,t,l]);return o.createElement("div",{style:{width:l,height:r,display:"flex",justifyContent:"center",alignItems:"center"}},i)},el=function(e){var t=e.tooltip,n=e.onClick,l=e.selected,a=e.children,r=e.iconName,c=e.icon;return o.createElement("div",{className:"fortune-toolbar-button fortune-toolbar-item",onClick:n,"data-tips":t,role:"button",style:l?{backgroundColor:"#E7E5EB"}:{}},o.createElement(en,{iconName:r,content:c}),t&&o.createElement("div",{className:"fortune-tooltip"},t),a)},eo=[["#000000","#444444","#666666","#999999","#cccccc","#eeeeee","#f3f3f3","#ffffff"],["#f00f00","#f90f90","#ff0ff0","#0f00f0","#0ff0ff","#00f00f","#90f90f","#f0ff0f"],["#f4cccc","#fce5cd","#fff2cc","#d9ead3","#d0e0e3","#cfe2f3","#d9d2e9","#ead1dc"],["#ea9999","#f9cb9c","#ffe599","#b6d7a8","#a2c4c9","#9fc5e8","#b4a7d6","#d5a6bd"],["#e06666","#f6b26b","#ffd966","#93c47d","#76a5af","#6fa8dc","#8e7cc3","#c27ba0"],["#c00c00","#e69138","#f1c232","#6aa84f","#45818e","#3d85c6","#674ea7","#a64d79"],["#900900","#b45f06","#bf9000","#38761d","#134f5c","#0b5394","#351c75","#741b47"],["#600600","#783f04","#7f6000","#274e13","#0c343d","#073763","#20124d","#4c1130"]],ea=function(e){var t=e.onPick;return o.createElement("div",{className:"fortune-toolbar-color-picker"},eo.map(function(e,n){return o.createElement("div",{key:n,className:"fortune-toolbar-color-picker-row"},e.map(function(e){return o.createElement("div",{key:e,className:"fortune-toolbar-color-picker-item",onClick:function(){return t(e)},style:{backgroundColor:e}})}))}))},er=function(e){var t=e.onCustomPick,n=e.onColorPick,a=(0,o.useContext)(k).context,r=(0,l.SP8)(a),c=r.toolbar,i=r.sheetconfig,u=r.button,s=f((0,o.useState)("#000000"),2),d=s[0],m=s[1];return o.createElement("div",{id:"fortune-custom-color"},o.createElement("div",{className:"color-reset",onClick:function(){return t(void 0)}},i.resetColor),o.createElement("div",{className:"custom-color"},o.createElement("div",null,c.customColor,":"),o.createElement("input",{type:"color",value:d,onChange:function(e){return m(e.target.value)}}),o.createElement("div",{className:"button-basic button-primary",onClick:function(){t(d)}},u.confirm)),o.createElement(ea,{onPick:function(e){n(e)}}))},ec=[{Text:"1",value:"Thin",strokeDasharray:"1,0",strokeWidth:"1"},{Text:"2",value:"Hair",strokeDasharray:"1,5",strokeWidth:"1"},{Text:"3",value:"Dotted",strokeDasharray:"2,5",strokeWidth:"2"},{Text:"4",value:"Dashed",strokeDasharray:"5,5",strokeWidth:"2"},{Text:"5",value:"DashDot",strokeDasharray:"20,5,5,10,5,5",strokeWidth:"2"},{Text:"6",value:"DashDotDot",strokeDasharray:"20,5,5,5,5,10,5,5,5,5",strokeWidth:"2"},{Text:"8",value:"Medium",strokeDasharray:"2,0",strokeWidth:"2"},{Text:"9",value:"MediumDashed",strokeDasharray:"3,5",strokeWidth:"3"},{Text:"10",value:"MediumDashDot",strokeDasharray:"20,5,5,10,5,5",strokeWidth:"3"},{Text:"11",value:"MediumDashDotDot",strokeDasharray:"5,5,5,5,20,5,5,5,5,10",strokeWidth:"3"},{Text:"13",value:"Thick",strokeDasharray:"2,0",strokeWidth:"3"}],ei=function(e){var t=e.onPick,n=(0,o.useContext)(k),a=n.context,r=n.refs,i=(0,l.SP8)(a).border,u=f((0,o.useState)("#000000"),2),s=u[0],d=u[1],m=f((0,o.useState)("1"),2),h=m[0],v=m[1],p=(0,o.useRef)(null),y=(0,o.useRef)(null),E=(0,o.useRef)(null),C=f((0,o.useState)(""),2),b=C[0],x=C[1],w=f((0,o.useState)(""),2),N=w[0],_=w[1],R=(0,o.useCallback)(function(e){var t=e.target,n=t.getBoundingClientRect(),l=t.querySelector(".fortune-border-select-menu");c().isNil(l)||(l.style.display="block",r.workbookContainer.current.getBoundingClientRect().width-n.right>parseFloat(l.style.width.replace("px",""))?l.style.left="".concat(null==n?void 0:n.width,"px"):l.style.left="-".concat(l.style.width))},[r.workbookContainer]),M=(0,o.useCallback)(function(){y.current.style.display="none",p.current.style.display="none"},[]),S=(0,o.useCallback)(function(e,t){x(e),_(t)},[]);return o.createElement("div",null,o.createElement("div",{className:"fortune-border-select-option",key:"borderColor",onMouseEnter:function(e){R(e)},onMouseLeave:function(){M()}},o.createElement("div",{className:"fortune-toolbar-menu-line"},i.borderColor,o.createElement(g,{name:"rightArrow",style:{width:"14px"}})),o.createElement("div",{ref:E,className:"fortune-border-color-preview",style:{backgroundColor:s}}),o.createElement("div",{ref:p,className:"fortune-border-select-menu",style:{display:"none",width:"166px"}},o.createElement(er,{onCustomPick:function(e){t(e,h),E.current.style.backgroundColor=s,d(e)},onColorPick:function(e){t(e,h),d(e)}}))),o.createElement("div",{className:"fortune-border-select-option",key:"borderStyle",onMouseEnter:function(e){R(e)},onMouseLeave:function(){M()}},o.createElement("div",{className:"fortune-toolbar-menu-line"},i.borderStyle,o.createElement(g,{name:"rightArrow",style:{width:"14px"}})),o.createElement("div",{className:"fortune-border-style-preview"},o.createElement("svg",{width:"90"},o.createElement("g",{fill:"none",stroke:"black",strokeWidth:b},o.createElement("path",{strokeDasharray:N,d:"M0 0 l90 0"})))),o.createElement("div",{ref:y,className:"fortune-border-select-menu fortune-toolbar-select",style:{display:"none",width:"110px"}},o.createElement("div",{className:"fortune-border-style-picker-menu fortune-border-style-reset",onClick:function(){t(s,"1"),S("1","1,0")}},i.borderDefault),o.createElement("div",{className:"fortune-boder-style-picker"},ec.map(function(e,n){return o.createElement("div",{key:n,className:"fortune-border-style-picker-menu",onClick:function(){t(s,e.Text),v(e.Text),S(e.strokeWidth,e.strokeDasharray)}},o.createElement("svg",{height:"10",width:"90"},o.createElement("g",{fill:"none",stroke:"black",strokeWidth:e.strokeWidth},o.createElement("path",{strokeDasharray:e.strokeDasharray,d:"M0 5 l85 0"}))))})))))},eu=function(e){var t=e.type,n=e.onCancel,a=(0,o.useContext)(k),r=a.context,i=a.setContext,u=a.refs.cellInput,s=f((0,o.useState)(2),2),d=s[0],m=s[1],h=f((0,o.useState)(0),2),v=h[0],p=h[1],y=(0,l.SP8)(r),g=y.button,E=y.format,C=y.currencyDetail,b=y.dateFmtList,x=B().showDialog,w=(0,o.useMemo)(function(){return{currency:C,date:b,number:[]}},[C,b]),N=(0,o.useMemo)(function(){return w[t]},[w,t]),_=c().get(E,t),R=(0,o.useCallback)(function(){if(d<0||d>9){n(),x(E.tipDecimalPlaces,"ok");return}i(function(e){var t=(0,l.Q8D)(e,e.currentSheetId);if(!c().isNil(t)){var o=N[v].value;c().forEach(e.luckysheet_select_save,function(n){for(var a=n.row[0];a<=n.row[1];a+=1)for(var r,c,i,u,s=n.column[0];s<=n.column[1];s+=1)(null===(r=e.luckysheetfile[t].data)||void 0===r?void 0:r[a][s])&&(null===(c=e.luckysheetfile[t].data)||void 0===c?void 0:null===(i=c[a][s])||void 0===i?void 0:null===(u=i.ct)||void 0===u?void 0:u.t)==="n"&&(e.luckysheetfile[t].data[a][s].ct.fa="".concat(o).concat(0..toFixed(d)),e.luckysheetfile[t].data[a][s].m=(0,l.Vxg)("".concat(o).concat(0..toFixed(d)),e.luckysheetfile[t].data[a][s].v))}),n()}})},[n,d,E.tipDecimalPlaces,v,i,x,N]),M=(0,o.useCallback)(function(){i(function(e){(0,l.bGp)(e),u.current&&(u.current.innerHTML="")}),n()},[n,u,i]);return o.createElement("div",{id:"luckysheet-search-format"},o.createElement("div",{className:"listbox",style:{height:200}},o.createElement("div",{style:{marginBottom:16}},_,E.format,"："),o.createElement("div",{className:"inpbox",style:"currency"===t?{display:"block"}:{display:"none"}},E.decimalPlaces,"：",o.createElement("input",{className:"decimal-places-input",id:"decimal-places-input",min:0,max:9,defaultValue:2,type:"number",onChange:function(e){m(parseInt(e.target.value,10))}})),o.createElement("div",{className:"format-list"},N.map(function(e,t){return o.createElement("div",{className:"listBox".concat(t===v?" on":""),key:e.name,onClick:function(){p(t)}},o.createElement("div",null,e.name),o.createElement("div",null,e.value))}))),o.createElement("div",{className:"fortune-dialog-box-button-container",style:"currency"===t?{marginTop:40}:{marginTop:30}},o.createElement("div",{className:"fortune-message-box-button button-primary",onClick:R},g.confirm),o.createElement("div",{className:"fortune-message-box-button button-default",onClick:M},g.cancel)))},es=function(e){var t,n,a,r=e.setMoreItems,i=e.moreItemsOpen,u=(0,o.useContext)(k),s=u.context,d=u.setContext,m=u.refs,h=u.settings,v=u.handleUndo,p=u.handleRedo,y=(0,o.useRef)(s),E=(0,o.useRef)(null),C=f((0,o.useState)(-1),2),b=C[0],x=C[1],w=f((0,o.useState)([]),2),N=w[0],_=w[1],R=B(),M=R.showDialog,S=R.hideDialog,L=null===(t=s.luckysheet_select_save)||void 0===t?void 0:t[0],V=(0,l.Fkv)(s);y.current=s;var H=null==L?void 0:L.row_focus,z=null==L?void 0:L.column_focus,I=V&&null!=H&&null!=z?null==V?void 0:null===(n=V[H])||void 0===n?void 0:n[z]:void 0,D=(0,l.SP8)(s),F=D.toolbar,T=D.merge,P=D.border,W=D.freezen,O=D.defaultFmt,U=D.formula,Z=D.sort,j=D.align,en=D.textWrap,eo=D.rotation,ea=D.screenshot,ec=D.filter,es=D.splitText,ed=D.findAndReplace,em=D.comment,ef=D.fontarray,eh=(0,l.SP8)(s).format,ev=s.luckysheetTableContentHW[0],ep=f((0,o.useState)("#000000"),2),ey=ep[0],ek=ep[1],eg=f((0,o.useState)("1"),2),eE=eg[0],eC=eg[1],eb=(0,o.useCallback)(function(e,t){var n=e.target,l="fortune-toolbar-menu-line"===n.className?n.parentElement:n,o=l.getBoundingClientRect(),a=m.workbookContainer.current.getBoundingClientRect(),r=l.querySelector(".".concat(t));if(!c().isNil(r)){var i=parseFloat(window.getComputedStyle(l).getPropertyValue("padding-right").replace("px",""));a.right-o.right<parseFloat(r.style.width.replace("px",""))?(r.style.display="block",r.style.right="".concat(o.width-i,"px")):(r.style.display="block",r.style.right="more-format"===t?"".concat(-(parseFloat(r.style.width.replace("px",""))+0),"px"):"".concat(-(parseFloat(r.style.width.replace("px",""))+i),"px"))}},[m.workbookContainer]),ex=(0,o.useCallback)(function(e,t){var n=e.target;if(n.className==="".concat(t)){n.style.display="none";return}var l="condition-format-item"===n.className?n.parentElement:n.querySelector(".".concat(t));c().isNil(l)||(l.style.display="none")},[]);(0,o.useEffect)(function(){x(-1)},[h.toolbarItems,h.customToolbarItems]),(0,o.useEffect)(function(){if(-1===b){var e=E.current;if(e){var t=e.querySelectorAll(".fortune-toolbar-item");if(t){for(var n=[],l=e.getBoundingClientRect(),o=0;o<t.length;o+=1){var a=t[o].getBoundingClientRect();n.push(a.left-l.left+a.width)}_(n)}}}},[b,ev]),(0,o.useEffect)(function(){if(0!==N.length){var e=E.current;if(e){for(var t=N.length-1;t>=0;t-=1)if(N[t]+50<e.clientWidth){x(t-N.length+h.toolbarItems.length),t===N.length-1&&r(null);break}}}},[N,r,h.toolbarItems.length,ev]);var ew=(0,o.useCallback)(function(e,t){var n=F[e];if("|"===e)return o.createElement(q,{key:t});if(["font-color","background"].includes(e)){var a=function(t){d(function(n){return("font-color"===e?l.ZRe:l.Kve)(n,m.cellInput.current,t)}),"font-color"===e?m.globalCache.recentTextColor=t:m.globalCache.recentBackgroundColor=t};return o.createElement("div",{style:{position:"relative"},key:e},o.createElement("div",{style:{width:17,height:2,backgroundColor:"font-color"===e?m.globalCache.recentTextColor:m.globalCache.recentBackgroundColor,position:"absolute",bottom:8,left:9,zIndex:100}}),o.createElement(Q,{iconId:e,tooltip:n,onClick:function(){var t="font-color"===e?m.globalCache.recentTextColor:m.globalCache.recentBackgroundColor;t&&a(t)}},function(e){return o.createElement(er,{onCustomPick:function(t){a(t),e(!1)},onColorPick:a})}))}if("format"===e){var r=O[0].text;if(I){var i=(0,l.R4y)(I,"ct"),u=c().find(O,function(e){return e.value===(null==i?void 0:i.fa)});(null==i?void 0:i.fa)!=null&&(r=null!=u?u.text:O[O.length-1].text)}return o.createElement(Q,{text:r,key:e,tooltip:n},function(e){return o.createElement(Y,null,O.map(function(t,n){var a=t.text,r=t.value,c=t.example;return"split"===r?o.createElement(X,{key:n}):"fmtOtherSelf"===r?o.createElement(G,{key:r,onMouseEnter:function(e){return eb(e,"more-format")},onMouseLeave:function(e){return ex(e,"more-format")}},o.createElement("div",{className:"fortune-toolbar-menu-line"},o.createElement("div",null,a),o.createElement(g,{name:"rightArrow",width:14})),o.createElement("div",{className:"more-format toolbar-item-sub-menu fortune-toolbar-select",style:{display:"none",width:150,bottom:10,top:void 0}},[{text:eh.moreCurrency,onclick:function(){M(o.createElement(eu,{onCancel:S,type:"currency"})),e(!1)}}].map(function(t){return o.createElement("div",{className:"set-background-item fortune-toolbar-select-option",key:t.text,onClick:function(){t.onclick(),e(!1)}},t.text)}))):o.createElement(G,{key:r,onClick:function(){e(!1),d(function(e){var t=(0,l.Fkv)(e);null!=t&&(0,l.FHn)(e,m.cellInput.current,t,"ct",r)})}},o.createElement("div",{className:"fortune-toolbar-menu-line"},o.createElement("div",null,a),o.createElement("div",{className:"fortune-toolbar-subtext"},c)))}))})}if("font"===e){var h=ef[0];return(null==I?void 0:I.ff)!=null&&(h=c().isNumber(I.ff)?ef[I.ff]:I.ff),o.createElement(Q,{text:h,key:e,tooltip:n},function(e){return o.createElement(Y,null,ef.map(function(t){return o.createElement(G,{key:t,onClick:function(){d(function(e){h=t;var n=(0,l.Fkv)(e);n&&(0,l.FHn)(e,m.cellInput.current,n,"ff",t)}),e(!1)}},t)}))})}if("font-size"===e)return o.createElement(Q,{text:I?(0,l.R4y)(I,"fs",s.defaultFontSize):s.defaultFontSize.toString(),key:e,tooltip:n},function(e){return o.createElement(Y,null,[9,10,11,12,14,16,18,20,22,24,26,28,36,48,72].map(function(t){return o.createElement(G,{key:t,onClick:function(){d(function(e){return(0,l.MQw)(e,m.cellInput.current,t,m.canvas.current.getContext("2d"))}),e(!1)}},t)}))});if("horizontal-align"===e){var k,E,C=[{title:"align-left",text:j.left,value:1},{title:"align-center",text:j.center,value:0},{title:"align-right",text:j.right,value:2}];return o.createElement(Q,{iconId:(null===(E=c().find(C,function(e){return"".concat(e.value)==="".concat(null==I?void 0:I.ht)}))||void 0===E?void 0:E.title)||"align-left",key:e,tooltip:F.horizontalAlign},function(e){return o.createElement(Y,null,C.map(function(t){var n=t.text,a=t.title;return o.createElement(G,{key:a,onClick:function(){d(function(e){(0,l.UrO)(e,m.cellInput.current,a.replace("align-",""))}),e(!1)}},o.createElement("div",{className:"fortune-toolbar-menu-line"},n,o.createElement(g,{name:a})))}))})}if("vertical-align"===e){var b,x=[{title:"align-top",text:j.top,value:1},{title:"align-middle",text:j.middle,value:0},{title:"align-bottom",text:j.bottom,value:2}];return o.createElement(Q,{iconId:(null===(b=c().find(x,function(e){return"".concat(e.value)==="".concat(null==I?void 0:I.vt)}))||void 0===b?void 0:b.title)||"align-top",key:e,tooltip:F.verticalAlign},function(e){return o.createElement(Y,null,x.map(function(t){var n=t.text,a=t.title;return o.createElement(G,{key:a,onClick:function(){d(function(e){(0,l.mHC)(e,m.cellInput.current,a.replace("align-",""))}),e(!1)}},o.createElement("div",{className:"fortune-toolbar-menu-line"},n,o.createElement(g,{name:a})))}))})}if("undo"===e)return o.createElement(K,{iconId:e,tooltip:n,key:e,disabled:0===m.globalCache.undoList.length,onClick:function(){return v()}});if("redo"===e)return o.createElement(K,{iconId:e,tooltip:n,key:e,disabled:0===m.globalCache.redoList.length,onClick:function(){return p()}});if("screenshot"===e)return o.createElement(K,{iconId:e,tooltip:n,key:e,onClick:function(){var e=(0,l.Ce_)(y.current);e&&M(o.createElement("div",null,o.createElement("div",null,ea.screenshotTipSuccess),o.createElement("img",{src:e,alt:"",style:{maxWidth:"100%",maxHeight:"100%"}})))}});if("splitColumn"===e)return o.createElement(K,{iconId:e,tooltip:n,key:e,onClick:function(){if(!1!==s.allowEdit){if(c().isUndefined(s.luckysheet_select_save))M(es.tipNoSelect,"ok");else{var e=s.luckysheet_select_save[s.luckysheet_select_save.length-1].column;s.luckysheet_select_save.length>1?M(es.tipNoMulti,"ok"):e[0]!==e[1]?M(es.tipNoMultiColumn,"ok"):M(o.createElement(J,null))}}}});if("dataVerification"===e)return o.createElement(K,{iconId:e,tooltip:n,key:e,onClick:function(){!1!==s.allowEdit&&M(o.createElement(A,null))}});if("locationCondition"===e){var w=[{text:ed.location,value:"location"},{text:ed.locationFormula,value:"locationFormula"},{text:ed.locationDate,value:"locationDate"},{text:ed.locationDigital,value:"locationDigital"},{text:ed.locationString,value:"locationString"},{text:ed.locationError,value:"locationError"},{text:ed.locationRowSpan,value:"locationRowSpan"},{text:ed.columnSpan,value:"locationColumnSpan"}];return o.createElement(Q,{iconId:"locationCondition",key:e,tooltip:ed.location},function(e){return o.createElement(Y,null,w.map(function(t){var n=t.text,a=t.value;return o.createElement(G,{key:a,onClick:function(){if(null==s.luckysheet_select_save){M(W.noSeletionError,"ok");return}var t,n,r,i,u,m,f,h=s.luckysheet_select_save[0],v=[];if(r=(null===(t=s.luckysheet_select_save)||void 0===t?void 0:t.length)===0||(null===(n=s.luckysheet_select_save)||void 0===n?void 0:n.length)===1&&h.row[0]===h.row[1]&&h.column[0]===h.column[1]?[{row:[0,V.length-1],column:[0,V[0].length-1]}]:c().assignIn([],s.luckysheet_select_save),"location"===a)M(o.createElement(ee,null));else if("locationFormula"===a)d(function(e){v=(0,l.j7o)(r,"locationFormula","all",e)});else if("locationDate"===a)d(function(e){v=(0,l.j7o)(r,"locationConstant","d",e)});else if("locationDigital"===a)d(function(e){v=(0,l.j7o)(r,"locationConstant","n",e)});else if("locationString"===a)d(function(e){v=(0,l.j7o)(r,"locationConstant","s,g",e)});else if("locationError"===a)d(function(e){v=(0,l.j7o)(r,"locationConstant","e",e)});else if("locationCondition"===a)d(function(e){v=(0,l.j7o)(r,"locationCF",void 0,e)});else if("locationRowSpan"===a){if((null===(i=s.luckysheet_select_save)||void 0===i?void 0:i.length)===0||(null===(u=s.luckysheet_select_save)||void 0===u?void 0:u.length)===1&&s.luckysheet_select_save[0].row[0]===s.luckysheet_select_save[0].row[1]){M(ed.locationTiplessTwoRow,"ok");return}r=c().assignIn([],s.luckysheet_select_save),d(function(e){v=(0,l.j7o)(r,"locationRowSpan",void 0,e)})}else if("locationColumnSpan"===a){if((null===(m=s.luckysheet_select_save)||void 0===m?void 0:m.length)===0||(null===(f=s.luckysheet_select_save)||void 0===f?void 0:f.length)===1&&s.luckysheet_select_save[0].column[0]===s.luckysheet_select_save[0].column[1]){M(ed.locationTiplessTwoColumn,"ok");return}r=c().assignIn([],s.luckysheet_select_save),d(function(e){v=(0,l.j7o)(r,"locationColumnSpan",void 0,e)})}0===v.length&&"location"!==a&&M(ed.locationTipNotFindCell,"ok"),e(!1)}},o.createElement("div",{className:"fortune-toolbar-menu-line"},n))}))})}if("conditionFormat"===e){var N=["highlightCellRules","itemSelectionRules","-","deleteRule"];return o.createElement(Q,{iconId:"conditionFormat",key:e,tooltip:F.conditionalFormat},function(e){return o.createElement(et,{items:N,setOpen:e})})}if("image"===e)return o.createElement(K,{iconId:e,tooltip:F.insertImage,key:e,onClick:function(){!1!==s.allowEdit&&(0,l.bK$)()}},o.createElement("input",{id:"fortune-img-upload",type:"file",accept:"image/*",style:{display:"none"},onChange:function(e){var t,n=null===(t=e.currentTarget.files)||void 0===t?void 0:t[0];if(n){var o=new FileReader;o.readAsDataURL(n),o.onload=function(e){if(null!=e.target){var t,n=null===(t=e.target)||void 0===t?void 0:t.result,o=new Image;o.onload=function(){d(function(e){(0,l.rLb)(e,o)})},o.src=n}},e.currentTarget.value=""}}}));if("comment"===e){var _,R,L,H,z=null===(_=s.luckysheet_select_save)||void 0===_?void 0:_[s.luckysheet_select_save.length-1],D=null==z?void 0:z.row_focus,B=null==z?void 0:z.column_focus;return z?(null==D&&(D=f(z.row,1)[0]),null==B&&(B=f(z.column,1)[0])):(D=0,B=0),H=(null==V?void 0:null===(R=V[D])||void 0===R?void 0:null===(L=R[B])||void 0===L?void 0:L.ps)!=null?[{key:"edit",text:em.edit,onClick:l.DFr},{key:"delete",text:em.delete,onClick:l.YFy},{key:"showOrHide",text:em.showOne,onClick:l.u6H},{key:"showOrHideAll",text:em.showAll,onClick:l.FE4}]:[{key:"new",text:em.insert,onClick:l.vPK},{key:"showOrHideAll",text:em.showAll,onClick:l.FE4}],o.createElement(Q,{iconId:e,key:e,tooltip:n},function(e){return o.createElement(Y,null,H.map(function(t){var n=t.key,l=t.text,a=t.onClick;return o.createElement(G,{key:n,onClick:function(){d(function(e){return a(e,m.globalCache,D,B)}),e(!1)}},l)}))})}if("quick-formula"===e){var el=[{text:U.sum,value:"SUM"},{text:U.average,value:"AVERAGE"},{text:U.count,value:"COUNT"},{text:U.max,value:"MAX"},{text:U.min,value:"MIN"}];return o.createElement(Q,{iconId:"formula-sum",key:e,tooltip:F.autoSum,onClick:function(){return d(function(e){(0,l.yiK)(e,m.cellInput.current,m.fxInput.current,m.globalCache)})}},function(e){return o.createElement(Y,null,el.map(function(t){var n=t.value,a=t.text;return o.createElement(G,{key:n,onClick:function(){d(function(e){(0,l.yax)(e,m.cellInput.current,m.fxInput.current,n,m.globalCache)}),e(!1)}},o.createElement("div",{className:"fortune-toolbar-menu-line"},o.createElement("div",null,a),o.createElement("div",{className:"fortune-toolbar-subtext"},n)))}),o.createElement(X,null),o.createElement(G,{key:"formula",onClick:function(){M(o.createElement($,{onCancel:S})),e(!1)}},"".concat(U.find,"...")))})}if("merge-cell"===e){var ev=[{text:T.mergeAll,value:"merge-all"},{text:T.mergeV,value:"merge-vertical"},{text:T.mergeH,value:"merge-horizontal"},{text:T.mergeCancel,value:"merge-cancel"}];return o.createElement(Q,{iconId:"merge-all",key:e,tooltip:n,text:"合并单元格",onClick:function(){return d(function(e){(0,l.ME4)(e,"merge-all")})}},function(e){return o.createElement(Y,null,ev.map(function(t){var n=t.text,a=t.value;return o.createElement(G,{key:a,onClick:function(){d(function(e){(0,l.ME4)(e,a)}),e(!1)}},o.createElement("div",{className:"fortune-toolbar-menu-line"},o.createElement(g,{name:a,style:{marginRight:4}}),n))}))})}if("border"===e){var ep=[{text:P.borderTop,value:"border-top"},{text:P.borderBottom,value:"border-bottom"},{text:P.borderLeft,value:"border-left"},{text:P.borderRight,value:"border-right"},{text:"",value:"divider"},{text:P.borderNone,value:"border-none"},{text:P.borderAll,value:"border-all"},{text:P.borderOutside,value:"border-outside"},{text:"",value:"divider"},{text:P.borderInside,value:"border-inside"},{text:P.borderHorizontal,value:"border-horizontal"},{text:P.borderVertical,value:"border-vertical"},{text:P.borderSlash,value:"border-slash"},{text:"",value:"divider"}];return o.createElement(Q,{iconId:"border-all",key:e,tooltip:n,text:"边框设置",onClick:function(){return d(function(e){(0,l.Gv5)(e,"border-all",ey,eE)})}},function(e){return o.createElement(Y,null,ep.map(function(t,n){var a=t.text,r=t.value;return"divider"!==r?o.createElement(G,{key:r,onClick:function(){d(function(e){(0,l.Gv5)(e,r,ey,eE)}),e(!1)}},o.createElement("div",{className:"fortune-toolbar-menu-line"},a,o.createElement(g,{name:r}))):o.createElement(X,{key:n})}),o.createElement(ei,{onPick:function(e,t){ek(e),eC(t)}}))})}if("freeze"===e){var eg=[{text:W.freezenRowRange,value:"freeze-row"},{text:W.freezenColumnRange,value:"freeze-col"},{text:W.freezenRCRange,value:"freeze-row-col"},{text:W.freezenCancel,value:"freeze-cancel"}];return o.createElement(Q,{iconId:"freeze-row-col",key:e,tooltip:n,onClick:function(){return d(function(e){(0,l.Owj)(e,"freeze-row-col")})}},function(e){return o.createElement(Y,null,eg.map(function(t){var n=t.text,a=t.value;return o.createElement(G,{key:a,onClick:function(){d(function(e){(0,l.Owj)(e,a)}),e(!1)}},o.createElement("div",{className:"fortune-toolbar-menu-line"},n,o.createElement(g,{name:a})))}))})}if("text-wrap"===e){var ew=[{text:en.clip,iconId:"text-clip",value:"clip"},{text:en.overflow,iconId:"text-overflow",value:"overflow"},{text:en.wrap,iconId:"text-wrap",value:"wrap"}],eN=ew[0];return(null==I?void 0:I.tb)!=null&&(eN=c().get(ew,I.tb)),o.createElement(Q,{iconId:eN.iconId,key:e,tooltip:F.textWrap},function(e){return o.createElement(Y,null,ew.map(function(t){var n=t.text,a=t.iconId,r=t.value;return o.createElement(G,{key:r,onClick:function(){d(function(e){var t=(0,l.Fkv)(e);null!=t&&(0,l.FHn)(e,m.cellInput.current,t,"tb",r)}),e(!1)}},o.createElement("div",{className:"fortune-toolbar-menu-line"},n,o.createElement(g,{name:a})))}))})}if("text-rotation"===e){var e_=[{text:eo.none,iconId:"text-rotation-none",value:"none"},{text:eo.angleup,iconId:"text-rotation-angleup",value:"angleup"},{text:eo.angledown,iconId:"text-rotation-angledown",value:"angledown"},{text:eo.vertical,iconId:"text-rotation-vertical",value:"vertical"},{text:eo.rotationUp,iconId:"text-rotation-up",value:"rotation-up"},{text:eo.rotationDown,iconId:"text-rotation-down",value:"rotation-down"}],eR=e_[0];return(null==I?void 0:I.tr)!=null&&(eR=c().get(e_,I.tr)),o.createElement(Q,{iconId:eR.iconId,key:e,tooltip:F.textRotate},function(e){return o.createElement(Y,null,e_.map(function(t){var n=t.text,a=t.iconId,r=t.value;return o.createElement(G,{key:r,onClick:function(){d(function(e){var t=(0,l.Fkv)(e);null!=t&&(0,l.FHn)(e,m.cellInput.current,t,"tr",r)}),e(!1)}},o.createElement("div",{className:"fortune-toolbar-menu-line"},n,o.createElement(g,{name:a})))}))})}if("filter"===e){var eM=[{iconId:"sort-asc",value:"sort-asc",text:Z.asc,onClick:function(){d(function(e){(0,l.yBK)(e,!0)})}},{iconId:"sort-desc",value:"sort-desc",text:Z.desc,onClick:function(){d(function(e){(0,l.yBK)(e,!1)})}},{iconId:"",value:"divider"},{iconId:"filter1",value:"filter",text:ec.filter,onClick:function(){return d(function(e){(0,l.cjq)(e)})}},{iconId:"eraser",value:"eraser",text:ec.clearFilter,onClick:function(){return d(function(e){(0,l.Dgn)(e)})}}];return o.createElement(Q,{iconId:"filter",key:e,tooltip:F.sortAndFilter},function(e){return o.createElement(Y,null,eM.map(function(t,n){var l=t.text,a=t.iconId,r=t.value,c=t.onClick;return"divider"!==r?o.createElement(G,{key:r,onClick:function(){null==c||c(),e(!1)}},o.createElement("div",{className:"fortune-toolbar-menu-line"},l,o.createElement(g,{name:a}))):o.createElement(X,{key:"divider-".concat(n)})}))})}return o.createElement(K,{iconId:e,tooltip:n,key:e,selected:null===(k=(0,l.cA0)(e))||void 0===k?void 0:k(I),onClick:function(){return d(function(t){var n;null===(n=(0,l.aL4)(e))||void 0===n||n(t,m.cellInput.current,m.globalCache)})}})},[F,I,d,m.cellInput,m.fxInput,m.globalCache,O,j,v,p,V,U,M,S,T,P,W,ea,Z,en,eo,ec,es,ed,s.luckysheet_select_save,s.defaultFontSize,s.allowEdit,em,ef,ex,eb,m.canvas,ey,eE,eh.moreCurrency]);return o.createElement("div",{ref:E,className:"fortune-toolbar"},h.customToolbarItems.map(function(e){return o.createElement(el,{tooltip:e.tooltip,onClick:e.onClick,key:e.key,icon:e.icon,iconName:e.iconName},e.children)}),(null===(a=h.customToolbarItems)||void 0===a?void 0:a.length)>0?o.createElement(q,{key:"customDivider"}):null,(-1===b?h.toolbarItems:h.toolbarItems.slice(0,b+1)).map(function(e,t){return ew(e,t)}),-1!==b&&b<h.toolbarItems.length-1?o.createElement(K,{iconId:"more",tooltip:F.toolMore,onClick:function(){i?r(null):r(h.toolbarItems.slice(b+1).map(function(e,t){return ew(e,t)}))}}):null)},ed=function(){var e=(0,o.useContext)(k).context,t=(0,o.useMemo)(function(){var t=c().last(e.luckysheet_select_save);if(!(t&&null!=t.row_focus&&null!=t.column_focus))return"";var n=t.row_focus,o=t.column_focus;return null!=e.config.merge&&"".concat(n,"_").concat(o) in e.config.merge?(0,l.ADb)(e,e.currentSheetId,{column:[o,o],row:[n,n]}):(0,l.ADb)(e,e.currentSheetId,t)},[e.currentSheetId,e.luckysheet_select_save]);return o.createElement("div",{className:"fortune-name-box-container"},o.createElement("div",{className:"fortune-name-box",tabIndex:0,dir:"ltr","aria-autocomplete":"list"},t))},em=function(){var e,t=(0,o.useContext)(k),n=t.context,a=t.setContext,r=t.refs,i=f((0,o.useState)(!1),2),u=i[0],s=i[1],d=(0,o.useRef)(),m=(0,o.useRef)(null),h=f((0,o.useState)(!1),2),v=h[0],p=h[1],y=null===(e=n.luckysheet_select_save)||void 0===e?void 0:e[0],E=N(y),C=N(n.currentSheetId),_=(0,o.useRef)("");(0,o.useEffect)(function(){if(p((0,l.zwZ)(n)),!c().isEqual(E,y)||n.currentSheetId!==C){var e=(0,l.Fkv)(n),t="";if(y){var o,a=y.row_focus,i=y.column_focus;if(c().isNil(a)||c().isNil(i))return;var u=null==e?void 0:null===(o=e[a])||void 0===o?void 0:o[i];u&&(t=(0,l.Zhd)(u)?(0,l.lrp)(a,i,e):u.f?(0,l.C_)(a,i,e,"f"):(0,l.U2_)(a,i,e)),r.fxInput.current.innerHTML=(0,l.ndh)((0,l.n9Q)(t))}else r.fxInput.current.innerHTML=""}},[n.luckysheetfile,n.currentSheetId,n.luckysheet_select_save]);var R=(0,o.useCallback)(function(){var e,t;!1!==n.allowEdit&&(null!==(e=null===(t=n.luckysheet_select_save)||void 0===t?void 0:t.length)&&void 0!==e?e:0)>0&&!n.luckysheet_cell_selected_move&&(0,l.RhZ)(n,n.luckysheet_select_save)&&(s(!0),a(function(e){var t=e.luckysheet_select_save[e.luckysheet_select_save.length-1],n=t.row_focus,l=t.column_focus;e.luckysheetCellUpdate=[n,l],r.globalCache.doNotFocus=!0}))},[n.config,n.luckysheet_select_save,n.luckysheetfile,n.currentSheetId,r.globalCache,a]),M=(0,o.useCallback)(function(e){if(!1!==n.allowEdit){d.current=new KeyboardEvent(e.type,e.nativeEvent);var t=e.key;_.current=r.fxInput.current.innerText,("ArrowLeft"===t||"ArrowRight"===t)&&e.stopPropagation(),a(function(o){if(n.luckysheetCellUpdate.length>0)switch(t){case"Enter":var a=c().clone(o.luckysheetCellUpdate);(0,l.wWT)(o,o.luckysheetCellUpdate[0],o.luckysheetCellUpdate[1],r.fxInput.current),o.luckysheet_select_save=[{row:[a[0],a[0]],column:[a[1],a[1]],row_focus:a[0],column_focus:a[1]}],(0,l.aP1)(o,"down",1,"rangeOfSelect"),e.preventDefault(),e.stopPropagation();break;case"Escape":(0,l.bGp)(o),(0,l.aP1)(o,"down",0,"rangeOfSelect"),e.preventDefault(),e.stopPropagation();break;case"ArrowLeft":case"ArrowRight":(0,l.NZB)(o,r.fxInput.current)}})}},[n.allowEdit,n.luckysheetCellUpdate.length,r.fxInput,a]),S=(0,o.useCallback)(function(){var e=d.current;if(e){var t=e.keyCode;t&&(!(t>=112&&t<=123||t<=46||144===t||108===t||e.ctrlKey||e.altKey||e.shiftKey&&(37===t||38===t||39===t||40===t))||8===t||32===t||46===t||e.ctrlKey&&86===t)&&a(function(e){(0,l.BTV)(e,r.cellInput.current,r.fxInput.current,t,_.current)})}},[r.cellInput,r.fxInput,a]),L=(0,o.useMemo)(function(){return!1!==n.allowEdit&&!v&&!!(0,l.RhZ)(n,n.luckysheet_select_save)},[n.config,n.luckysheet_select_save,n.luckysheetfile,n.currentSheetId,v]);return o.createElement("div",{className:"fortune-fx-editor"},o.createElement(ed,null),o.createElement("div",{className:"fortune-fx-icon"},o.createElement(g,{name:"fx",width:18,height:18})),o.createElement("div",{ref:m,className:"fortune-fx-input-container"},o.createElement(b,{innerRef:function(e){r.fxInput.current=e},className:"fortune-fx-input",id:"luckysheet-functionbox-cell","aria-autocomplete":"list",onFocus:R,onKeyDown:M,onChange:S,onBlur:function(){return s(!1)},tabIndex:0,allowEdit:L}),u&&o.createElement(o.Fragment,null,o.createElement(x,{style:{top:m.current.clientHeight}}),o.createElement(w,{style:{top:m.current.clientHeight}}))))},ef=function(e){var t=e.sheet,n=e.isDropPlaceholder,a=(0,o.useContext)(k),r=a.context,i=a.setContext,u=a.refs,s=f((0,o.useState)(!1),2),d=s[0],m=s[1],h=(0,o.useRef)(null),v=(0,o.useRef)(null),p=f((0,o.useState)(!1),2),y=p[0],E=p[1],C=f((0,o.useState)("#c3c3c3"),2),b=C[0],x=C[1],w=H().showAlert;(0,o.useEffect)(function(){i(function(e){var t,n,l,o,a=r.sheetScrollRecord[null==e?void 0:e.currentSheetId];a?(e.scrollLeft=null!==(t=a.scrollLeft)&&void 0!==t?t:0,e.scrollTop=null!==(n=a.scrollTop)&&void 0!==n?n:0,e.luckysheet_select_status=null!==(l=a.luckysheet_select_status)&&void 0!==l&&l,e.luckysheet_select_save=null!==(o=a.luckysheet_select_save)&&void 0!==o?o:void 0):(e.scrollLeft=0,e.scrollTop=0,e.luckysheet_select_status=!1,e.luckysheet_select_save=void 0),e.luckysheet_selection_range=[]})},[r.currentSheetId,r.sheetScrollRecord,i]),(0,o.useEffect)(function(){if(v.current){if(d){if(window.getSelection){var e=document.createRange();if(e.selectNodeContents(v.current),e.startContainer&&document.body.contains(e.startContainer)){var t=window.getSelection();null==t||t.removeAllRanges(),null==t||t.addRange(e)}}else if(document.selection){var n=document.body.createTextRange();n.moveToElementText(v.current),n.select()}}v.current.dataset.oldText=v.current.innerText}},[d]);var N=(0,o.useCallback)(function(){i(function(e){try{(0,l.Jw0)(e,v.current)}catch(e){w(e.message)}}),m(!1)},[i,w]),_=(0,o.useCallback)(function(e){if("Enter"===e.key){var t;null===(t=v.current)||void 0===t||t.blur()}e.stopPropagation()},[]),R=(0,o.useCallback)(function(e){!0===r.allowEdit&&e.dataTransfer.setData("sheetId","".concat(t.id)),e.stopPropagation()},[r.allowEdit,t.id]),M=(0,o.useCallback)(function(e){if(!1!==r.allowEdit){var l=e.dataTransfer.getData("sheetId");i(function(e){var o,a,r=t.id;c().sortBy(e.luckysheetfile,["order"]).forEach(function(e,t){e.order=t,e.id===l?o=e:e.id===r&&(a=e)}),o&&a?(o.order=a.order-.1,c().sortBy(e.luckysheetfile,["order"]).forEach(function(e,t){e.order=t})):o&&n&&(o.order=e.luckysheetfile.length)}),E(!1),e.stopPropagation()}},[r.allowEdit,n,i,t.id]);return o.createElement("div",{onDragOver:function(e){e.preventDefault(),e.stopPropagation()},onDragEnter:function(e){E(!0),e.stopPropagation()},onDragLeave:function(e){E(!1),e.stopPropagation()},onDragEnd:function(e){E(!1),e.stopPropagation()},onDrop:M,onDragStart:R,draggable:r.allowEdit&&!d,key:t.id,ref:h,className:n?"fortune-sheettab-placeholder":"luckysheet-sheets-item".concat(r.currentSheetId===t.id?" luckysheet-sheets-item-active":""),onClick:function(){n||i(function(e){e.sheetScrollRecord[e.currentSheetId]={scrollLeft:e.scrollLeft,scrollTop:e.scrollTop,luckysheet_select_status:e.luckysheet_select_status,luckysheet_select_save:e.luckysheet_select_save,luckysheet_selection_range:e.luckysheet_selection_range},e.dataVerificationDropDownList=!1,e.currentSheetId=t.id,e.zoomRatio=t.zoomRatio||1,(0,l.z96)(e,u.globalCache),(0,l.bGp)(e)})},onContextMenu:function(e){if(!n){var l=u.workbookContainer.current.getBoundingClientRect(),o=e.pageX,a=e.pageY;i(function(e){e.dataVerificationDropDownList=!1,e.currentSheetId=t.id,e.zoomRatio=t.zoomRatio||1,e.sheetTabContextMenu={x:o-l.left-window.scrollX,y:a-l.top-window.scrollY,sheet:t,onRename:function(){return m(!0)}}})}},style:{borderLeft:y?"2px solid #0188fb":"",display:1===t.hide?"none":""}},o.createElement("span",{className:"luckysheet-sheets-item-name",spellCheck:"false",suppressContentEditableWarning:!0,contentEditable:!n&&d,onDoubleClick:function(){return m(!0)},onBlur:N,onKeyDown:_,ref:v,style:y?{pointerEvents:"none"}:{}},t.name),o.createElement("span",{className:"luckysheet-sheets-item-function",onMouseEnter:function(){return x("#5c5c5c")},onMouseLeave:function(){return x("#c3c3c3")},onClick:function(e){if(!n&&!1!==r.allowEdit){var l=u.workbookContainer.current.getBoundingClientRect(),o=e.pageX,a=e.pageY;i(function(e){e.currentSheetId=t.id,e.sheetTabContextMenu={x:o-l.left-window.scrollX,y:a-l.top-window.scrollY,sheet:t,onRename:function(){return m(!0)}}})}}},o.createElement(g,{name:"downArrow",width:12,style:{fill:b}})),!!t.color&&o.createElement("div",{className:"luckysheet-sheets-item-color",style:{background:t.color}}))},eh=[{text:"10%",value:.1},{text:"30%",value:.3},{text:"50%",value:.5},{text:"70%",value:.7},{text:"100%",value:1},{text:"150%",value:1.5},{text:"200%",value:2},{text:"300%",value:3},{text:"400%",value:4}],ev=function(){var e=(0,o.useContext)(k),t=e.context,n=e.setContext,a=(0,o.useRef)(null),r=f((0,o.useState)(!1),2),c=r[0],i=r[1];O(a,function(){i(!1)},[]);var u=(0,o.useCallback)(function(e){(e=parseFloat(e.toFixed(1)))>l.xq5||e<l.qF_||n(function(t){var n=(0,l.Q8D)(t,t.currentSheetId);null!=n&&(t.luckysheetfile[n].zoomRatio=e,t.zoomRatio=e)},{noHistory:!0})},[n]);return o.createElement("div",{className:"fortune-zoom-container"},o.createElement("div",{className:"fortune-zoom-button",onClick:function(e){u(t.zoomRatio-.1),e.stopPropagation()}},o.createElement(g,{name:"minus",width:16,height:16})),o.createElement("div",{className:"fortune-zoom-ratio"},o.createElement("div",{className:"fortune-zoom-ratio-current fortune-zoom-button",onClick:function(){return i(!0)}},(100*t.zoomRatio).toFixed(0),"%"),c&&o.createElement("div",{className:"fortune-zoom-ratio-menu",ref:a},eh.map(function(e){return o.createElement("div",{className:"fortune-zoom-ratio-item",key:e.text,onClick:function(t){u(e.value),t.preventDefault()}},o.createElement("div",{className:"fortune-zoom-ratio-text"},e.text))}))),o.createElement("div",{className:"fortune-zoom-button",onClick:function(e){u(t.zoomRatio+.1),e.stopPropagation()}},o.createElement(g,{name:"plus",width:16,height:16})))},ep=function(){var e=(0,o.useContext)(k),t=e.context,n=e.setContext,a=e.settings,r=e.refs,i=(0,o.useRef)(null),u=(0,o.useRef)(null),s=(0,o.useRef)(null),d=f((0,o.useState)(!1),2),m=d[0],h=d[1],v=f((0,o.useState)(!0),2),p=v[0],y=v[1],E=(0,o.useCallback)(function(e){if(null!=i.current&&null!=i.current.scrollLeft){var t,n=i.current.scrollLeft;n+e<=0?y(!0):n>0&&y(!1),null===(t=i.current)||void 0===t||t.scrollBy({left:e,behavior:"smooth"})}},[]);(0,o.useEffect)(function(){var e=i.current;e&&h(e.scrollWidth-2>e.clientWidth)},[t.luckysheetfile]);var C=(0,o.useCallback)(function(){return setTimeout(function(){n(function(e){e.luckysheetCellUpdate.length>0&&(0,l.wWT)(e,e.luckysheetCellUpdate[0],e.luckysheetCellUpdate[1],r.cellInput.current),(0,l.AaX)(e,a)},{addSheetOp:!0});var e=i.current;h(e.scrollWidth>e.clientWidth)})},[r.cellInput,n,a]);return o.createElement("div",{className:"luckysheet-sheet-area luckysheet-noselected-text",onContextMenu:function(e){return e.preventDefault()},id:"luckysheet-sheet-area"},o.createElement("div",{id:"luckysheet-sheet-content"},t.allowEdit&&o.createElement("div",{className:"fortune-sheettab-button",onClick:C},o.createElement(g,{name:"plus",width:16,height:16})),t.allowEdit&&o.createElement("div",{className:"sheet-list-container"},o.createElement("div",{id:"all-sheets",className:"fortune-sheettab-button",ref:i,onMouseDown:function(e){e.stopPropagation(),n(function(e){e.showSheetList=!!c().isUndefined(e.showSheetList)||!e.showSheetList,e.sheetTabContextMenu={}})}},o.createElement(g,{name:"all-sheets",width:16,height:16}))),o.createElement("div",{id:"luckysheet-sheets-m",className:"luckysheet-sheets-m lucky-button-custom"},o.createElement("i",{className:"iconfont luckysheet-iconfont-caidan2"})),o.createElement("div",{className:"fortune-sheettab-container",id:"fortune-sheettab-container"},!p&&o.createElement("div",{className:"boundary boundary-left"}),o.createElement("div",{className:"fortune-sheettab-container-c",id:"fortune-sheettab-container-c",ref:i},c().sortBy(t.luckysheetfile,function(e){return Number(e.order)}).map(function(e){return o.createElement(ef,{key:e.id,sheet:e})})),p&&m&&o.createElement("div",{className:"boundary boundary-right"})),m&&o.createElement("div",{id:"fortune-sheettab-leftscroll",className:"fortune-sheettab-scroll",ref:u,onClick:function(){E(-150)}},o.createElement(g,{name:"arrow-doubleleft",width:12,height:12})),m&&o.createElement("div",{id:"fortune-sheettab-rightscroll",className:"fortune-sheettab-scroll",ref:s,onClick:function(){E(150)}},o.createElement(g,{name:"arrow-doubleright",width:12,height:12}))),o.createElement("div",{className:"fortune-sheet-area-right"},o.createElement(ev,null)))},ey=function(){return o.createElement("div",{className:"fortune-context-menu-divider"})},ek=function(e){var t=e.onClick,n=e.onMouseLeave,l=e.onMouseEnter,a=e.children,r=(0,o.useRef)(null);return o.createElement("div",{ref:r,className:"luckysheet-cols-menuitem luckysheet-mousedown-cancel",onClick:function(e){return null==t?void 0:t(e,r.current)},onMouseLeave:function(e){return null==n?void 0:n(e,r.current)},onMouseEnter:function(e){return null==l?void 0:l(e,r.current)}},o.createElement("div",{className:"luckysheet-cols-menuitem-content luckysheet-mousedown-cancel"},a))},eg=function(){var e=f((0,o.useState)([]),2),t=e[0],n=e[1],a=f((0,o.useState)(!0),2),r=a[0],c=a[1],i=(0,o.useContext)(k),u=i.context,s=i.setContext,d=f((0,o.useState)("0"),2),m=d[0],h=d[1],v=f((0,o.useState)(!1),2),p=v[0],y=v[1],g=(0,l.SP8)(u).sort,E=B().hideDialog,C=u.luckysheet_select_save[0].column[0],b=u.luckysheet_select_save[0].column[1],x=u.luckysheet_select_save[0].row[0],w=u.luckysheet_select_save[0].row[1],N=(0,l.Q8D)(u,u.currentSheetId),_=(0,o.useCallback)(function(e){c("asc"===e.target.value)},[]),R=(0,o.useCallback)(function(e){y(e.target.checked)},[]);return(0,o.useEffect)(function(){var e=[];if(p)for(var t=C;t<=b;t+=1){var o,a,r=null===(o=u.luckysheetfile[N].data)||void 0===o?void 0:null===(a=o[x])||void 0===a?void 0:a[t],c=(null==r?void 0:r.m)||(null==r?void 0:r.v);if(c)e.push(c);else{var i=(0,l.q8X)(t);e.push("".concat(g.columnOperation," ").concat(i))}}else for(var s=C;s<=b;s+=1){var d=(0,l.q8X)(s);e.push(d)}n(e)},[b,C,u.luckysheetfile,p,x,N,g.columnOperation]),o.createElement("div",{className:"fortune-sort"},o.createElement("div",{className:"fortune-sort-title"},o.createElement("span",null,o.createElement("span",null,g.sortRangeTitle),(0,l.q8X)(C),x+1,o.createElement("span",null,g.sortRangeTitleTo),(0,l.q8X)(b),w+1)),o.createElement("div",null,o.createElement("div",{className:"fortune-sort-modal"},o.createElement("div",null,o.createElement("input",{type:"checkbox",id:"fortune-sort-haveheader",onChange:R}),o.createElement("span",null,g.hasTitle)),o.createElement("div",{className:"fortune-sort-tablec"},o.createElement("table",{cellSpacing:"0"},o.createElement("tbody",null,o.createElement("tr",null,o.createElement("td",{style:{width:"190px"}},g.sortBy,o.createElement("select",{name:"sort_0",onChange:function(e){h(e.target.value)}},t.map(function(e,t){return o.createElement("option",{value:t,key:t},e)}))),o.createElement("td",null,o.createElement("div",null,o.createElement("input",{type:"radio",value:"asc",defaultChecked:!0,name:"sort_0",onChange:_}),o.createElement("span",null,g.asc)),o.createElement("div",null,o.createElement("input",{type:"radio",value:"desc",name:"sort_0",onChange:_}),o.createElement("span",null,g.desc))))))))),o.createElement("div",{className:"fortune-sort-button"},o.createElement("div",{className:"button-basic button-primary",onClick:function(){s(function(e){(0,l.rsr)(e,r,parseInt(m,10)),e.contextMenu={}}),E()}},g.confirm)))},eE=function(){var e=B().showDialog,t=(0,o.useRef)(null),n=(0,o.useContext)(k),a=n.context,r=n.setContext,i=n.settings,u=n.refs,d=a.contextMenu,m=H().showAlert,h=(0,l.SP8)(a),v=h.rightclick,p=h.drag,y=h.generalDialog,g=h.info,E=(0,o.useCallback)(function(t,n){var i=null===(h=a.luckysheet_select_save)||void 0===h?void 0:h[0];if("|"===t)return o.createElement(ey,{key:"divider-".concat(n)});if("copy"===t)return o.createElement(ek,{key:t,onClick:function(){r(function(e){var t;if((null===(t=e.luckysheet_select_save)||void 0===t?void 0:t.length)>1){m(v.noMulti,"ok"),e.contextMenu={};return}(0,l.r08)(e),e.contextMenu={}})}},v.copy);if("paste"===t)return o.createElement(ek,{key:t,onClick:(u=regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.clipboard.readText();case 2:t=e.sent,r(function(e){(0,l.I_Q)(e,t),e.contextMenu={}});case 4:case"end":return e.stop()}},e)}),d=function(){var e=this,t=arguments;return new Promise(function(n,l){var o=u.apply(e,t);function a(e){s(o,n,l,a,r,"next",e)}function r(e){s(o,n,l,a,r,"throw",e)}a(void 0)})},function(){return d.apply(this,arguments)})},v.paste);if("insert-column"===t)return(null==i?void 0:i.row_select)?null:["left","right"].map(function(e){var t,n;return o.createElement(ek,{key:"add-col-".concat(e),onClick:function(t){var n,o,c,i,u=null===(n=a.luckysheet_select_save)||void 0===n?void 0:null===(o=n[0])||void 0===o?void 0:null===(c=o.column)||void 0===c?void 0:c[0];if(null!=u){var s=null===(i=t.target.querySelector("input"))||void 0===i?void 0:i.value;if(null!=s){var d=parseInt(s,10);if(!(d<1)){var f={type:"column",index:u,count:d,direction:"left"===e?"lefttop":"rightbottom",id:a.currentSheetId};r(function(e){try{(0,l.mco)(e,f),e.contextMenu={}}catch(t){"maxExceeded"===t.message?m(v.columnOverLimit,"ok"):"readOnly"===t.message&&m(v.cannotInsertOnColumnReadOnly,"ok"),e.contextMenu={}}},{insertRowColOp:f})}}}}},o.createElement(o.Fragment,null,c().startsWith(null!==(t=a.lang)&&void 0!==t?t:"","zh")&&o.createElement(o.Fragment,null,v.to,o.createElement("span",{className:"luckysheet-cols-rows-shift-".concat(e)},v[e])),"".concat(v.insert,"  "),o.createElement("input",{onClick:function(e){return e.stopPropagation()},onKeyDown:function(e){return e.stopPropagation()},type:"text",className:"luckysheet-mousedown-cancel",placeholder:v.number,defaultValue:"1"}),o.createElement("span",{className:"luckysheet-cols-rows-shift-word luckysheet-mousedown-cancel"},"".concat(v.column,"  ")),!c().startsWith(null!==(n=a.lang)&&void 0!==n?n:"","zh")&&o.createElement("span",{className:"luckysheet-cols-rows-shift-".concat(e)},v[e])))});if("insert-row"===t)return(null==i?void 0:i.column_select)?null:["top","bottom"].map(function(e){var t,n;return o.createElement(ek,{key:"add-row-".concat(e),onClick:function(t,n){var o,c,i,u,s=null===(o=a.luckysheet_select_save)||void 0===o?void 0:null===(c=o[0])||void 0===c?void 0:null===(i=c.row)||void 0===i?void 0:i[0];if(null!=s){var d=null===(u=n.querySelector("input"))||void 0===u?void 0:u.value;if(null!=d){var f=parseInt(d,10);if(!(f<1)){var h={type:"row",index:s,count:f,direction:"top"===e?"lefttop":"rightbottom",id:a.currentSheetId};r(function(e){try{(0,l.mco)(e,h),e.contextMenu={}}catch(t){"maxExceeded"===t.message?m(v.rowOverLimit,"ok"):"readOnly"===t.message&&m(v.cannotInsertOnRowReadOnly,"ok"),e.contextMenu={}}},{insertRowColOp:h})}}}}},o.createElement(o.Fragment,null,c().startsWith(null!==(t=a.lang)&&void 0!==t?t:"","zh")&&o.createElement(o.Fragment,null,v.to,o.createElement("span",{className:"luckysheet-cols-rows-shift-".concat(e)},v[e])),"".concat(v.insert,"  "),o.createElement("input",{onClick:function(e){return e.stopPropagation()},onKeyDown:function(e){return e.stopPropagation()},type:"text",className:"luckysheet-mousedown-cancel",placeholder:v.number,defaultValue:"1"}),o.createElement("span",{className:"luckysheet-cols-rows-shift-word luckysheet-mousedown-cancel"},"".concat(v.row,"  ")),!c().startsWith(null!==(n=a.lang)&&void 0!==n?n:"","zh")&&o.createElement("span",{className:"luckysheet-cols-rows-shift-".concat(e)},v[e])))});if("delete-column"===t)return(null==i?void 0:i.column_select)&&o.createElement(ek,{key:"delete-col",onClick:function(){if(i){var e=f(i.column,2),t=e[0],n=e[1],o={type:"column",start:t,end:n,id:a.currentSheetId};r(function(e){if((null===(r=e.luckysheet_select_save)||void 0===r?void 0:r.length)>1){m(v.noMulti,"ok"),e.contextMenu={},e.dataVerificationDropDownList=!1;return}var r,c,i,u=n-t+1,s=(0,l.Q8D)(e,a.currentSheetId);if((null===(c=e.luckysheetfile[s].data)||void 0===c?void 0:null===(i=c[0])||void 0===i?void 0:i.length)<=u){m(v.cannotDeleteAllColumn,"ok"),e.contextMenu={};return}try{(0,l.Omi)(e,o)}catch(e){"readOnly"===e.message&&m(v.cannotDeleteColumnReadOnly,"ok")}e.contextMenu={}},{deleteRowColOp:o})}}},v.deleteSelected,v.column);if("delete-row"===t)return(null==i?void 0:i.row_select)&&o.createElement(ek,{key:"delete-row",onClick:function(){if(i){var e=f(i.row,2),t=e[0],n=e[1],o={type:"row",start:t,end:n,id:a.currentSheetId};r(function(e){if((null===(r=e.luckysheet_select_save)||void 0===r?void 0:r.length)>1){m(v.noMulti,"ok"),e.contextMenu={};return}var r,c,i=n-t+1,u=(0,l.Q8D)(e,a.currentSheetId);if((null===(c=e.luckysheetfile[u].data)||void 0===c?void 0:c.length)<=i){m(v.cannotDeleteAllRow,"ok"),e.contextMenu={};return}try{(0,l.Omi)(e,o)}catch(e){"readOnly"===e.message&&m(v.cannotDeleteRowReadOnly,"ok")}e.contextMenu={}},{deleteRowColOp:o})}}},v.deleteSelected,v.row);if("hide-row"===t)return(null==i?void 0:i.row_select)===!0&&["hideSelected","showHide"].map(function(t){return o.createElement(ek,{key:t,onClick:function(){r(function(n){var o="";"hideSelected"===t?o=(0,l.KFw)(n,"row"):"showHide"===t&&(0,l.Sm_)(n,"row"),"noMulti"===o&&e(p.noMulti),n.contextMenu={}})}},v[t]+v.row)});if("hide-column"===t)return(null==i?void 0:i.column_select)===!0&&["hideSelected","showHide"].map(function(t){return o.createElement(ek,{key:t,onClick:function(){r(function(n){var o="";"hideSelected"===t?o=(0,l.KFw)(n,"column"):"showHide"===t&&(0,l.Sm_)(n,"column"),"noMulti"===o&&e(p.noMulti),n.contextMenu={}})}},v[t]+v.column)});if("set-row-height"===t){var u,d,h,k,E,C=(null==i?void 0:i.height)||a.defaultrowlen,b=(null===(k=a.luckysheet_select_save)||void 0===k?void 0:k.some(function(e){return e.height_move!==(C+1)*(e.row[1]-e.row[0]+1)-1}))?"":C;return(null===(E=a.luckysheet_select_save)||void 0===E?void 0:E.some(function(e){return e.row_select}))?o.createElement(ek,{key:"set-row-height",onClick:function(e,t){var n,o=null===(n=t.querySelector("input"))||void 0===n?void 0:n.value;r(function(e){if(c().isUndefined(o)||""===o||0>=parseInt(o,10)||parseInt(o,10)>545){m(g.tipRowHeightLimit,"ok"),e.contextMenu={};return}var t=parseInt(o,10),n={};c().forEach(e.luckysheet_select_save,function(e){for(var l=e.row[0];l<=e.row[1];l+=1)n[l]=t}),l.hi0.setRowHeight(e,n,{},!0),e.contextMenu={}})}},v.row,v.height,o.createElement("input",{onClick:function(e){return e.stopPropagation()},onKeyDown:function(e){return e.stopPropagation()},type:"number",min:1,max:545,className:"luckysheet-mousedown-cancel",placeholder:v.number,defaultValue:b,style:{width:"40px"}}),"px"):null}if("set-column-width"===t){var x,w,N=(null==i?void 0:i.width)||a.defaultcollen,_=(null===(x=a.luckysheet_select_save)||void 0===x?void 0:x.some(function(e){return e.width_move!==(N+1)*(e.column[1]-e.column[0]+1)-1}))?"":N;return(null===(w=a.luckysheet_select_save)||void 0===w?void 0:w.some(function(e){return e.column_select}))?o.createElement(ek,{key:"set-column-width",onClick:function(e,t){var n,o=null===(n=t.querySelector("input"))||void 0===n?void 0:n.value;r(function(e){if(c().isUndefined(o)||""===o||0>=parseInt(o,10)||parseInt(o,10)>2038){m(g.tipColumnWidthLimit,"ok"),e.contextMenu={};return}var t=parseInt(o,10),n={};c().forEach(e.luckysheet_select_save,function(e){for(var l=e.column[0];l<=e.column[1];l+=1)n[l]=t}),l.hi0.setColumnWidth(e,n,{},!0),e.contextMenu={}})}},v.column,v.width,o.createElement("input",{onClick:function(e){return e.stopPropagation()},onKeyDown:function(e){return e.stopPropagation()},type:"number",min:1,max:545,className:"luckysheet-mousedown-cancel",placeholder:v.number,defaultValue:_,style:{width:"40px"}}),"px"):null}return"clear"===t?o.createElement(ek,{key:t,onClick:function(){r(function(t){if((0,l.RhZ)(t)){if(null!=t.activeImg)(0,l.axT)(t);else{var n=(0,l.yoD)(t);"partMC"===n?e(y.partiallyError,"ok"):"allowEdit"===n?e(y.readOnlyError,"ok"):"dataNullError"===n&&e(y.dataNullError,"ok")}t.contextMenu={},(0,l.PPY)(t,null,void 0)}})}},v.clearContent):"orderAZ"===t?o.createElement(ek,{key:t,onClick:function(){r(function(e){(0,l.rsr)(e,!0),e.contextMenu={}})}},v.orderAZ):"orderZA"===t?o.createElement(ek,{key:t,onClick:function(){r(function(e){(0,l.rsr)(e,!1),e.contextMenu={}})}},v.orderZA):"sort"===t?o.createElement(ek,{key:t,onClick:function(){r(function(t){e(o.createElement(eg,null)),t.contextMenu={}})}},v.sortSelection):"filter"===t?o.createElement(ek,{key:t,onClick:function(){r(function(e){(0,l.cjq)(e),e.contextMenu={}})}},v.filterSelection):"image"===t?o.createElement(ek,{key:t,onClick:function(){r(function(e){(0,l.bK$)(),e.contextMenu={}})}},v.image):"link"===t?o.createElement(ek,{key:t,onClick:function(){r(function(e){(0,l.UFm)(e),e.contextMenu={}})}},v.link):null},[a.currentSheetId,a.lang,a.luckysheet_select_save,a.defaultrowlen,a.defaultcollen,v,g,r,m,e,p,y]);return((0,o.useLayoutEffect)(function(){if(t.current){var e,n=window.innerHeight,l=window.innerWidth,o=t.current.getBoundingClientRect(),a=null===(e=u.workbookContainer.current)||void 0===e?void 0:e.getBoundingClientRect();if(a){var c=o.width,i=o.height,s=d.y||0,m=d.x||0,f=!1;a.left+m+c>l&&(m-=c,f=!0),a.top+s+i>n&&(s-=i,f=!0),s<0&&(s=0,f=!0),f&&r(function(e){e.contextMenu.x=m,e.contextMenu.y=s})}}},[d.x,d.y,r]),c().isEmpty(a.contextMenu))?null:o.createElement("div",{className:"fortune-context-menu luckysheet-cols-menu",ref:t,onContextMenu:function(e){return e.stopPropagation()},style:{left:d.x,top:d.y}},!0===a.contextMenu.headerMenu?i.headerContextMenu.map(function(e,t){return E(e,t)}):i.cellContextMenu.map(function(e,t){return E(e,t)}))},eC=function(){return o.createElement("svg",{style:{position:"absolute",width:0,height:0},xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink"},o.createElement("defs",null,o.createElement("symbol",{viewBox:"0 0 24 24",fill:"none",id:"add"},o.createElement("rect",{x:"4.75",y:"4.75",width:"14.5",height:"14.5",rx:"0.75",stroke:"#424A59",strokeOpacity:"0.9",strokeWidth:"1.5"}),o.createElement("rect",{x:"11.25",y:"8.5",width:"1.5",height:"7",fill:"#535B68"}),o.createElement("rect",{x:"15.5",y:"11.25",width:"1.5",height:"7",transform:"rotate(90 15.5 11.25)",fill:"#535B68"})),o.createElement("symbol",{viewBox:"0 0 24 24",fill:"none",id:"align-bottom"},o.createElement("path",{d:"M9.25 12.5L12.0002 15.5L14.75 12.5H9.25Z",fill:"#525C6F"}),o.createElement("rect",{x:"5.5",y:"16.5",width:"13",height:"1.5",fill:"#525C6F"}),o.createElement("rect",{x:"11.25",y:"5.5",width:"1.5",height:"7.5",fill:"#525C6F"})),o.createElement("symbol",{viewBox:"0 0 24 24",fill:"none",id:"align-center"},o.createElement("path",{d:"M5 6.75H19",stroke:"#525C6F",strokeWidth:"1.5"}),o.createElement("path",{d:"M8 12H16",stroke:"#525C6F",strokeWidth:"1.5"}),o.createElement("path",{d:"M5 17.25L19 17.25",stroke:"#525C6F",strokeWidth:"1.5"})),o.createElement("symbol",{viewBox:"0 0 24 24",fill:"none",id:"align-justify"},o.createElement("path",{d:"M19.5 6.5H4.5",stroke:"#525C6F",strokeWidth:"1.5",strokeLinejoin:"round"}),o.createElement("path",{d:"M19.5 12L4.5 12",stroke:"#525C6F",strokeWidth:"1.5",strokeLinejoin:"round"}),o.createElement("path",{d:"M19.5 17.5H4.5",stroke:"#525C6F",strokeWidth:"1.5",strokeLinejoin:"round"})),o.createElement("symbol",{viewBox:"0 0 24 24",fill:"none",id:"align-left"},o.createElement("path",{d:"M5 6.75H19",stroke:"#525C6F",strokeWidth:"1.5"}),o.createElement("path",{d:"M5 12H13",stroke:"#525C6F",strokeWidth:"1.5"}),o.createElement("path",{d:"M5 17.25L19 17.25",stroke:"#525C6F",strokeWidth:"1.5"})),o.createElement("symbol",{viewBox:"0 0 24 24",fill:"none",id:"align-middle"},o.createElement("path",{d:"M9.25 16.5L12.0002 13.5L14.75 16.5H9.25Z",fill:"#525C6F"}),o.createElement("path",{d:"M9.25 7L12.0002 10L14.75 7L9.25 7Z",fill:"#525C6F"}),o.createElement("rect",{x:"5.5",y:"11",width:"13",height:"1.5",fill:"#525C6F"}),o.createElement("rect",{x:"11.25",y:"16",width:"1.5",height:"3.5",fill:"#525C6F"}),o.createElement("rect",{x:"11.25",y:"4",width:"1.5",height:"3.5",fill:"#525C6F"})),o.createElement("symbol",{viewBox:"0 0 24 24",fill:"none",id:"align-right"},o.createElement("path",{d:"M5 6.75H19",stroke:"#525C6F",strokeWidth:"1.5"}),o.createElement("path",{d:"M11 12H19",stroke:"#525C6F",strokeWidth:"1.5"}),o.createElement("path",{d:"M5 17.25L19 17.25",stroke:"#525C6F",strokeWidth:"1.5"})),o.createElement("symbol",{viewBox:"0 0 24 24",fill:"none",id:"align-top"},o.createElement("path",{d:"M9.25 11L12.0002 8L14.75 11H9.25Z",fill:"#525C6F"}),o.createElement("rect",{x:"5.5",y:"5.5",width:"13",height:"1.5",fill:"#525C6F"}),o.createElement("rect",{x:"11.25",y:"10.5",width:"1.5",height:"7.5",fill:"#525C6F"})),o.createElement("symbol",{viewBox:"0 0 24 24",fill:"none",id:"bold"},o.createElement("path",{d:"M6.30566 5.07617V18.9992H12.4872C13.9107 18.9992 15.0417 18.7067 15.8607 18.1607C16.8162 17.4977 17.3037 16.4837 17.3037 15.1187C17.3037 14.1827 17.0307 13.4417 16.5237 12.8567C16.0167 12.2717 15.3147 11.8817 14.3982 11.7257C15.1002 11.4917 15.6657 11.1212 16.0947 10.6142C16.5042 10.0487 16.7187 9.36617 16.7187 8.58617C16.7187 7.49417 16.3482 6.63617 15.6072 6.01217C14.8467 5.38817 13.8132 5.07617 12.5262 5.07617H6.30566ZM7.90466 6.42167H12.1557C13.1307 6.42167 13.8717 6.59717 14.3787 6.98717C14.8857 7.37717 15.1392 7.96217 15.1392 8.74217C15.1392 9.54167 14.8662 10.1462 14.3592 10.5557C13.8522 10.9457 13.1112 11.1602 12.1362 11.1602H7.90466V6.42167ZM7.90466 12.4862H12.3507C13.4232 12.4862 14.2422 12.6812 14.8077 13.1102C15.3927 13.5392 15.7047 14.2022 15.7047 15.0992C15.7047 15.9962 15.3537 16.6787 14.6712 17.1077C14.0862 17.4587 13.3257 17.6537 12.3507 17.6537H7.90466V12.4862Z",fill:"#394259"})),o.createElement("symbol",{viewBox:"0 0 24 24",fill:"none",id:"border"},o.createElement("rect",{x:"5.75",y:"5.75",width:"12.5",height:"12.5",stroke:"#535A68",strokeWidth:"1.5"}),o.createElement("line",{x1:"6.5",y1:"12",x2:"17.5",y2:"12",stroke:"#CCCED2",strokeWidth:"1.5"}),o.createElement("line",{x1:"12",y1:"17.5",x2:"12",y2:"6.5",stroke:"#CCCED2",strokeWidth:"1.5"})),o.createElement("symbol",{viewBox:"0 0 24 24",fill:"none",id:"border-all"},o.createElement("rect",{x:"5.75",y:"5.75",width:"12.5",height:"12.5",stroke:"#535A68",strokeWidth:"1.5"}),o.createElement("line",{x1:"6.5",y1:"12",x2:"17.5",y2:"12",stroke:"#535A68",strokeWidth:"1.5"}),o.createElement("line",{x1:"12",y1:"17.5",x2:"12",y2:"6.5",stroke:"#535A68",strokeWidth:"1.5"})),o.createElement("symbol",{viewBox:"0 0 24 24",fill:"none",id:"border-bottom"},o.createElement("rect",{x:"5.75",y:"5.75",width:"12.5",height:"12.5",stroke:"#CCCED2",strokeWidth:"1.5"}),o.createElement("line",{x1:"6.5",y1:"12",x2:"17.5",y2:"12",stroke:"#CCCED2",strokeWidth:"1.5"}),o.createElement("line",{x1:"12",y1:"17.5",x2:"12",y2:"6.5",stroke:"#CCCED2",strokeWidth:"1.5"}),o.createElement("line",{x1:"5",y1:"18.25",x2:"19",y2:"18.25",stroke:"#535A68",strokeWidth:"1.5"})),o.createElement("symbol",{viewBox:"0 0 24 24",fill:"none",id:"border-color"},o.createElement("path",{d:"M16 10.9106L18.9511 13.8617L14.5431 18.2697H11.592V15.3186L16 10.9106Z",stroke:"#535A68",strokeWidth:"1.5"}),o.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M6.5 6.5H17.5V9.84613H19V6.5V5H17.5H6.5H5V6.5V17.5V19H6.5H9.84616V17.5H6.5V6.5Z",fill:"#535A68"})),o.createElement("symbol",{viewBox:"0 0 24 24",fill:"none",id:"border-horizontal"},o.createElement("rect",{x:"5.75",y:"5.75",width:"12.5",height:"12.5",stroke:"#CCCED2",strokeWidth:"1.5"}),o.createElement("line",{x1:"12",y1:"17.5",x2:"12",y2:"6.5",stroke:"#CCCED2",strokeWidth:"1.5"}),o.createElement("line",{x1:"5",y1:"18.25",x2:"19",y2:"18.25",stroke:"#CCCED2",strokeWidth:"1.5"}),o.createElement("line",{x1:"6.5",y1:"12",x2:"17.5",y2:"12",stroke:"#535A68",strokeWidth:"1.5"})),o.createElement("symbol",{viewBox:"0 0 24 24",fill:"none",id:"border_diagonal_down"},o.createElement("line",{x1:"17.9697",y1:"18.0303",x2:"5.96967",y2:"6.03033",stroke:"#535A68",strokeWidth:"1.5"}),o.createElement("rect",{x:"5.75",y:"5.75",width:"12.5",height:"12.5",stroke:"#CCCED2",strokeWidth:"1.5"})),o.createElement("symbol",{viewBox:"0 0 24 24",fill:"none",id:"border_diagonal_up"},o.createElement("line",{y1:"-0.75",x2:"16.9706",y2:"-0.75",transform:"matrix(0.707107 -0.707107 -0.707107 -0.707107 5.5 17.5)",stroke:"#535A68",strokeWidth:"1.5"}),o.createElement("rect",{x:"5.75",y:"5.75",width:"12.5",height:"12.5",stroke:"#CCCED2",strokeWidth:"1.5"})),o.createElement("symbol",{viewBox:"0 0 24 24",fill:"none",id:"border-inside"},o.createElement("rect",{x:"5.75",y:"5.75",width:"12.5",height:"12.5",stroke:"#CCCED2",strokeWidth:"1.5"}),o.createElement("line",{x1:"6.5",y1:"12",x2:"17.5",y2:"12",stroke:"#535A68",strokeWidth:"1.5"}),o.createElement("line",{x1:"12",y1:"17.5",x2:"12",y2:"6.5",stroke:"#535A68",strokeWidth:"1.5"})),o.createElement("symbol",{viewBox:"0 0 24 24",fill:"none",id:"border-left"},o.createElement("line",{x1:"6.5",y1:"12",x2:"17.5",y2:"12",stroke:"#CCCED2",strokeWidth:"1.5"}),o.createElement("line",{x1:"12",y1:"17.5",x2:"12",y2:"6.5",stroke:"#CCCED2",strokeWidth:"1.5"}),o.createElement("rect",{x:"5.75",y:"5.75",width:"12.5",height:"12.5",stroke:"#CCCED2",strokeWidth:"1.5"}),o.createElement("line",{x1:"5.75",y1:"19",x2:"5.75",y2:"5",stroke:"#535A68",strokeWidth:"1.5"})),o.createElement("symbol",{viewBox:"0 0 24 24",fill:"none",id:"border-none"},o.createElement("rect",{x:"5.75",y:"5.75",width:"12.5",height:"12.5",stroke:"#CCCED2",strokeWidth:"1.5"}),o.createElement("line",{x1:"6.5",y1:"12",x2:"17.5",y2:"12",stroke:"#CCCED2",strokeWidth:"1.5"}),o.createElement("line",{x1:"12",y1:"17.5",x2:"12",y2:"6.5",stroke:"#CCCED2",strokeWidth:"1.5"})),o.createElement("symbol",{viewBox:"0 0 24 24",fill:"none",id:"border-outside"},o.createElement("rect",{x:"5.75",y:"5.75",width:"12.5",height:"12.5",stroke:"#535A68",strokeWidth:"1.5"}),o.createElement("line",{x1:"6.5",y1:"12",x2:"17.5",y2:"12",stroke:"#CCCED2",strokeWidth:"1.5"}),o.createElement("line",{x1:"12",y1:"17.5",x2:"12",y2:"6.5",stroke:"#CCCED2",strokeWidth:"1.5"})),o.createElement("symbol",{viewBox:"0 0 24 24",fill:"none",id:"border-right"},o.createElement("line",{x1:"6.5",y1:"12",x2:"17.5",y2:"12",stroke:"#CCCED2",strokeWidth:"1.5"}),o.createElement("line",{x1:"12",y1:"17.5",x2:"12",y2:"6.5",stroke:"#CCCED2",strokeWidth:"1.5"}),o.createElement("rect",{x:"5.75",y:"5.75",width:"12.5",height:"12.5",stroke:"#CCCED2",strokeWidth:"1.5"}),o.createElement("line",{x1:"18.25",y1:"19",x2:"18.25",y2:"5",stroke:"#535A68",strokeWidth:"1.5"})),o.createElement("symbol",{viewBox:"0 0 24 24",fill:"none",id:"border-vertical"},o.createElement("line",{x1:"6.5",y1:"12",x2:"17.5",y2:"12",stroke:"#CCCED2",strokeWidth:"1.5"}),o.createElement("line",{x1:"12",y1:"17.5",x2:"12",y2:"6.5",stroke:"#535A68",strokeWidth:"1.5"}),o.createElement("rect",{x:"5.75",y:"5.75",width:"12.5",height:"12.5",stroke:"#CCCED2",strokeWidth:"1.5"}),o.createElement("line",{x1:"18.25",y1:"19",x2:"18.25",y2:"5",stroke:"#CCCED2",strokeWidth:"1.5"})),o.createElement("symbol",{viewBox:"0 0 24 24",fill:"none",id:"border-slash"},o.createElement("line",{x1:"5.75",y1:"5.75",x2:"17.95",y2:"17.95",stroke:"#535A68",strokeWidth:"1.5"}),o.createElement("rect",{x:"5.75",y:"5.75",width:"12.5",height:"12.5",stroke:"#CCCED2",strokeWidth:"1.5"})),o.createElement("symbol",{viewBox:"0 0 24 24",fill:"none",id:"border-style"},o.createElement("line",{x1:"5",y1:"5.75",x2:"19",y2:"5.75",stroke:"#535A68",strokeWidth:"1.5"}),o.createElement("line",{x1:"5",y1:"12.25",x2:"7.5",y2:"12.25",stroke:"#535A68",strokeWidth:"1.5"}),o.createElement("line",{x1:"8.8252",y1:"12.25",x2:"11.3252",y2:"12.25",stroke:"#535A68",strokeWidth:"1.5"}),o.createElement("line",{x1:"12.6504",y1:"12.25",x2:"15.1504",y2:"12.25",stroke:"#535A68",strokeWidth:"1.5"}),o.createElement("line",{x1:"16.4746",y1:"12.25",x2:"18.9746",y2:"12.25",stroke:"#535A68",strokeWidth:"1.5"}),o.createElement("line",{x1:"5",y1:"18.25",x2:"6.5",y2:"18.25",stroke:"#535A68",strokeWidth:"1.5"}),o.createElement("line",{x1:"7.08008",y1:"18.25",x2:"8.58008",y2:"18.25",stroke:"#535A68",strokeWidth:"1.5"}),o.createElement("line",{x1:"9.16016",y1:"18.25",x2:"10.6602",y2:"18.25",stroke:"#535A68",strokeWidth:"1.5"}),o.createElement("line",{x1:"11.2402",y1:"18.25",x2:"12.7402",y2:"18.25",stroke:"#535A68",strokeWidth:"1.5"}),o.createElement("line",{x1:"13.3203",y1:"18.25",x2:"14.8203",y2:"18.25",stroke:"#535A68",strokeWidth:"1.5"}),o.createElement("line",{x1:"15.4004",y1:"18.25",x2:"16.9004",y2:"18.25",stroke:"#535A68",strokeWidth:"1.5"}),o.createElement("line",{x1:"17.4805",y1:"18.25",x2:"18.9805",y2:"18.25",stroke:"#535A68",strokeWidth:"1.5"})),o.createElement("symbol",{viewBox:"0 0 24 24",fill:"none",id:"border-top"},o.createElement("rect",{x:"5.75",y:"5.75",width:"12.5",height:"12.5",stroke:"#CCCED2",strokeWidth:"1.5"}),o.createElement("line",{x1:"6.5",y1:"12",x2:"17.5",y2:"12",stroke:"#CCCED2",strokeWidth:"1.5"}),o.createElement("line",{x1:"12",y1:"17.5",x2:"12",y2:"6.5",stroke:"#CCCED2",strokeWidth:"1.5"}),o.createElement("line",{x1:"5",y1:"5.75",x2:"19",y2:"5.75",stroke:"#535A68",strokeWidth:"1.5"})),o.createElement("symbol",{viewBox:"0 0 18 18",fill:"none",id:"close"},o.createElement("path",{d:"M13.9255 5L5.00091 13.9246",stroke:"#262A33",strokeOpacity:"0.9",strokeWidth:"1.5",strokeLinecap:"round"}),o.createElement("path",{d:"M13.9255 13.9238L5.00091 4.9992",stroke:"#262A33",strokeOpacity:"0.9",strokeWidth:"1.5",strokeLinecap:"round"})),o.createElement("symbol",{viewBox:"0 0 10 24",fill:"none",id:"combo-arrow"},o.createElement("path",{d:"M8 10H2L5 14L8 10Z",fill:"#A6A6A6"})),o.createElement("symbol",{fill:"none",viewBox:"0 0 24 24",id:"comment"},o.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9.968 15.7L12 17.956l2.032-2.258H18.5v-10h-13v10h4.468zm1.289 3.673L9.3 17.2H5.5A1.5 1.5 0 014 15.7v-10a1.5 1.5 0 011.5-1.5h13A1.5 1.5 0 0120 5.7v10a1.5 1.5 0 01-1.5 1.5h-3.8l-1.957 2.174a1 1 0 01-1.486 0z",fill:"#525C6F"}),o.createElement("path",{d:"M7 8.2h10v1.5H7V8.2zM7 11.699h6v1.5H7z",fill:"#525C6F"})),o.createElement("symbol",{viewBox:"0 0 24 24",fill:"none",id:"strike-through"},o.createElement("rect",{x:"6",y:"11.5",width:"13",height:"1.5",fill:"#394259"}),o.createElement("path",{d:"M9.00344 11.5C9.69342 11.9717 10.6431 12.3814 11.8525 12.729C13.071 13.0815 13.9121 13.4403 14.376 13.8052C14.8398 14.1639 15.0718 14.6742 15.0718 15.3359C15.0718 15.9977 14.8213 16.5203 14.3203 16.9038C13.8193 17.2873 13.0988 17.479 12.1587 17.479C11.1506 17.479 10.3434 17.244 9.7373 16.7739C9.13737 16.2977 8.8374 15.6514 8.8374 14.835H7.04688C7.04688 15.6204 7.26335 16.3224 7.69629 16.9409C8.13542 17.5594 8.757 18.048 9.56104 18.4067C10.3651 18.7593 11.231 18.9355 12.1587 18.9355C13.5874 18.9355 14.7285 18.6077 15.582 17.9521C16.4355 17.2904 16.8623 16.4121 16.8623 15.3174C16.8623 14.6309 16.7077 14.034 16.3984 13.5269C16.0954 13.0197 15.6253 12.5775 14.9883 12.2002C14.581 11.9526 14.0705 11.7192 13.457 11.5H9.00344Z",fill:"#394259"}),o.createElement("path",{d:"M7.71685 10C7.5547 9.61466 7.47363 9.19458 7.47363 8.73975C7.47363 7.67594 7.8973 6.79769 8.74463 6.10498C9.59814 5.40609 10.7052 5.05664 12.0659 5.05664C12.9937 5.05664 13.8193 5.236 14.543 5.59473C15.2728 5.95345 15.8356 6.44824 16.2314 7.0791C16.6335 7.70996 16.8345 8.39958 16.8345 9.14795H15.0439C15.0439 8.33154 14.7842 7.69141 14.2646 7.22754C13.7451 6.75749 13.0122 6.52246 12.0659 6.52246C11.1877 6.52246 10.5011 6.71729 10.0063 7.10693C9.51774 7.4904 9.27344 8.02539 9.27344 8.71191C9.27344 9.2095 9.46296 9.63887 9.84201 10H7.71685Z",fill:"#394259"})),o.createElement("symbol",{viewBox:"0 0 24 24",fill:"none",id:"clear-format"},o.createElement("line",{x1:"8",y1:"18.25",x2:"20",y2:"18.25",stroke:"#525C6F",strokeWidth:"1.5"}),o.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M14 7.12132L17.8787 11L10 18.8787L6.12132 15L14 7.12132ZM14 5L15.0607 6.06066L18.9393 9.93934L20 11L18.9393 12.0607L12 19L8 19L5.06066 16.0607L4 15L5.06066 13.9393L12.9393 6.06066L14 5Z",fill:"#525C6F"}),o.createElement("rect",{x:"13.9375",y:"6.12316",width:"6.98528",height:"5.7265",transform:"rotate(45 13.9375 6.12316)",stroke:"#525C6F",strokeWidth:"1.5"})),o.createElement("symbol",{viewBox:"0 0 24 24",fill:"none",id:"image"},o.createElement("circle",{cx:"8.75",cy:"8.75",r:"1.25",fill:"#525C6F"}),o.createElement("rect",{x:"4.75",y:"5.25",width:"14.5",height:"13.5",rx:"0.75",stroke:"#525C6F",strokeWidth:"1.5"}),o.createElement("path",{d:"M7 19L12.984 11.8949C13.1659 11.6789 13.4905 11.6563 13.7006 11.845L19.5 17.0556",stroke:"#525C6F",strokeWidth:"1.5",strokeLinejoin:"round"})),o.createElement("symbol",{viewBox:"0 0 24 24",fill:"none",id:"italic"},o.createElement("path",{d:"M11 5H16V6.5H11V5Z",fill:"#394259"}),o.createElement("path",{d:"M9 17.5H14V19H9V17.5Z",fill:"#394259"}),o.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M10.7598 17.877L12.7598 5.87695L14.2394 6.12355L12.2394 18.1236L10.7598 17.877Z",fill:"#394259"})),o.createElement("symbol",{viewBox:"0 0 24 24",fill:"none",id:"merge-cancel"},o.createElement("path",{d:"M13 14.9998L16.5 11.9996L13 8.99982V14.9998Z",fill:"#525C6F"}),o.createElement("path",{d:"M11 14.9998L7.5 11.9996L11 8.99982L11 14.9998Z",fill:"#525C6F"}),o.createElement("rect",{x:"10",y:"11.2498",width:"4.5",height:"1.5",fill:"#525C6F"}),o.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9.5 6.49982H6.5L6.5 17.4998H9.5V15.4999H11V17.4998V18.9998H9.5H6.5H5V17.4998L5 6.49982V4.99982H6.5H9.5L11 4.99982V6.49982V8.49988H9.5V6.49982ZM13 15.4999V15.9998V17.4998V18.9998H14.5H17.5H19V17.4998V6.49982V4.99982H17.5H14.5H13V6.49982V7.99982V8.49988H14.5V7.99982V6.49982H17.5V17.4998H14.5L14.5 15.9998V15.4999H13Z",fill:"#525C6F"})),o.createElement("symbol",{viewBox:"0 0 24 24",fill:"none",id:"merge-horizontal"},o.createElement("path",{d:"M11 15L14.5 11.9998L11 9V15Z",fill:"#525C6F"}),o.createElement("rect",{x:"5",y:"11.25",width:"8.5",height:"1.5",fill:"#525C6F"}),o.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M6.5 6.5H7.5H9.5H11V5H9.5H6.5H5V6.5V17.5V19H6.5H9.5H11V17.5H9.5H7.5H6.5V6.5ZM13 16V15.5H14.5V16V17.5H17.5V6.5H14.5V8V8.5H13V8V6.5V5H14.5H17.5H19V6.5V17.5V19H17.5H14.5H13V17.5V16Z",fill:"#525C6F"})),o.createElement("symbol",{viewBox:"0 0 24 24",fill:"none",id:"merge-vertical"},o.createElement("path",{d:"M9 10.9998L12.0002 14.4998L15 10.9998L9 10.9998Z",fill:"#525C6F"}),o.createElement("rect",{x:"12.75",y:"4.99982",width:"8.5",height:"1.5",transform:"rotate(90 12.75 4.99982)",fill:"#525C6F"}),o.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M17.5 6.49982L17.5 7L17.5 10.9998H19V9.49982V6.49982V4.99982H17.5L6.5 4.99982H5V6.49982L5 9.49982V10.9998H6.5V9.49982L6.5 7L6.5 6.49982L17.5 6.49982ZM8 12.9998L8.5 12.9998V14.4998H8H6.5V17.4998H17.5V14.4998H16H15.5V12.9998H16H17.5H19L19 14.4998V17.4998V18.9998H17.5H6.5L5 18.9998L5 17.4998V14.4998V12.9998H6.5H8Z",fill:"#525C6F"})),o.createElement("symbol",{viewBox:"0 0 24 24",fill:"none",id:"merge-all"},o.createElement("path",{d:"M15.5 14.9998L12 11.9996L15.5 8.99982V14.9998Z",fill:"#525C6F"}),o.createElement("path",{d:"M8.5 14.9998L12 11.9996L8.5 8.99982L8.5 14.9998Z",fill:"#525C6F"}),o.createElement("rect",{x:"7",y:"11.2498",width:"2.5",height:"1.5",fill:"#525C6F"}),o.createElement("rect",{x:"14.5",y:"11.2498",width:"2.5",height:"1.5",fill:"#525C6F"}),o.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9.5 6.49982H6.5L6.5 17.4998H9.5V15.4999H11V17.4998V18.9998H9.5H6.5H5V17.4998L5 6.49982V4.99982H6.5H9.5L11 4.99982V6.49982V8.49988H9.5V6.49982ZM13 15.4999V15.9998V17.4998V18.9998H14.5H17.5H19V17.4998V6.49982V4.99982H17.5H14.5H13V6.49982V7.99982V8.49988H14.5V7.99982V6.49982H17.5V17.4998H14.5L14.5 15.9998V15.4999H13Z",fill:"#525C6F"})),o.createElement("symbol",{fill:"none",viewBox:"0 0 16 16",id:"plus"},o.createElement("path",{d:"M8 1.715v12.571M1.714 8h12.572",stroke:"#666",strokeWidth:"1.714"})),o.createElement("symbol",{viewBox:"0 0 1024 1024",version:"1.1","p-id":"4116",id:"minus"},o.createElement("path",{d:"M801.895 542.105h-579.79C205.479 542.105 192 528.627 192 512c0-16.627 13.479-30.105 30.105-30.105h579.789C818.521 481.895 832 495.373 832 512c0 16.627-13.479 30.105-30.105 30.105z","p-id":"4117"})),o.createElement("symbol",{viewBox:"-100 -100 1224 1224",fill:"#525C6F",id:"background"},o.createElement("path",{d:"M766.4 744.3c43.7 0 79.4-36.2 79.4-80.5 0-53.5-79.4-140.8-79.4-140.8S687 610.3 687 663.8c0 44.3 35.7 80.5 79.4 80.5zM389.3 700.2c7.1 7.1 18.6 7.1 25.6 0l256.1-256c7.1-7.1 7.1-18.6 0-25.6l-256-256c-0.6-0.6-1.3-1.2-2-1.7l-78.2-78.2c-3.5-3.5-9.3-3.5-12.8 0l-48 48c-3.5 3.5-3.5 9.3 0 12.8l67.2 67.2-207.8 207.9c-7.1 7.1-7.1 18.6 0 25.6l255.9 256z m12.9-448.6l178.9 178.9H223.4l178.8-178.9zM904 816H120c-4.4 0-8 3.6-8 8v80c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-80c0-4.4-3.6-8-8-8z"})),o.createElement("symbol",{viewBox:"-100 -100 1224 1224",fill:"#525C6F",id:"font-color"},o.createElement("path",{d:"M904 816H120c-4.4 0-8 3.6-8 8v80c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-80c0-4.4-3.6-8-8-8zM253.7 736h85c4.2 0 8-2.7 9.3-6.8l53.7-166h219.2l53.2 166c1.3 4 5 6.8 9.3 6.8h89.1c1.1 0 2.2-0.2 3.2-0.5 5.1-1.8 7.8-7.3 6-12.4L573.6 118.6c-1.4-3.9-5.1-6.6-9.2-6.6H462.1c-4.2 0-7.9 2.6-9.2 6.6L244.5 723.1c-0.4 1-0.5 2.1-0.5 3.2-0.1 5.3 4.3 9.7 9.7 9.7z m255.9-516.1h4.1l83.8 263.8H424.9l84.7-263.8z"})),o.createElement("symbol",{viewBox:"0 0 24 24",fill:"none",id:"text-overflow"},o.createElement("path",{d:"M16.5 15L20 11.9998L16.5 9V15Z",fill:"#525C6F"}),o.createElement("rect",{x:"7",y:"11.25",width:"9.5",height:"1.5",fill:"#525C6F"}),o.createElement("line",{x1:"4.75",y1:"5",x2:"4.75",y2:"19",stroke:"#525C6F",strokeWidth:"1.5"}),o.createElement("line",{x1:"12.25",y1:"5",x2:"12.25",y2:"9.5",stroke:"#525C6F",strokeWidth:"1.5"}),o.createElement("line",{x1:"12.25",y1:"14.5",x2:"12.25",y2:"19",stroke:"#525C6F",strokeWidth:"1.5"})),o.createElement("symbol",{viewBox:"0 0 24 24",fill:"none",id:"text-wrap"},o.createElement("line",{x1:"4.75",y1:"5",x2:"4.75",y2:"19",stroke:"#525C6F",strokeWidth:"1.5"}),o.createElement("line",{x1:"19.25",y1:"5",x2:"19.25",y2:"19",stroke:"#525C6F",strokeWidth:"1.5"}),o.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M7.00001 16.2502L9.99 13.5V15.5H12.0005C13.9335 15.5 15.5005 13.933 15.5005 12C15.5005 10.067 13.9335 8.5 12.0005 8.5H7V7H12.0005C14.7619 7 17.0005 9.23857 17.0005 12C17.0005 14.7614 14.7619 17 12.0005 17H9.99V19L7.00001 16.2502Z",fill:"#525C6F"})),o.createElement("symbol",{viewBox:"0 0 24 24",fill:"none",id:"underline"},o.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M17 19H7V17.5H17V19Z",fill:"#394259"}),o.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9.25 5V12.25C9.25 13.7688 10.4812 15 12 15C13.5188 15 14.75 13.7688 14.75 12.25V5H16.25V12.25C16.25 14.5972 14.3472 16.5 12 16.5C9.65278 16.5 7.75 14.5972 7.75 12.25V5H9.25Z",fill:"#394259"})),o.createElement("symbol",{viewBox:"0 0 24 24",fill:"none",id:"undo"},o.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M3.5 7.75001L7.2019 10.835V8.5H13.25C15.4591 8.5 17.25 10.2909 17.25 12.5C17.25 14.7091 15.4591 16.5 13.25 16.5H7V18H13.25C16.2876 18 18.75 15.5376 18.75 12.5C18.75 9.46244 16.2876 7 13.25 7H7.2019V4.66547L3.5 7.75001Z",fill:"#525C6F"})),o.createElement("symbol",{viewBox:"0 0 24 24",fill:"none",id:"redo"},o.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M20.5 7.75001L16.7981 10.835V8.5H10.75C8.54086 8.5 6.75 10.2909 6.75 12.5C6.75 14.7091 8.54086 16.5 10.75 16.5H17V18H10.75C7.71243 18 5.25 15.5376 5.25 12.5C5.25 9.46244 7.71243 7 10.75 7H16.7981V4.66547L20.5 7.75001Z",fill:"#525C6F"})),o.createElement("symbol",{viewBox:"0 0 1024 1024",id:"fx"},o.createElement("path",{d:"M841 370c3-3.3 2.7-8.3-0.6-11.3-1.5-1.3-3.4-2.1-5.3-2.1h-72.6c-2.4 0-4.6 1-6.1 2.8L633.5 504.6c-2.9 3.4-7.9 3.8-11.3 0.9-0.9-0.8-1.6-1.7-2.1-2.8l-63.5-141.3c-1.3-2.9-4.1-4.7-7.3-4.7H380.7l0.9-4.7 8-42.3c10.5-55.4 38-81.4 85.8-81.4 18.6 0 35.5 1.7 48.8 4.7l14.1-66.8c-22.6-4.7-35.2-6.1-54.9-6.1-103.3 0-156.4 44.3-175.9 147.3l-9.4 49.4h-97.6c-3.8 0-7.1 2.7-7.8 6.4L181.9 415c-0.9 4.3 1.9 8.6 6.2 9.5 0.5 0.1 1.1 0.2 1.6 0.2H284l-89 429.9c-0.9 4.3 1.9 8.6 6.2 9.5 0.5 0.1 1.1 0.2 1.6 0.2H269c3.8 0 7.1-2.7 7.8-6.4l89.7-433.1h135.8l68.2 139.1c1.4 2.9 1 6.4-1.2 8.8l-180.6 203c-2.9 3.3-2.6 8.4 0.7 11.3 1.5 1.3 3.4 2 5.3 2h72.7c2.4 0 4.6-1 6.1-2.8l123.7-146.7c2.8-3.4 7.9-3.8 11.3-1 0.9 0.8 1.6 1.7 2.1 2.8L676.4 784c1.3 2.8 4.1 4.7 7.3 4.7h64.6c4.4 0 8-3.6 8-8 0-1.2-0.3-2.4-0.8-3.5l-95.2-198.9c-1.4-2.9-0.9-6.4 1.3-8.8L841 370z"})),o.createElement("symbol",{viewBox:"0 0 1024 1024",id:"currency-format"},o.createElement("path",{fill:"#525C6F",d:"M675.861333 192l45.610667 44.906667-166.997333 169.6h237.525333v64H544v144.597333h248v64H544v176.597333h-64v-176.597333H232v-64H480v-144.597333H232v-64h237.482667l-166.954667-169.6L348.138667 192 512 358.464 675.861333 192z","p-id":"5490"})),o.createElement("symbol",{viewBox:"0 0 1024 1024",id:"percentage-format"},o.createElement("path",{fill:"#525C6F",d:"M855.7 210.8l-42.4-42.4c-3.1-3.1-8.2-3.1-11.3 0L168.3 801.9c-3.1 3.1-3.1 8.2 0 11.3l42.4 42.4c3.1 3.1 8.2 3.1 11.3 0L855.6 222c3.2-3 3.2-8.1 0.1-11.2zM304 448c79.4 0 144-64.6 144-144s-64.6-144-144-144-144 64.6-144 144 64.6 144 144 144z m0-216c39.7 0 72 32.3 72 72s-32.3 72-72 72-72-32.3-72-72 32.3-72 72-72zM720 576c-79.4 0-144 64.6-144 144s64.6 144 144 144 144-64.6 144-144-64.6-144-144-144z m0 216c-39.7 0-72-32.3-72-72s32.3-72 72-72 72 32.3 72 72-32.3 72-72 72z","p-id":"5920"})),o.createElement("symbol",{viewBox:"0 0 1024 1024",id:"number-decrease"},o.createElement("path",{fill:"#525C6F",d:"M132.266667 597.333333h76.8a4.266667 4.266667 0 0 0 4.266666-4.266666v-76.8a4.266667 4.266667 0 0 0-4.266666-4.266667H132.266667a4.266667 4.266667 0 0 0-4.266667 4.266667v76.8a4.266667 4.266667 0 0 0 4.266667 4.266666z m367.616-403.925333a94.72 94.72 0 0 0-27.306667-17.322667c-25.514667-10.496-54.954667-11.392-81.706667-5.632-36.778667 7.936-66.56 31.872-84.906666 64.256-19.797333 34.816-28.16 77.397333-28.16 139.178667 0 61.184 8.405333 102.4 28.16 137.941333a125.866667 125.866667 0 0 0 112.768 67.797334c48.64 0 90.581333-25.6 113.365333-67.84 19.2-34.773333 28.16-77.354667 28.16-135.552 0-50.432-5.888-104.106667-32.768-148.394667a148.906667 148.906667 0 0 0-27.562667-34.474667z m-81.066667 314.197333c-38.954667 0-59.306667-45.568-59.306667-134.4 0-88.149333 20.394667-133.76 58.794667-133.76 39.594667 0 59.306667 45.653333 59.306667 135.552 0 87.04-20.394667 132.565333-58.794667 132.565334z m289.024 212.394667a4.266667 4.266667 0 0 1-4.266667-4.266667V640l-103.68 103.68a4.266667 4.266667 0 0 0 0 6.016L704 853.333333v-75.733333a4.266667 4.266667 0 0 1 4.266667-4.266667H896v-53.333333h-187.733333z","p-id":"6524"})),o.createElement("symbol",{viewBox:"0 0 1024 1024",id:"number-increase"},o.createElement("path",{fill:"#525C6F",d:"M132.266667 597.333333h76.8a4.266667 4.266667 0 0 0 4.266666-4.266666v-76.8a4.266667 4.266667 0 0 0-4.266666-4.266667H132.266667a4.266667 4.266667 0 0 0-4.266667 4.266667v76.8a4.266667 4.266667 0 0 0 4.266667 4.266666z m366.848-402.944a111.530667 111.530667 0 0 0-45.226667-21.76 142.933333 142.933333 0 0 0-71.253333 1.152A130.56 130.56 0 0 0 305.92 234.666667c-19.797333 34.816-28.16 77.397333-28.16 139.178666 0 61.184 8.405333 102.4 28.16 137.941334a125.866667 125.866667 0 0 0 112.768 67.797333c48.64 0 90.581333-25.6 113.365333-67.84 19.2-34.773333 28.16-77.354667 28.16-135.552 0-61.696-11.178667-141.653333-61.098666-181.888z m-79.872 313.173334c-38.954667 0-59.306667-45.568-59.306667-134.4 0-88.149333 20.394667-133.76 58.794667-133.76 39.594667 0 59.306667 45.653333 59.306666 135.552 0 87.04-20.394667 132.565333-58.794666 132.565333z m335.232 71.978666c48.64 0 90.581333-25.6 113.365333-67.84 19.2-34.730667 28.16-77.312 28.16-135.509333 0-47.786667-3.84-99.114667-27.093333-141.909333-27.178667-50.176-82.944-75.392-139.093334-64.554667l-12.8 3.157333A128.64 128.64 0 0 0 641.706667 234.666667c-19.797333 34.773333-28.16 77.354667-28.16 139.093333 0 61.184 8.405333 102.4 28.16 137.941333a125.866667 125.866667 0 0 0 112.768 67.754667z m0-340.053333c39.594667 0 59.306667 45.653333 59.306666 135.552 0 86.954667-20.394667 132.565333-58.794666 132.565333-38.954667 0-59.306667-45.568-59.306667-134.4 0-88.192 20.394667-133.76 58.794667-133.76z m34.858666 476.16a4.266667 4.266667 0 0 1-4.266666 4.266667H597.333333v53.333333h187.733334a4.266667 4.266667 0 0 1 4.266666 4.266667V853.333333l103.68-103.68a4.266667 4.266667 0 0 0 0-6.016L789.333333 640v75.733333z","p-id":"6702"})),o.createElement("symbol",{viewBox:"0 0 24 24",id:"format-painter"},o.createElement("path",{fill:"#525C6F",d:"M15.1004 6.5L6.90039 6.5V9.8L15.1004 9.8L15.1004 6.5ZM15.1004 5C15.9288 5 16.6004 5.67157 16.6004 6.5V9.8C16.6004 10.6284 15.9288 11.3 15.1004 11.3H6.90039C6.07196 11.3 5.40039 10.6284 5.40039 9.8V6.5C5.40039 5.67157 6.07196 5 6.90039 5H15.1004Z"}),o.createElement("path",{fill:"#525C6F",d:"M17.7174 8.90039H15.3262V7.40039H18.4674C18.8816 7.40039 19.2174 7.73618 19.2174 8.15039V13.7859C19.2174 14.163 18.9374 14.4814 18.5634 14.5297L10.8174 15.5299V19.0004H9.31738V14.8705C9.31738 14.4934 9.59736 14.175 9.97134 14.1267L17.7174 13.1265V8.90039Z"})),o.createElement("symbol",{viewBox:"0 0 1096 1096",id:"formula-sum"},o.createElement("path",{fill:"#525C6F",d:"M725.333333 853.333333H256c-17.066667 0-29.866667-8.533333-38.4-25.6-8.533333-17.066667-4.266667-34.133333 4.266667-46.933333l230.4-268.8-230.4-268.8c-8.533333-12.8-12.8-34.133333-4.266667-46.933333 8.533333-17.066667 21.333333-25.6 38.4-25.6h469.333333c46.933333 0 85.333333 38.4 85.333334 85.333333v85.333333c0 25.6-17.066667 42.666667-42.666667 42.666667s-42.666667-17.066667-42.666667-42.666667V256H349.866667l196.266666 226.133333c12.8 17.066667 12.8 38.4 0 55.466667L349.866667 768H725.333333v-85.333333c0-25.6 17.066667-42.666667 42.666667-42.666667s42.666667 17.066667 42.666667 42.666667v85.333333c0 46.933333-38.4 85.333333-85.333334 85.333333z"})),o.createElement("symbol",{viewBox:"0 0 1024 1024",id:"arrow-doubleleft"},o.createElement("path",{d:"M272.9 512l265.4-339.1c4.1-5.2 0.4-12.9-6.3-12.9h-77.3c-4.9 0-9.6 2.3-12.6 6.1L186.8 492.3c-9.1 11.6-9.1 27.9 0 39.5l255.3 326.1c3 3.9 7.7 6.1 12.6 6.1H532c6.7 0 10.4-7.7 6.3-12.9L272.9 512z"}),o.createElement("path",{d:"M576.9 512l265.4-339.1c4.1-5.2 0.4-12.9-6.3-12.9h-77.3c-4.9 0-9.6 2.3-12.6 6.1L490.8 492.3c-9.1 11.6-9.1 27.9 0 39.5l255.3 326.1c3 3.9 7.7 6.1 12.6 6.1H836c6.7 0 10.4-7.7 6.3-12.9L576.9 512z"})),o.createElement("symbol",{viewBox:"0 0 1024 1024",id:"arrow-doubleright"},o.createElement("path",{d:"M533.2 492.3L277.9 166.1c-3-3.9-7.7-6.1-12.6-6.1H188c-6.7 0-10.4 7.7-6.3 12.9L447.1 512 181.7 851.1c-4.1 5.2-0.4 12.9 6.3 12.9h77.3c4.9 0 9.6-2.3 12.6-6.1l255.3-326.1c9.1-11.7 9.1-27.9 0-39.5z"}),o.createElement("path",{d:"M837.2 492.3L581.9 166.1c-3-3.9-7.7-6.1-12.6-6.1H492c-6.7 0-10.4 7.7-6.3 12.9L751.1 512 485.7 851.1c-4.1 5.2-0.4 12.9 6.3 12.9h77.3c4.9 0 9.6-2.3 12.6-6.1l255.3-326.1c9.1-11.7 9.1-27.9 0-39.5z"})),o.createElement("symbol",{viewBox:"0 0 24 24",fill:"none",id:"freeze-col"},o.createElement("rect",{x:"5.75",y:"5.75",width:"12.5",height:"12.5",stroke:"#525C6F",strokeWidth:"1.5"}),o.createElement("path",{d:"M5.75 12H18.25M12 5.5V18.5",stroke:"#525C6F",strokeWidth:"1.5"}),o.createElement("path",{d:"M12 12L5.5 17.75",stroke:"#525C6F",strokeWidth:"1.5"}),o.createElement("path",{d:"M11.25 6L5.75 11.5",stroke:"#525C6F",strokeWidth:"1.5"})),o.createElement("symbol",{viewBox:"0 0 24 24",fill:"none",id:"freeze-row"},o.createElement("rect",{x:"5.75",y:"5.75",width:"12.5",height:"12.5",stroke:"#525C6F",strokeWidth:"1.5"}),o.createElement("path",{d:"M5.75 12H18.25M12 5.5V18.5",stroke:"#525C6F",strokeWidth:"1.5"}),o.createElement("path",{d:"M18 6.5L11.5 12.25",stroke:"#525C6F",strokeWidth:"1.5"}),o.createElement("path",{d:"M11.25 6L5.75 11.5",stroke:"#525C6F",strokeWidth:"1.5"})),o.createElement("symbol",{viewBox:"0 0 24 24",fill:"none",id:"freeze-row-col"},o.createElement("rect",{x:"5.75",y:"5.75",width:"12.5",height:"12.5",stroke:"#525C6F",strokeWidth:"1.5"}),o.createElement("path",{d:"M5.75 12H18.25M12 5.5V18.5",stroke:"#525C6F",strokeWidth:"1.5"}),o.createElement("path",{d:"M18 6L5.75 18.25",stroke:"#525C6F",strokeWidth:"1.5"}),o.createElement("path",{d:"M11.25 6L5.75 11.5",stroke:"#525C6F",strokeWidth:"1.5"})),o.createElement("symbol",{viewBox:"0 0 24 24",fill:"none",id:"freeze-cancel"},o.createElement("rect",{x:"5.75",y:"5.75",width:"12.5",height:"12.5",stroke:"#535A68",strokeWidth:"1.5"}),o.createElement("line",{x1:"6.5",y1:"12",x2:"17.5",y2:"12",stroke:"#535A68",strokeWidth:"1.5"}),o.createElement("line",{x1:"12",y1:"17.5",x2:"12",y2:"6.5",stroke:"#535A68",strokeWidth:"1.5"})),o.createElement("symbol",{viewBox:"0 0 1024 1024",fill:"#535A68",id:"sort-desc"},o.createElement("path",{d:"M839.6 433.8L749 150.5c-1.2-3.9-4.8-6.5-8.9-6.5h-77.4c-4.1 0-7.6 2.6-8.9 6.5l-91.3 283.3c-0.3 0.9-0.5 1.9-0.5 2.9 0 5.1 4.2 9.3 9.3 9.3h56.4c4.2 0 7.8-2.8 9-6.8l17.5-61.6h89l17.3 61.5c1.1 4 4.8 6.8 9 6.8h61.2c1 0 1.9-0.1 2.8-0.4 2.4-0.8 4.3-2.4 5.5-4.6 1.1-2.2 1.3-4.7 0.6-7.1zM663.3 325.5l32.8-116.9h6.3l32.1 116.9h-71.2z","p-id":"2016"}),o.createElement("path",{d:"M806.8 818.4H677.2v-0.4l132.6-188.9c1.1-1.6 1.7-3.4 1.7-5.4v-36.4c0-5.1-4.2-9.3-9.3-9.3h-204c-5.1 0-9.3 4.2-9.3 9.3v43c0 5.1 4.2 9.3 9.3 9.3h122.6v0.4L587.7 828.9c-1.1 1.6-1.7 3.4-1.7 5.4v36.4c0 5.1 4.2 9.3 9.3 9.3h211.4c5.1 0 9.3-4.2 9.3-9.3v-43c0.1-5.1-4.1-9.3-9.2-9.3z","p-id":"2017"}),o.createElement("path",{d:"M416 702h-76V172c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v530h-76c-6.7 0-10.5 7.8-6.3 13l112 141.9c3.2 4.1 9.4 4.1 12.6 0l112-141.9c4.1-5.2 0.4-13-6.3-13z","p-id":"2018"})),o.createElement("svg",{viewBox:"0 0 1024 1024",fill:"#535A68",id:"sort-asc"},o.createElement("path",{d:"M839.6 433.8L749 150.5c-1.2-3.9-4.8-6.5-8.9-6.5h-77.4c-4.1 0-7.6 2.6-8.9 6.5l-91.3 283.3c-0.3 0.9-0.5 1.9-0.5 2.9 0 5.1 4.2 9.3 9.3 9.3h56.4c4.2 0 7.8-2.8 9-6.8l17.5-61.6h89l17.3 61.5c1.1 4 4.8 6.8 9 6.8h61.2c1 0 1.9-0.1 2.8-0.4 2.4-0.8 4.3-2.4 5.5-4.6 1.1-2.2 1.3-4.7 0.6-7.1zM663.3 325.5l32.8-116.9h6.3l32.1 116.9h-71.2z","p-id":"2263"}),o.createElement("path",{d:"M806.8 818.4H677.2v-0.4l132.6-188.9c1.1-1.6 1.7-3.4 1.7-5.4v-36.4c0-5.1-4.2-9.3-9.3-9.3h-204c-5.1 0-9.3 4.2-9.3 9.3v43c0 5.1 4.2 9.3 9.3 9.3h122.6v0.4L587.7 828.9c-1.1 1.6-1.7 3.4-1.7 5.4v36.4c0 5.1 4.2 9.3 9.3 9.3h211.4c5.1 0 9.3-4.2 9.3-9.3v-43c0.1-5.1-4.1-9.3-9.2-9.3z","p-id":"2264"}),o.createElement("path",{d:"M310.3 167.1c-3.2-4.1-9.4-4.1-12.6 0L185.7 309c-4.2 5.3-0.4 13 6.3 13h76v530c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V322h76c6.7 0 10.5-7.8 6.3-13l-112-141.9z","p-id":"2265"})),o.createElement("symbol",{viewBox:"0 0 1024 1024",fill:"#535A68",id:"more"},o.createElement("path",{d:"M224 597.333333C183.466667 597.333333 149.333333 563.2 149.333333 522.666667S183.466667 448 224 448s74.666667 34.133333 74.666667 74.666667-32 74.666667-74.666667 74.666666zM512 597.333333c-40.533333 0-74.666667-34.133333-74.666667-74.666666S471.466667 448 512 448s74.666667 34.133333 74.666667 74.666667S554.666667 597.333333 512 597.333333zM800 597.333333c-40.533333 0-74.666667-34.133333-74.666667-74.666666s34.133333-74.666667 74.666667-74.666667 74.666667 34.133333 74.666667 74.666667-32 74.666667-74.666667 74.666666z"})),o.createElement("symbol",{viewBox:"0 0 1024 1024",width:"24",height:"24",id:"text-clip"},o.createElement("path",{d:"M217.6 810.666667h76.8a4.266667 4.266667 0 0 0 4.266667-4.266667V217.6a4.266667 4.266667 0 0 0-4.266667-4.266667H217.6a4.266667 4.266667 0 0 0-4.266667 4.266667v588.8a4.266667 4.266667 0 0 0 4.266667 4.266667zM725.333333 217.6v247.466667a4.266667 4.266667 0 0 1-4.266666 4.266666H388.266667a4.266667 4.266667 0 0 0-4.266667 4.266667v76.8a4.266667 4.266667 0 0 0 4.266667 4.266667h332.8a4.266667 4.266667 0 0 1 4.266666 4.266666v247.466667a4.266667 4.266667 0 0 0 4.266667 4.266667h76.8a4.266667 4.266667 0 0 0 4.266667-4.266667V217.6a4.266667 4.266667 0 0 0-4.266667-4.266667h-76.8a4.266667 4.266667 0 0 0-4.266667 4.266667z","p-id":"13371",fill:"#525C6F"})),o.createElement("symbol",{viewBox:"0 0 1024 1024",fill:"#535A68",id:"text-rotation-none"},o.createElement("path",{d:"M657.066667 620.088889c24.177778 0 39.822222-24.177778 31.288889-46.933333L509.155556 150.755556c-14.222222-34.133333-64-34.133333-78.222223 0L250.311111 573.155556c-9.955556 22.755556 7.111111 46.933333 31.288889 46.933333 14.222222 0 25.6-8.533333 31.288889-21.333333l36.977778-92.444445h240.355555l36.977778 92.444445c4.266667 12.8 17.066667 21.333333 29.866667 21.333333z m-285.866667-170.666667L469.333333 203.377778l98.133334 246.044444H371.2zM704 662.755556c-11.377778 11.377778-11.377778 28.444444 0 39.822222l45.511111 45.511111H204.8c-15.644444 0-28.444444 12.8-28.444444 28.444444s12.8 28.444444 28.444444 28.444445h544.711111l-45.511111 45.511111c-11.377778 11.377778-11.377778 28.444444 0 39.822222 11.377778 11.377778 28.444444 11.377778 39.822222 0L839.111111 796.444444c11.377778-11.377778 11.377778-28.444444 0-39.822222l-93.866667-93.866666c-11.377778-11.377778-29.866667-11.377778-41.244444 0z","p-id":"17165"})),o.createElement("symbol",{viewBox:"0 0 1024 1024",fill:"#535A68",id:"text-rotation-angleup"},o.createElement("path",{d:"M634.311111 398.222222c17.066667-17.066667 11.377778-45.511111-11.377778-54.044444L196.266667 170.666667c-35.555556-14.222222-69.688889 21.333333-55.466667 55.466666l172.088889 426.666667c8.533333 22.755556 38.4 28.444444 54.044444 11.377778 9.955556-9.955556 12.8-24.177778 7.111111-36.977778l-39.822222-91.022222 170.666667-170.666667 91.022222 39.822222c12.8 4.266667 28.444444 2.844444 38.4-7.111111z m-322.844444 81.066667l-105.244445-243.2L449.422222 341.333333l-137.955555 137.955556zM696.888889 393.955556c0 15.644444 12.8 28.444444 28.444444 28.444444h64L403.911111 807.822222c-11.377778 11.377778-11.377778 28.444444 0 39.822222 11.377778 11.377778 28.444444 11.377778 39.822222 0l385.422223-385.422222V526.222222c0 15.644444 12.8 28.444444 28.444444 28.444445s28.444444-12.8 28.444444-28.444445v-133.688889c0-15.644444-12.8-28.444444-28.444444-28.444444h-133.688889c-14.222222 1.422222-27.022222 14.222222-27.022222 29.866667z","p-id":"17929"})),o.createElement("symbol",{viewBox:"0 0 1024 1024",fill:"#535A68",id:"text-rotation-angledown"},o.createElement("path",{d:"M625.777778 634.311111c17.066667 17.066667 45.511111 11.377778 54.044444-11.377778l172.088889-426.666666c14.222222-35.555556-21.333333-69.688889-55.466667-55.466667L371.2 312.888889c-22.755556 8.533333-28.444444 38.4-11.377778 54.044444 9.955556 9.955556 24.177778 12.8 36.977778 7.111111l91.022222-39.822222 170.666667 170.666667-39.822222 92.444444c-4.266667 11.377778-2.844444 27.022222 7.111111 36.977778z m-81.066667-322.844444l243.2-105.244445L682.666667 449.422222l-137.955556-137.955555zM630.044444 696.888889c-15.644444 0-28.444444 12.8-28.444444 28.444444v64L216.177778 403.911111c-11.377778-11.377778-28.444444-11.377778-39.822222 0-11.377778 11.377778-11.377778 28.444444 0 39.822222l385.422222 385.422223H497.777778c-15.644444 0-28.444444 12.8-28.444445 28.444444s12.8 28.444444 28.444445 28.444444h133.688889c15.644444 0 28.444444-12.8 28.444444-28.444444v-133.688889c-1.422222-14.222222-14.222222-27.022222-29.866667-27.022222z","p-id":"18084"})),o.createElement("symbol",{viewBox:"0 0 1024 1024",fill:"#535A68",id:"text-rotation-vertical"},o.createElement("path",{d:"M465.066667 672.711111c-24.177778 0-39.822222-24.177778-31.288889-46.933333l179.2-423.822222c14.222222-34.133333 64-34.133333 78.222222 0L871.822222 625.777778c9.955556 22.755556-7.111111 46.933333-31.288889 46.933333-14.222222 0-25.6-8.533333-31.288889-21.333333l-36.977777-92.444445H531.911111l-36.977778 92.444445c-4.266667 12.8-17.066667 21.333333-29.866666 21.333333z m285.866666-170.666667L652.8 256 554.666667 502.044444h196.266666zM157.866667 704c11.377778-11.377778 28.444444-11.377778 39.822222 0l45.511111 45.511111V204.8c0-15.644444 12.8-28.444444 28.444444-28.444444s28.444444 12.8 28.444445 28.444444v544.711111l45.511111-45.511111c11.377778-11.377778 28.444444-11.377778 39.822222 0 11.377778 11.377778 11.377778 28.444444 0 39.822222L292.977778 839.111111c-11.377778 11.377778-28.444444 11.377778-39.822222 0l-93.866667-93.866667c-12.8-11.377778-12.8-29.866667-1.422222-41.244444z","p-id":"18239"})),o.createElement("symbol",{viewBox:"0 0 1024 1024",fill:"#535A68",id:"text-rotation-up"},o.createElement("path",{d:"M620.088889 366.933333c0-24.177778-24.177778-39.822222-46.933333-31.288889L150.755556 514.844444c-34.133333 14.222222-34.133333 64 0 78.222223l423.822222 179.2c22.755556 9.955556 46.933333-7.111111 46.933333-31.288889 0-14.222222-8.533333-25.6-21.333333-31.288889l-92.444445-36.977778V433.777778l92.444445-36.977778c11.377778-4.266667 19.911111-17.066667 19.911111-29.866667z m-170.666667 285.866667L203.377778 554.666667l246.044444-98.133334v196.266667zM662.755556 320c11.377778 11.377778 28.444444 11.377778 39.822222 0l45.511111-45.511111v544.711111c0 15.644444 12.8 28.444444 28.444444 28.444444s28.444444-12.8 28.444445-28.444444V274.488889l45.511111 45.511111c11.377778 11.377778 28.444444 11.377778 39.822222 0 11.377778-11.377778 11.377778-28.444444 0-39.822222L796.444444 184.888889c-11.377778-11.377778-28.444444-11.377778-39.822222 0l-93.866666 93.866667c-11.377778 11.377778-11.377778 29.866667 0 41.244444z","p-id":"18394"})),o.createElement("symbol",{viewBox:"0 0 1024 1024",fill:"#535A68",id:"screenshot"},o.createElement("path",{d:"M320 704V128H256v128H128v64h128v448h448v128h64v-128h128v-64H320z m384-64h64V256H384v64h320v320z","p-id":"3788"})),o.createElement("symbol",{viewBox:"0 0 1024 1024",fill:"#535A68",id:"conditionFormat",width:"20"},o.createElement("path",{d:"M128 128h768v768H128V128z m64 512v128h128v-128H192z m256 0v128h192v-128H448zM192 448v128h128V448H192z m0-192v128h128V256H192z m192 0v128h192V256H384z m320 384v128h128v-128h-128z m0-192v128h128V448h-128z m0-192v128h128V256h-128z","p-id":"1955"})),o.createElement("symbol",{viewBox:"0 0 1024 1024",fill:"#535A68",id:"splitColumn"},o.createElement("path",{d:"M143.36 184.32v163.84h737.28v-163.84h-737.28z m-40.96-40.96h819.2v245.76h-819.2v-245.76z m342.016 333.824l67.584 67.584 67.584-67.584c8.192-8.192 20.48-8.192 28.672 0 8.192 8.192 8.192 20.48 0 28.672l-96.256 96.256-96.256-96.256c-8.192-8.192-8.192-20.48 0-28.672 8.192-8.192 20.48-8.192 28.672 0z m-342.016 157.696h368.64v245.76h-368.64v-245.76z m450.56 0h368.64v245.76h-368.64v-245.76z m-409.6 204.8h286.72v-163.84h-286.72v163.84z m450.56 0h286.72v-163.84h-286.72v163.84z","p-id":"1984"})),o.createElement("symbol",{viewBox:"0 0 1024 1024",fill:"#535A68",id:"locationCondition"},o.createElement("path",{d:"M938.666667 388.266667H584.533333V247.466667a21.333333 21.333333 0 0 0-21.333333-21.333334H85.333333A21.333333 21.333333 0 0 0 64 247.466667v324.266666a21.333333 21.333333 0 0 0 21.333333 21.333334h277.333334V785.066667a21.333333 21.333333 0 0 0 21.333333 21.333333h554.666667a21.333333 21.333333 0 0 0 21.333333-21.333333V409.6a21.333333 21.333333 0 0 0-21.333333-21.333333z m-832 162.133333v-281.6h435.2v119.466667H384a21.333333 21.333333 0 0 0-21.333333 21.333333v140.8h-256z","p-id":"9672"})),o.createElement("symbol",{viewBox:"0 0 1024 1024",fill:"#535A68",id:"dataVerification"},o.createElement("path",{d:"M510.9 921.6l-107.8-66.2c-124.6-76.5-202-214.8-202-361.1V243.9h21.7c205.1 0 262-115.5 267.8-128.6l5.7-13 28.7-0.3 6.2 13.1c5.9 13.3 62.8 128.8 267.8 128.8h21.7v250.4c0 146.3-77.4 284.6-202 361.1l-107.8 66.2zM244.5 287v207.3c0 131.2 69.5 255.4 181.3 324.1l85.1 52.2 85.1-52.2c111.8-68.6 181.3-192.8 181.3-324.1V287c-157.7-6.1-234.1-77.8-266.4-121.7-32.2 43.8-108.6 115.6-266.4 121.7z","p-id":"5514"}),o.createElement("path",{d:"M502.2 617.3c-5.6 0-11.1-2.1-15.4-6.4L410 534.1c-8.5-8.5-8.5-22.2 0-30.7s22.2-8.5 30.7 0l61.4 61.4 108.7-108.7c8.5-8.5 22.2-8.5 30.7 0s8.5 22.2 0 30.7l-124 124.1c-4.2 4.2-9.8 6.4-15.3 6.4z","p-id":"5515"})),o.createElement("symbol",{viewBox:"0 0 1024 1024",fill:"#535A68",id:"text-rotation-down"},o.createElement("path",{d:"M403.911111 657.066667c0 24.177778 24.177778 39.822222 46.933333 31.288889L873.244444 509.155556c34.133333-14.222222 34.13333299-64 0-78.222223L450.844444 250.311111c-22.755556-9.955556-46.933333 7.111111-46.933333 31.288889 0 14.222222 8.533333 25.6 21.333333 31.288889l92.444445 36.977778-1e-8 240.355555-92.44444499 36.977778c-12.8 4.266667-21.333333 17.066667-21.333333 29.866667z m170.666667-285.86666701L820.622222 469.33333299l-246.044444 98.13333401L574.577778 371.19999999zM361.244444 704c-11.377778-11.377778-28.444444-11.377778-39.822222 0l-45.511111 45.511111L275.911111 204.79999999c0-15.644444-12.8-28.444444-28.44444399-28.44444399s-28.444444 12.8-28.44444501 28.444444l-1e-8 544.711111-45.51111099-45.511111c-11.377778-11.377778-28.444444-11.377778-39.822222 0-11.377778 11.377778-11.377778 28.444444 0 39.822222L227.555556 839.111111c11.377778 11.377778 28.444444 11.377778 39.822222-1e-8l93.866666-93.86666699c11.377778-11.377778 11.377778-29.866667 0-41.244444z","p-id":"10914"})),o.createElement("symbol",{viewBox:"0 0 1024 1024",fill:"#535A68",id:"search"},o.createElement("path",{d:"M469.333 192c153.174 0 277.334 124.16 277.334 277.333 0 68.054-24.534 130.411-65.216 178.688L846.336 818.24l-48.341 49.877L630.4 695.125a276.053 276.053 0 0 1-161.067 51.542C316.16 746.667 192 622.507 192 469.333S316.16 192 469.333 192z m0 64C351.51 256 256 351.51 256 469.333s95.51 213.334 213.333 213.334 213.334-95.51 213.334-213.334S587.157 256 469.333 256z","p-id":"11202"})),o.createElement("symbol",{viewBox:"0 0 1024 1024",fill:"#535A68",id:"link"},o.createElement("path",{d:"M577.155781 655.619241L431.54903 801.139578a119.509873 119.509873 0 0 1-169.111224 0l-26.442532-25.924051a119.6827 119.6827 0 0 1 0-169.111223L366.393249 475.274262a21.344135 21.344135 0 0 1 30.417553 0 21.516962 21.516962 0 0 1 0 30.503966L266.585654 636.176203a76.389536 76.389536 0 0 0 0 108.016877l26.442532 26.442532a76.389536 76.389536 0 0 0 108.016877 0l145.520338-145.606751a76.389536 76.389536 0 0 0 0-108.016878L535.763713 505.864641A21.516962 21.516962 0 0 1 535.763713 475.274262a21.344135 21.344135 0 0 1 30.417553 0l11.233755 11.147341a119.6827 119.6827 0 0 1-0.25924 169.197638z","p-id":"28239"}),o.createElement("path",{d:"M546.565401 517.011983L535.763713 505.864641A21.516962 21.516962 0 0 1 535.763713 475.274262a21.344135 21.344135 0 0 1 30.417553 0l11.233755 11.147341","p-id":"28240"}),o.createElement("path",{d:"M446.844219 368.380759l145.606751-145.520337a119.509873 119.509873 0 0 1 169.111224 0l26.442532 26.356118a119.6827 119.6827 0 0 1 0 169.111224L657.606751 548.639325a21.344135 21.344135 0 0 1-30.417553 0 21.516962 21.516962 0 0 1 0-30.503966l130.225148-130.311562a76.389536 76.389536 0 0 0 0-108.016877l-26.442532-26.442532a76.389536 76.389536 0 0 0-108.016877 0L477.434599 398.971139a76.389536 76.389536 0 0 0 0 108.016878L488.581941 518.481013a21.516962 21.516962 0 0 1 0 30.503966 21.344135 21.344135 0 0 1-30.417553 0l-11.233755-11.147342a119.6827 119.6827 0 0 1-0.086414-169.456878z","p-id":"28241"}),o.createElement("path",{d:"M477.434599 506.988017L488.581941 518.481013a21.516962 21.516962 0 0 1 0 30.503966 21.344135 21.344135 0 0 1-30.417553 0l-11.233755-11.147342","p-id":"28242"})),o.createElement("symbol",{viewBox:"0 0 1024 1024",fill:"#535A68",id:"copy"},o.createElement("path",{d:"M832 128c-12.8-76.8-76.8-128-160-128h-448C102.4 0 0 102.4 0 224v448c0 76.8 57.6 140.8 128 160 12.8 76.8 76.8 128 160 128h512c89.6 0 160-70.4 160-160v-512c0-76.8-57.6-140.8-128-160zM64 672v-448C64 134.4 134.4 64 224 64h448c44.8 0 76.8 25.6 89.6 64H288C198.4 128 128 198.4 128 288v473.6c-38.4-12.8-64-44.8-64-89.6z m832 128c0 51.2-44.8 96-96 96h-512c-51.2 0-96-44.8-96-96v-512C192 236.8 236.8 192 288 192h512c51.2 0 96 44.8 96 96v512z","p-id":"28791"})),o.createElement("symbol",{viewBox:"0 0 1024 1024",fill:"#535A68",id:"pencil"},o.createElement("path",{d:"M966.283012 57.28336A194.600516 194.600516 0 0 0 828.144425 0.000203c-49.932663 0-100.118792 19.009897-138.138586 57.283157l-667.12066 667.12066-22.811877 276.784103c-1.013861 12.166334 8.61782 22.304946 20.530689 22.304946h1.774257l276.784104-22.811876 667.12066-667.12066c76.293054-76.293054 76.293054-199.984119 0-276.277173zM271.534635 941.116848l-205.813821 16.72871L82.702989 751.778272l547.231575-547.231575 189.085111 189.085111-547.48504 547.48504zM922.686981 289.964502l-60.071275 60.071275-189.085111-189.085111 60.071275-60.071275c25.34653-25.34653 58.803949-39.033656 94.542555-39.033656 35.738607 0 69.196026 13.940591 94.542556 39.033656 52.213851 52.213851 52.213851 136.87126 0 189.085111z","p-id":"40167"})),o.createElement("symbol",{fill:"#535A68",id:"unlink",viewBox:"0 0 1024 1024"},o.createElement("path",{d:"M240.469333 240.469333l241.194667 241.194667 90.965333-90.965333a42.88 42.88 0 0 1 60.672 60.672L542.293333 542.293333l241.237334 241.237334a42.666667 42.666667 0 0 1-60.330667 60.330666l-119.936-119.893333-151.893333 151.893333a214.4 214.4 0 0 1-309.674667-296.533333l6.4-6.698667 151.936-151.893333-119.893333-119.893333a42.666667 42.666667 0 0 1 60.330666-60.373334z m120.192 240.896l-151.893333 151.893334a128.64 128.64 0 0 0 176.426667 187.136l5.546666-5.162667 151.850667-151.936-60.629333-60.629333-30.592 30.634666a42.88 42.88 0 1 1-60.672-60.672l30.634666-30.592-60.672-60.672z m515.2-333.226666a214.4 214.4 0 0 1 0 303.232l-121.301333 121.258666A42.88 42.88 0 1 1 693.973333 512l121.258667-121.301333a128.64 128.64 0 0 0-181.930667-181.930667L512 330.069333a42.88 42.88 0 1 1-60.629333-60.629333l121.258666-121.301333a214.4 214.4 0 0 1 303.232 0z m-333.653333 273.365333l-60.373333 60.330667 60.330666 60.330666 60.330667-60.330666-60.330667-60.330667z","p-id":"39251"})),o.createElement("symbol",{viewBox:"0 0 1024 1024",fill:"#535A68",id:"filter"},o.createElement("path",{d:"M872.533333 134.4c-12.8-10.666667-29.866667-17.066667-49.066666-17.066667H198.4C157.866667 117.333333 123.733333 151.466667 123.733333 192c0 17.066667 6.4 34.133333 17.066667 49.066667l256 302.933333v251.733333c0 12.8 6.4 23.466667 17.066667 27.733334l162.133333 81.066666c4.266667 2.133333 8.533333 4.266667 14.933333 4.266667 6.4 0 10.666667-2.133333 17.066667-4.266667 8.533333-6.4 14.933333-17.066667 14.933333-27.733333V541.866667l256-302.933334c12.8-14.933333 19.2-34.133333 17.066667-53.333333 2.133333-19.2-6.4-38.4-23.466667-51.2z m-38.4 64L569.6 509.866667c-4.266667 6.4-8.533333 12.8-8.533333 21.333333v292.266667l-98.133334-49.066667V531.2c0-8.533333-2.133333-14.933333-8.533333-21.333333L189.866667 198.4c0-2.133333-2.133333-4.266667-2.133334-6.4 0-6.4 4.266667-10.666667 10.666667-10.666667h625.066667c2.133333 0 4.266667 0 6.4 2.133334 2.133333 2.133333 4.266667 6.4 4.266666 6.4 2.133333 2.133333 2.133333 6.4 0 8.533333z","p-id":"43580"})),o.createElement("symbol",{viewBox:"0 0 1024 1024",fill:"#535A68",id:"filter1"},o.createElement("path",{d:"M608 864C588.8 864 576 851.2 576 832L576 448c0-6.4 6.4-19.2 12.8-25.6L787.2 256c6.4-6.4 6.4-19.2 0-19.2 0-6.4-6.4-12.8-19.2-12.8L256 224c-12.8 0-19.2 6.4-19.2 12.8 0 6.4-6.4 12.8 6.4 19.2l198.4 166.4C441.6 428.8 448 441.6 448 448l0 256c0 19.2-12.8 32-32 32S384 723.2 384 704L384 460.8 198.4 307.2c-25.6-25.6-32-64-19.2-96C185.6 179.2 217.6 160 256 160L768 160c32 0 64 19.2 76.8 51.2 12.8 32 6.4 70.4-19.2 89.6l-192 160L633.6 832C640 851.2 627.2 864 608 864z","p-id":"43727"})),o.createElement("symbol",{viewBox:"0 0 1024 1024",fill:"#535A68",id:"eraser"},o.createElement("path",{d:"M596.437333 85.333333a42.837333 42.837333 0 0 0-30.549333 13.824l-469.333333 512a42.666667 42.666667 0 0 0 1.28 59.008l170.666666 170.666667A42.496 42.496 0 0 0 298.666667 853.333333h512v-85.333333h-195.669334l311.168-311.168a42.538667 42.538667 0 0 0 0-60.330667l-298.666666-298.666666A43.221333 43.221333 0 0 0 596.437333 85.333333z m-102.144 682.666667H316.330667l-129.28-129.28 268.8-293.205333 230.485333 230.485333-192.042667 192z m252.373334-252.330667l-233.130667-233.130666 85.12-92.842667L835.669333 426.666667 746.666667 515.669333z","p-id":"50819"})),o.createElement("symbol",{viewBox:"0 0 1057 1024",fill:"#535A68",id:"sort"},o.createElement("path",{d:"M438.634667 192v644.202667l-0.810667 5.781333c-1.152 7.210667-2.304 8.704-8.64 17.002667l-7.168 3.925333c-15.914667 8.490667-18.282667 7.168-38.4-3.925333L149.333333 624.533333l45.269334-45.226666 180.032 180.138666V192h64z m216.96 10.005333l231.04 231.146667-45.269334 45.248L661.333333 298.261333V865.706667h-64V226.133333a34.133333 34.133333 0 0 1 58.282667-24.128z","p-id":"52781"})),o.createElement("symbol",{viewBox:"0 0 1024 1024",fill:"#535A68",id:"filter-fill"},o.createElement("path",{d:"M776.341333 170.666667a64 64 0 0 1 49.557334 104.512L627.541333 517.76v273.386667L398.293333 687.018667v-169.237334l-192.469333-243.413333A64 64 0 0 1 256 170.666667h520.341333z","p-id":"18344"})),o.createElement("symbol",{viewBox:"0 0 1024 1024",fill:"#ffffff",id:"filter-fill-white"},o.createElement("path",{d:"M776.341333 170.666667a64 64 0 0 1 49.557334 104.512L627.541333 517.76v273.386667L398.293333 687.018667v-169.237334l-192.469333-243.413333A64 64 0 0 1 256 170.666667h520.341333z","p-id":"18344"})),o.createElement("symbol",{viewBox:"0 0 1024 1024",fill:"#535A68",id:"all-sheets"},o.createElement("path",{d:"M849.427 1000.999h-157.9c-73.785 0-132.809-59.029-132.809-132.809v-258.243c0-14.759 10.33-26.562 25.088-29.513 4.427-1.472 8.853-2.953 13.278-2.953h252.337c73.785 0 132.809 59.029 132.809 132.809v157.9c-1.472 72.309-60.5 132.809-132.809 132.809zM616.268 636.505v231.684c0 39.844 32.468 73.785 73.785 73.785h157.9c39.844 0 73.785-32.468 73.785-73.785v-157.9c0-39.844-32.468-73.785-73.785-73.785h-231.684z","p-id":"4941"}),o.createElement("path",{d:"M315.23 1000.999h-147.571c-76.736 0-137.241-61.981-137.241-137.241v-147.571c0-76.736 61.981-137.241 137.241-137.241h247.911c4.427 0 8.853 1.472 13.278 2.953 14.759 1.472 25.088 14.759 25.088 29.513v253.814c0 73.785-61.981 135.764-138.711 135.764zM167.657 636.505c-42.796 0-78.211 35.418-78.211 78.211v147.571c0 44.269 35.418 78.211 78.211 78.211h147.571c42.796 0 78.211-35.418 78.211-78.211v-225.779h-225.779z","p-id":"4942"}),o.createElement("path",{d:"M415.576 471.232h-255.291c-72.309 0-129.859-57.549-129.859-129.859v-163.801c0-72.309 57.549-129.859 129.859-129.859h163.801c72.309 0 129.859 57.549 129.859 129.859v261.199c0 14.759-10.33 26.562-25.088 29.513-4.427 1.472-8.853 2.953-13.278 2.953zM158.805 105.259c-38.369 0-70.836 32.468-70.836 70.836v165.279c0 38.369 32.468 70.836 70.836 70.836h234.634v-234.634c0-38.369-32.468-70.836-70.836-70.836h-163.801z","p-id":"4943"}),o.createElement("path",{d:"M847.948 471.232h-252.337c-4.427 0-8.853-1.472-13.278-2.953-14.759-1.472-25.088-14.759-25.088-29.513v-258.243c0-73.785 60.5-134.287 134.287-134.287h156.423c73.785 0 134.287 60.5 134.287 134.287v156.423c-1.472 73.785-60.5 134.287-134.287 134.287zM616.268 412.199h230.207c41.318 0 75.263-33.941 75.263-75.263v-156.423c0-41.318-33.941-75.263-75.263-75.263h-156.423c-41.318 0-75.263 33.941-75.263 75.263v231.684z","p-id":"4944"})),o.createElement("symbol",{viewBox:"0 0 1024 1024",fill:"#535A68",id:"hidden"},o.createElement("path",{d:"M849.152 665.429333c62.762667-69.674667 86.826667-138.538667 87.296-139.904a42.410667 42.410667 0 0 0 0-27.008C935.552 495.658667 837.674667 213.333333 512 213.333333c-37.802667 0-72.192 4.138667-104.064 10.837334l75.776 75.776c9.301333-0.554667 18.517333-1.28 28.288-1.28 228.309333 0 316.757333 164.096 338.176 213.333333a369.365333 369.365333 0 0 1-60.544 93.866667l59.52 59.562666zM512 810.666667c78.293333 0 143.146667-16.597333 196.906667-41.429334l156.928 156.928 60.330666-60.330666-768-768-60.330666 60.330666 141.610666 141.610667c-111.530667 83.285333-151.338667 196.906667-151.936 198.698667a42.410667 42.410667 0 0 0 0 27.008C88.448 528.341333 186.325333 810.666667 512 810.666667zM299.989333 360.32l96.938667 96.938667c-22.229333 47.488-14.378667 106.282667 24.533333 145.194666s97.706667 46.805333 145.194667 24.533334l76.842667 76.842666A394.325333 394.325333 0 0 1 512 725.333333c-228.309333 0-316.757333-164.096-338.176-213.333333a366.933333 366.933333 0 0 1 126.165333-151.68z","p-id":"19355"})),o.createElement("symbol",{viewBox:"0 0 1024 1024",fill:"#535A68",id:"check"},o.createElement("path",{d:"M439.439404 776.947278a32.717146 32.717146 0 0 1-21.343097-7.892761L185.810916 570.228169c-13.779841-11.795651-15.389502-32.527834-3.593851-46.308698 11.795651-13.778818 32.528857-15.390525 46.308699-3.593852L435.957093 697.877431l349.863273-405.566946c11.846816-13.736862 32.588209-15.265682 46.323025-3.415796 13.733792 11.847839 15.263635 32.587186 3.414773 46.322002l-371.235023 430.340165c-6.492878 7.52744-15.661701 11.390421-24.883737 11.390422z",fill:"","p-id":"5612"})),o.createElement("symbol",{viewBox:"0 0 1024 1024",fill:"#A8ABB0",id:"rightArrow"},o.createElement("path",{d:"M781.963636 495.709091l-418.909091-323.490909c-20.945455-16.290909-37.236364-9.309091-37.236363 16.290909v646.981818c0 25.6 16.290909 32.581818 37.236363 16.290909l418.909091-323.490909c11.636364-9.309091 11.636364-23.272727 0-32.581818z","p-id":"5380"})),o.createElement("symbol",{viewBox:"0 0 1024 1024",id:"downArrow"},o.createElement("path",{d:"M163.396608 289.168384c-40.577024 0-66.526208 54.183936-35.44064 85.25824L477.217792 723.704832c20.031488 20.031488 49.82272 20.031488 69.853184 0l349.274112-349.278208c30.30528-30.294016 6.677504-85.25824-34.927616-85.25824L163.396608 289.168384z","p-id":"2683"})),o.createElement("symbol",{viewBox:"0 0 1024 1024",fill:"#272636",id:"headDownArrow"},o.createElement("path",{d:"M0 511.976727C0 229.678545 229.725091 0 511.976727 0s511.976727 229.632 511.976727 511.976727c0 282.391273-229.725091 511.976727-511.976727 511.976727C229.725091 1024 0 794.368 0 511.976727M955.717818 511.976727c0-244.898909-199.121455-444.206545-443.741091-444.206545-244.666182 0-443.694545 199.307636-443.694545 444.206545 0 244.945455 199.121455 444.253091 443.694545 444.253091C756.642909 956.276364 955.717818 756.968727 955.717818 511.976727M230.027636 419.025455c0-6.562909 2.420364-13.102545 7.563636-18.059636 9.914182-9.960727 26.042182-9.960727 36.096 0l238.289455 236.916364L750.312727 401.105455c9.960727-9.914182 26.135273-9.914182 36.305455 0 9.914182 9.960727 9.914182 26.042182 0 35.956364L511.976727 709.678545 237.474909 436.922182C232.424727 432.104727 230.027636 425.588364 230.027636 419.025455","p-id":"5142"})),o.createElement("symbol",{viewBox:"0 0 1024 1024",id:"tab"},o.createElement("path",{d:"M960 591.424V368.96c0-0.288 0.16-0.512 0.16-0.768S960 367.68 960 367.424V192a32 32 0 0 0-32-32H96a32 32 0 0 0-32 32v175.424c0 0.288-0.16 0.512-0.16 0.768s0.16 0.48 0.16 0.768v222.464c0 0.288-0.16 0.512-0.16 0.768s0.16 0.48 0.16 0.768V864a32 32 0 0 0 32 32h832a32 32 0 0 0 32-32v-271.04c0-0.288 0.16-0.512 0.16-0.768S960 591.68 960 591.424z m-560-31.232v-160H608v160h-208z m208 64V832h-208v-207.808H608z m-480-224h208v160H128v-160z m544 0h224v160h-224v-160zM896 224v112.192H128V224h768zM128 624.192h208V832H128v-207.808zM672 832v-207.808h224V832h-224z","p-id":"3023"})),o.createElement("symbol",{viewBox:"0 0 1024 1024",fill:"#535A68",id:"default"},o.createElement("path",{d:"M844.8 896c25.6 0 51.2-19.2 51.2-51.2v-185.6h-51.2c-44.8 0-83.2-38.4-83.2-83.2s38.4-83.2 83.2-83.2h51.2V313.6c0-25.6-19.2-51.2-51.2-51.2h-134.4c0-70.4-57.6-128-128-128S448 185.6 448 256H313.6c-25.6 0-51.2 19.2-51.2 51.2V448C185.6 448 128 505.6 128 576s57.6 128 128 128v134.4c0 25.6 19.2 51.2 51.2 51.2h185.6v-51.2c0-44.8 38.4-83.2 83.2-83.2 44.8 0 83.2 38.4 83.2 83.2v57.6h185.6zM576 710.4c-70.4 0-128 57.6-128 128H307.2v-185.6H256c-44.8 0-83.2-38.4-83.2-83.2S211.2 492.8 256 492.8h51.2V307.2h185.6V256c0-44.8 38.4-83.2 83.2-83.2 44.8 0 83.2 38.4 83.2 83.2v51.2h185.6V448c-70.4 0-128 57.6-128 128s57.6 128 128 128v140.8H704c6.4-70.4-51.2-134.4-128-134.4z",fill:"","p-id":"36983"}))))},eb=function(e){var t=e.triggerParentUpdate,n=(0,o.useContext)(k),a=n.context,r=n.setContext,c=(0,l.SP8)(a),i=c.toolbar,u=c.sheetconfig,s=c.button,d=f((0,o.useState)("#000000"),2),m=d[0],h=d[1],v=f((0,o.useState)(a.luckysheetfile[(0,l.Q8D)(a,a.currentSheetId)].color),2),p=v[0],y=v[1],g=(0,o.useCallback)(function(){y(m)},[m]);return(0,o.useEffect)(function(){r(function(e){if(!1!==e.allowEdit){var t=(0,l.Q8D)(e,e.currentSheetId);e.luckysheetfile[t].color=p}})},[p,r]),o.createElement("div",{id:"fortune-change-color"},o.createElement("div",{className:"color-reset",onClick:function(){return y(void 0)}},u.resetColor),o.createElement("div",{className:"custom-color"},o.createElement("div",null,i.customColor,":"),o.createElement("input",{type:"color",value:m,onChange:function(e){return h(e.target.value)},onFocus:function(){t(!0)},onBlur:function(){t(!1)}}),o.createElement("div",{className:"button-basic button-primary",onClick:function(){g()}},s.confirm)),o.createElement(ea,{onPick:function(e){h(e),y(e)}}))},ex=function(){var e,t=(0,o.useContext)(k),n=t.context,a=t.setContext,r=t.settings,i=n.sheetTabContextMenu,u=i.x,s=i.y,m=i.sheet,h=i.onRename,v=(0,l.SP8)(n).sheetconfig,p=f((0,o.useState)({x:-1,y:-1}),2),y=p[0],E=p[1],C=f((0,o.useState)(!1),2),b=C[0],x=C[1],w=f((0,o.useState)(!1),2),N=w[0],_=w[1],R=H(),M=R.showAlert,S=R.hideAlert,L=(0,o.useRef)(null),V=(0,o.useCallback)(function(){a(function(e){e.sheetTabContextMenu={}})},[a]);(0,o.useLayoutEffect)(function(){var e,t=null===(e=L.current)||void 0===e?void 0:e.getBoundingClientRect();t&&null!=u&&null!=s&&E({x:u,y:s-t.height})},[u,s]),O(L,V,[V]);var z=(0,o.useCallback)(function(e){!1!==n.allowEdit&&m&&a(function(t){var n=-1;c().sortBy(t.luckysheetfile,["order"]).forEach(function(e,t){e.order=t,e.id===m.id&&(n=t)}),l.hi0.setSheetOrder(t,d({},m.id,n+e))})},[n.allowEdit,a,m]),I=(0,o.useCallback)(function(){!1!==n.allowEdit&&m&&a(function(e){e.luckysheetfile.filter(function(e){return c().isUndefined(e.hide)||(null==e?void 0:e.hide)!==1}).length>1?l.hi0.hideSheet(e,m.id):M(v.noMoreSheet,"ok")})},[n.allowEdit,a,m,M,v]),D=(0,o.useCallback)(function(){!1!==n.allowEdit&&(null==m?void 0:m.id)&&a(function(e){l.hi0.copySheet(e,m.id)},{addSheetOp:!0})},[n.allowEdit,a,null==m?void 0:m.id]),F=(0,o.useCallback)(function(e){_(e)},[]),T=(0,o.useCallback)(function(){!1!==n.allowEdit&&(null==m?void 0:m.id)&&a(function(e){c().forEach(e.luckysheetfile,function(e){e.status=m.id===e.id?1:0})})},[n.allowEdit,a,null==m?void 0:m.id]);return m&&null!=u&&null!=s?o.createElement("div",{className:"fortune-context-menu luckysheet-cols-menu",onContextMenu:function(e){return e.stopPropagation()},style:{left:y.x,top:y.y,overflow:"visible"},ref:L},null===(e=r.sheetTabContextMenu)||void 0===e?void 0:e.map(function(e,t){return"delete"===e?o.createElement(ek,{key:e,onClick:function(){var e=n.luckysheetfile.filter(function(e){return c().isUndefined(e.hide)||1!==e.hide});n.luckysheetfile.length>1&&e.length>1?M(v.confirmDelete,"yesno",function(){a(function(e){(0,l.s09)(e,m.id)},{deleteSheetOp:{id:m.id}}),S()}):M(v.noMoreSheet,"ok"),V()}},v.delete):"rename"===e?o.createElement(ek,{key:e,onClick:function(){null==h||h(),V()}},v.rename):"move"===e?o.createElement(o.Fragment,{key:e},o.createElement(ek,{onClick:function(){z(-1.5),V()}},v.moveLeft),o.createElement(ek,{onClick:function(){z(1.5),V()}},v.moveRight)):"hide"===e?o.createElement(ek,{key:e,onClick:function(){I(),V()}},v.hide):"copy"===e?o.createElement(ek,{key:e,onClick:function(){D(),V()}},v.copy):"color"===e?o.createElement(ek,{key:e,onMouseEnter:function(){x(!0)},onMouseLeave:function(){N||x(!1)}},v.changeColor,o.createElement("span",{className:"change-color-triangle"},o.createElement(g,{name:"rightArrow",width:18})),b&&n.allowEdit&&o.createElement(eb,{triggerParentUpdate:F})):"focus"===e?o.createElement(ek,{key:e,onClick:function(){T(),V()}},v.focus):"|"===e?o.createElement(ey,{key:"divide-".concat(t)}):null})):null},ew=function(e){var t=e.onClose,n=e.children,l=(0,o.useRef)(null);return O(l,function(){null==t||t()},[l,t]),o.createElement("div",{ref:l,className:"fortune-toolbar-more-container"},n)},eN=function(e){var t=e.item,n=e.isChecked,l=e.onChange,a=e.isItemVisible,r=(0,o.useMemo)(function(){return n(t.key)},[n,t.key]);return a(t)?o.createElement("div",{className:"select-item"},o.createElement("input",{className:"filter-checkbox",type:"checkbox",checked:r,onChange:function(){l(t,!r)}}),o.createElement("div",null,t.text),o.createElement("span",{className:"count"},"( ".concat(t.rows.length," )"))):null},e_=function e(t){var n=t.item,l=t.depth,a=void 0===l?0:l,r=t.initialExpand,i=t.onExpand,s=t.isChecked,d=t.onChange,m=t.isItemVisible,h=f((0,o.useState)(r(n.key)),2),v=h[0],p=h[1],y=(0,o.useMemo)(function(){return s(n.key)},[s,n.key]);return m(n)?o.createElement("div",null,o.createElement("div",{className:"select-item",style:{marginLeft:-2+20*a},onClick:function(){null==i||i(n.key,!v),p(!v)}},c().isEmpty(n.children)?o.createElement("div",{style:{width:10}}):o.createElement("div",{className:"filter-caret ".concat(v?"down":"right"),style:{cursor:"pointer"}}),o.createElement("input",{className:"filter-checkbox",type:"checkbox",checked:y,onChange:function(){d(n,!y)},onClick:function(e){return e.stopPropagation()}}),o.createElement("div",null,n.text),o.createElement("span",{className:"count"},"( ".concat(n.rows.length," )"))),v&&n.children.map(function(t){return o.createElement(e,u({key:t.key,item:t,depth:a+1},{initialExpand:r,onExpand:i,isChecked:s,onChange:d,isItemVisible:m}))})):null},eR=function(e){var t=e.dates,n=e.initialExpand,l=e.onExpand,a=e.isChecked,r=e.onChange,c=e.isItemVisible;return o.createElement(o.Fragment,null,t.map(function(e){return o.createElement(e_,u({key:e.key,item:e},{initialExpand:n,onExpand:l,isChecked:a,onChange:r,isItemVisible:c}))}))},eM=function(){var e,t=(0,o.useContext)(k),n=t.context,r=t.setContext,i=t.settings,u=t.refs,s=(0,o.useRef)(null),d=(0,o.useRef)(n),m=(0,o.useRef)(null),v=(0,o.useRef)(null),p=n.filterContextMenu,y=p||{startRow:null,startCol:null,endRow:null,endCol:null,col:null,listBoxMaxHeight:400},E=y.startRow,C=y.startCol,b=y.endRow,x=y.endCol,w=y.col,N=y.listBoxMaxHeight,_=(0,l.SP8)(n).filter,R=f((0,o.useState)({dates:[],dateRowMap:{},values:[],valueRowMap:{},visibleRows:[],flattenValues:[]}),2),M=R[0],S=R[1],L=f((0,o.useState)([]),2),V=L[0],z=L[1],I=f((0,o.useState)([]),2),D=I[0],F=I[1],T=(0,o.useRef)({}),B=(0,o.useRef)([]),A=f((0,o.useState)([]),2),P=A[0],W=A[1],U=f((0,o.useState)(""),2),Z=U[0],j=U[1],K=f((0,o.useState)(),2),q=K[0],X=K[1],Q=f((0,o.useState)({bgColors:[],fcColors:[]}),2),Y=Q[0],G=Q[1],$=f((0,o.useState)(!1),2),J=$[0],ee=$[1],et=H().showAlert,en=(0,o.useRef)(!1);d.current=n;var el=(0,o.useCallback)(function(){r(function(e){e.filterContextMenu=void 0})},[r]);O(s,el,[el]);var eo=(0,o.useCallback)(function(e){var t=T.current[e];return null==t?(T.current[e]=!0,!0):t},[]),ea=(0,o.useCallback)(function(e,t){T.current[e]=t},[]),er=(0,o.useMemo)(function(){return c().debounce(function(e){W(c().filter(M.flattenValues,function(t){return t.toLowerCase().indexOf(e.toLowerCase())>-1}))},300)},[M.flattenValues]),ec=(0,o.useCallback)(function(){z([]),F([]),B.current=[]},[]),ei=(0,o.useCallback)(function(){z(c().keys(M.dateRowMap)),F(c().keys(M.valueRowMap)),B.current=M.visibleRows},[M.dateRowMap,M.valueRowMap,M.visibleRows]),eu=(0,o.useCallback)(function(){z((0,a.ZP)(function(e){return c().xor(e,c().keys(M.dateRowMap))})),F((0,a.ZP)(function(e){return c().xor(e,c().keys(M.valueRowMap))})),B.current=c().xor(B.current,M.visibleRows)},[M.dateRowMap,M.valueRowMap,M.visibleRows]),es=(0,o.useCallback)(function(e,t,n){G((0,a.ZP)(function(l){c().find(c().get(l,e),function(e){return e.color===t}).checked=n}))},[]),ed=(0,o.useMemo)(function(){return c().debounce(function(){en.current||ee(!1)},200)},[]),em=(0,o.useCallback)(function(e){null!=w&&r(function(t){var n=(0,l.Qqe)(t,E,C,b,x,w,e);null!=n&&et(n)})},[w,r,E,C,b,x,et]),ef=(0,o.useCallback)(function(e,t,n,l){return n.length>1?o.createElement("div",{key:e},o.createElement("div",{className:"title"},t),o.createElement("div",{className:"color-list"},n.map(function(t){return o.createElement("div",{key:t.color,className:"item",onClick:function(){return l(e,t.color,!t.checked)}},o.createElement("div",{className:"color-label",style:{backgroundColor:t.color}}),o.createElement("input",{className:"luckysheet-mousedown-cancel",type:"checkbox",checked:t.checked,onChange:function(){}}))}))):null},[]);return((0,o.useLayoutEffect)(function(){if(s.current&&p){var e,t=window.innerHeight,n=window.innerWidth,l=s.current.getBoundingClientRect(),o=null===(e=u.workbookContainer.current)||void 0===e?void 0:e.getBoundingClientRect();if(o){var a=l.width,i=p.y,d=p.x,m=!1;o.left+d+a>n&&(d-=a,m=!0),o.top+i+350>t&&(i-=350,m=!0),i<0&&(i=0,m=!0);var f=t-l.top-350;f<0&&(f=100),(p.x!==d||p.y!==i||p.listBoxMaxHeight!==f)&&r(function(e){m&&(c().set(e,"filterContextMenu.x",d),c().set(e,"filterContextMenu.y",i)),c().set(e,"filterContextMenu.listBoxMaxHeight",f)})}}},[p,r]),(0,o.useLayoutEffect)(function(){if(q){var e,t,n=null===(e=m.current)||void 0===e?void 0:e.getBoundingClientRect(),l=null===(t=v.current)||void 0===t?void 0:t.getBoundingClientRect();if(null!=n&&null!=l){var o=window.innerWidth,a=c().cloneDeep(q);l.left+l.width>o&&(a.left-=l.width,X(a))}}},[q]),(0,o.useEffect)(function(){if(null!=w){j(""),ee(!1),T.current={},B.current=(null==p?void 0:p.hiddenRows)||[];var e=(0,l.moI)(d.current,w,E,b,C);S(c().omit(e,["datesUncheck","valuesUncheck"])),z(e.datesUncheck),F(e.valuesUncheck),W(e.flattenValues)}},[w,b,E,C,B,null==p?void 0:p.hiddenRows]),(0,o.useEffect)(function(){null!=w&&G((0,l.Vcu)(d.current,w,E,b))},[w,b,E]),null==p)?null:o.createElement(o.Fragment,null,o.createElement("div",{className:"fortune-context-menu luckysheet-cols-menu fortune-filter-menu",id:"luckysheet-\\${menuid}-menu",ref:s,style:{left:p.x,top:p.y}},null===(e=i.filterContextMenu)||void 0===e?void 0:e.map(function(e,t){return"|"===e?o.createElement(ey,{key:"divider-".concat(t)}):"sort-by-asc"===e?o.createElement(ek,{key:e,onClick:function(){return em(!0)}},_.sortByAsc):"sort-by-desc"===e?o.createElement(ek,{key:e,onClick:function(){return em(!1)}},_.sortByDesc):"filter-by-color"===e?o.createElement("div",{key:e,ref:m,onMouseEnter:function(){if(s.current&&p){ee(!0);var e,t=null===(e=m.current)||void 0===e?void 0:e.getBoundingClientRect();null!=t&&X({top:t.top-5,left:t.right})}},onMouseLeave:ed},o.createElement(ek,{onClick:function(){}},o.createElement("div",{className:"filter-bycolor-container"},_.filterByColor,o.createElement("div",{className:"filter-caret right"})))):"filter-by-condition"===e?o.createElement("div",{key:"name"},o.createElement(ek,{onClick:function(){}},o.createElement("div",{className:"filter-caret right"}),_.filterByCondition),o.createElement("div",{className:"luckysheet-\\${menuid}-bycondition",style:{display:"none"}},o.createElement("div",{className:"luckysheet-flat-menu-button luckysheet-mousedown-cancel",id:"luckysheet-\\${menuid}-selected"},o.createElement("span",{className:"luckysheet-mousedown-cancel","data-value":"null","data-type":"0"},_.filiterInputNone),o.createElement("div",{className:"luckysheet-mousedown-cancel"},o.createElement("i",{className:"fa fa-sort","aria-hidden":"true"}))))):"filter-by-value"===e?o.createElement("div",{key:e},o.createElement(ek,{onClick:function(){}},o.createElement("div",{className:"filter-caret right"}),_.filterByValues),o.createElement("div",{className:"luckysheet-filter-byvalue"},o.createElement("div",{className:"fortune-menuitem-row byvalue-btn-row"},o.createElement("div",null,o.createElement("span",{className:"fortune-byvalue-btn",onClick:ec},_.filterValueByAllBtn)," - ",o.createElement("span",{className:"fortune-byvalue-btn",onClick:ei},_.filterValueByClearBtn)," - ",o.createElement("span",{className:"fortune-byvalue-btn",onClick:eu},_.filterValueByInverseBtn)),o.createElement("div",{className:"byvalue-filter-icon"},o.createElement(g,{name:"filter-fill",style:{width:20,height:20}}))),o.createElement("div",{className:"filtermenu-input-container"},o.createElement("input",{type:"text",onKeyDown:function(e){return e.stopPropagation()},placeholder:_.filterValueByTip,className:"luckysheet-mousedown-cancel",id:"luckysheet-\\${menuid}-byvalue-input",value:Z,onChange:function(e){j(e.target.value),er(e.target.value)}})),o.createElement("div",{id:"luckysheet-filter-byvalue-select",style:{maxHeight:N}},o.createElement(eR,{dates:M.dates,onExpand:ea,initialExpand:eo,isChecked:function(e){return null==c().find(V,function(t){return null!=t.match(e)})},onChange:function(e,t){var n=B.current;B.current=t?c().without.apply(c(),[n].concat(h(e.rows))):c().union(n,e.rows),z((0,a.ZP)(function(n){return t?c().without.apply(c(),[n].concat(h(e.dateValues))):c().union(n,e.dateValues)}))},isItemVisible:function(e){return P.length===M.flattenValues.length||c().findIndex(P,function(t){return null!=t.match(e.key)})>-1}}),M.values.map(function(e){return o.createElement(eN,{key:e.key,item:e,isChecked:function(e){return!c().includes(D,e)},onChange:function(e,t){var n=B.current;B.current=t?c().without.apply(c(),[n].concat(h(e.rows))):c().concat(n,e.rows),F((0,a.ZP)(function(n){t?c().pull(n,e.key):n.push(e.key)}))},isItemVisible:function(e){return P.length===M.flattenValues.length||c().includes(P,e.text)}})})))):null}),o.createElement(ey,null),o.createElement("div",{className:"fortune-menuitem-row"},o.createElement("div",{className:"button-basic button-primary",onClick:function(){null!=w&&r(function(e){var t=c().reduce(B.current,function(e,t){return e[t]=0,e},{});(0,l.YLO)(e,B.current.length>0,t,{},E,b,w,C,x),B.current=[],e.filterContextMenu=void 0})}},_.filterConform),o.createElement("div",{className:"button-basic button-default",onClick:function(){r(function(e){e.filterContextMenu=void 0})}},_.filterCancel),o.createElement("div",{className:"button-basic button-danger",onClick:function(){r(function(e){(0,l.Dgn)(e)})}},_.clearFilter))),J&&o.createElement("div",{ref:v,className:"luckysheet-filter-bycolor-submenu",style:q,onMouseEnter:function(){en.current=!0},onMouseLeave:function(){en.current=!1,ee(!1)}},Y.bgColors.length<2&&Y.fcColors.length<2?o.createElement("div",{className:"one-color-tip"},_.filterContainerOneColorTip):o.createElement(o.Fragment,null,[{key:"bgColors",title:_.filiterByColorTip,colors:Y.bgColors},{key:"fcColors",title:_.filiterByTextColorTip,colors:Y.fcColors}].map(function(e){return ef(e.key,e.title,e.colors,es)}),o.createElement("div",{className:"button-basic button-primary",onClick:function(){null!=w&&r(function(e){var t=c().reduce(c()(Y).values().flatten().map(function(e){return e.checked?[]:e.rows}).flatten().valueOf(),function(e,t){return e[t]=0,e},{});(0,l.YLO)(e,!c().isEmpty(t),t,{},E,b,w,C,x),B.current=[],e.filterContextMenu=void 0})}},_.filterConform))))},eS=function(e){var t=e.style,n=e.sheet,a=(0,o.useContext)(k),r=a.context,c=a.setContext,i=(0,o.useCallback)(function(){!1!==r.allowEdit&&n&&c(function(e){l.hi0.showSheet(e,n.id)})},[r.allowEdit,c,n]);return o.createElement("div",{style:t,onClick:function(e){e.stopPropagation(),i()},className:"fortune-sheet-hidden-button"},(null==n?void 0:n.hide)===1?o.createElement(g,{name:"hidden",width:16,height:16,style:{marginTop:"7px"}}):"")},eL=function(e){var t=e.sheet,n=e.isDropPlaceholder,a=(0,o.useContext)(k),r=a.context,c=a.setContext,i=a.refs,u=(0,o.useRef)(null);return(0,o.useEffect)(function(){c(function(e){var t,n,l,o,a=r.sheetScrollRecord[null==e?void 0:e.currentSheetId];a?(e.scrollLeft=null!==(t=a.scrollLeft)&&void 0!==t?t:0,e.scrollTop=null!==(n=a.scrollTop)&&void 0!==n?n:0,e.luckysheet_select_status=null!==(l=a.luckysheet_select_status)&&void 0!==l&&l,e.luckysheet_select_save=null!==(o=a.luckysheet_select_save)&&void 0!==o?o:void 0):(e.scrollLeft=0,e.scrollTop=0,e.luckysheet_select_status=!1,e.luckysheet_select_save=void 0),e.luckysheet_selection_range=[]})},[r.currentSheetId,r.sheetScrollRecord,c]),o.createElement("div",{className:"fortune-sheet-list-item",key:t.id,ref:u,onClick:function(){n||c(function(e){e.sheetScrollRecord[e.currentSheetId]={scrollLeft:e.scrollLeft,scrollTop:e.scrollTop,luckysheet_select_status:e.luckysheet_select_status,luckysheet_select_save:e.luckysheet_select_save,luckysheet_selection_range:e.luckysheet_selection_range},e.currentSheetId=t.id,e.zoomRatio=t.zoomRatio||1,(0,l.z96)(e,i.globalCache),(0,l.bGp)(e)})}},o.createElement("span",{className:"fortune-sheet-selected-check-sapce"},t.id===r.currentSheetId&&o.createElement(g,{name:"check",width:16,height:16,style:{lineHeight:30,verticalAlign:"middle"}})),o.createElement("span",{className:"luckysheet-sheets-item-name fortune-sheet-list-item-name",spellCheck:"false"},!!t.color&&o.createElement("div",{className:"luckysheet-sheets-list-item-color",style:{background:t.color}}),t.name),t.hide&&o.createElement(eS,{sheet:t}))},eV=function(){var e=(0,o.useContext)(k),t=e.context,n=e.setContext,l=(0,o.useRef)(null),a=(0,o.useCallback)(function(){n(function(e){e.showSheetList=!1})},[n]);return O(l,a,[a]),o.createElement("div",{className:"fortune-context-menu luckysheet-cols-menu fortune-sheet-list",ref:l},c().sortBy(t.luckysheetfile,function(e){return Number(e.order)}).map(function(e){return o.createElement(eL,{sheet:e,key:e.id})}))},eH=["onChange","onOp","data"];(0,a.vI)();var ez=function(e){e.groupValuesRefreshData.length>0&&(0,l.DEz)(e)},eI=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){t.forEach(function(t){t(e)})}},eD=o.forwardRef(function(e,t){var n,r=e.onChange,i=e.onOp,u=e.data,s=function(e,t){if(null==e)return{};var n,l,o=function(e,t){if(null==e)return{};var n,l,o={},a=Object.keys(e);for(l=0;l<a.length;l++)n=a[l],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(l=0;l<a.length;l++)n=a[l],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,eH),d=(0,o.useRef)({undoList:[],redoList:[]}),m=(0,o.useRef)(null),v=(0,o.useRef)(null),p=(0,o.useRef)(null),y=(0,o.useRef)(null),g=(0,o.useRef)(null),E=(0,o.useRef)(null),C=(0,o.useRef)(null),b=(0,o.useMemo)(function(){return{globalCache:d.current,cellInput:m,fxInput:v,canvas:p,scrollbarX:y,scrollbarY:g,cellArea:E,workbookContainer:C}},[]),x=f((0,o.useState)((0,l.OfP)(b)),2),w=x[0],N=x[1],_=(0,l.SP8)(w).formula,R=f((0,o.useState)(null),2),M=R[0],S=R[1],L=f((0,o.useState)({numberC:0,count:0,sum:0,max:0,min:0,average:""}),2),H=L[0],z=L[1],I=(0,o.useMemo)(function(){return c().assign(c().cloneDeep(l.heV),s)},h(c().values(s)));(0,o.useEffect)(function(){var e=w.luckysheet_select_save,t=s.lang;e&&z((0,l.zW1)(w,t))},[w.luckysheet_select_save]);var D=(0,o.useCallback)(function(e,t,n){var l,o,r=t.celldata,i=t.row,u=t.column,s=c().maxBy(r,"r"),d=c().maxBy(r,"c"),m=(null!==(l=null==s?void 0:s.r)&&void 0!==l?l:0)+1,f=(null!==(o=null==d?void 0:d.c)&&void 0!==o?o:0)+1;if(null!=i&&null!=u&&i>0&&u>0?(m=Math.max(m,i),f=Math.max(f,u)):(m=Math.max(m,e.defaultrowNum),f=Math.max(f,e.defaultcolumnNum)),m&&f){var h=c().times(m,function(){return c().times(f,function(){return null})});return null==r||r.forEach(function(e){h[e.r][e.c]=e.v}),e.luckysheetfile=(0,a.ZP)(e.luckysheetfile,function(e){return e[n].data=h,delete e[n].celldata,e}),h}return null},[]),F=(0,o.useCallback)(function(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];i&&i((0,l.YnG)(e,t,n,o))},[i]);function T(e){for(var t=[],n=0;n<(null==e?void 0:e.length);n+=1)for(var l,o=0;o<(null===(l=e[n])||void 0===l?void 0:l.length);o+=1)null!==e[n][o]&&t.push({r:n,c:o,v:e[n][o]});return t}var B=(0,o.useCallback)(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};N(function(n){var o,r,i,u=f((0,a.aS)(n,eI(e,ez)),3),s=u[0],m=u[1],h=u[2];if(m.length>0&&!t.noHistory){t.logPatch&&console.info("patch",m);var v=(0,l.Pkk)(m),p=(0,l.Pkk)(h);if(p.length>0){if(t.id=n.currentSheetId,t.deleteSheetOp){if(n.luckysheetfile.filter(function(e){var n;return e.id===(null===(n=t.deleteSheetOp)||void 0===n?void 0:n.id)})){var y=(0,l.Q8D)(n,t.deleteSheetOp.id);t.deletedSheet={id:t.deleteSheetOp.id,index:y,value:c().cloneDeep(n.luckysheetfile[y])},t.deletedSheet.value.celldata=T(t.deletedSheet.value.data),delete t.deletedSheet.value.data,t.deletedSheet.value.status=0,p=[{op:"add",path:["luckysheetfile",0],value:t.deletedSheet.value}]}}else t.addSheetOp&&(t.addSheet={},t.addSheet.id=s.luckysheetfile[s.luckysheetfile.length-1].id);d.current.undoList.push({patches:v,inversePatches:p,options:t}),d.current.redoList=[],F(s,v,t)}}else(null==m?void 0:null===(o=m[0])||void 0===o?void 0:null===(r=o.value)||void 0===r?void 0:r.length)<(null==n?void 0:null===(i=n.luckysheetfile)||void 0===i?void 0:i.length)&&function(e,t){var n=e.luckysheetfile.map(function(e){return e.id}),o=d.current.undoList.filter(function(e){var t;return null===(t=e.options)||void 0===t?void 0:t.deleteSheetOp}).map(function(e){var t,n;return null===(t=e.options)||void 0===t?void 0:null===(n=t.deleteSheetOp)||void 0===n?void 0:n.id});if(d.current.undoList=d.current.undoList.filter(function(e){var t,l,a,r;return(null===(t=e.options)||void 0===t?void 0:t.deleteSheetOp)||(null===(l=e.options)||void 0===l?void 0:l.id)===void 0||-1!==c().indexOf(n,null===(a=e.options)||void 0===a?void 0:a.id)||-1!==c().indexOf(o,null===(r=e.options)||void 0===r?void 0:r.id)}),t.luckysheetfile.length>e.luckysheetfile.length){var a=t.luckysheetfile.filter(function(t){return -1===c().indexOf(e.luckysheetfile.map(function(e){return e.id}),t.id)}).map(function(e){return(0,l.Q8D)(t,e.id)})[0];d.current.undoList=d.current.undoList.map(function(e){return e.patches=e.patches.map(function(e){return"number"==typeof e.path[1]&&e.path[1]>a&&(e.path[1]-=1),e}),e.inversePatches=e.inversePatches.map(function(e){return"number"==typeof e.path[1]&&e.path[1]>a&&(e.path[1]-=1),e}),e})}}(s,n);return s})},[F]),A=(0,o.useCallback)(function(){var e=d.current.undoList.pop();e&&N(function(t){if(null===(n=e.options)||void 0===n?void 0:n.deleteSheetOp){e.inversePatches[0].path[1]=t.luckysheetfile.length;var n,o,r,i,u=null===(r=e.options.deletedSheet)||void 0===r?void 0:null===(i=r.value)||void 0===i?void 0:i.order,s=t.luckysheetfile.filter(function(t){var n,l;return(null==t?void 0:t.order)>=u&&t.id!==(null==e?void 0:null===(n=e.options)||void 0===n?void 0:null===(l=n.deleteSheetOp)||void 0===l?void 0:l.id)});c().forEach(s,function(n){e.inversePatches.push({op:"replace",path:["luckysheetfile",(0,l.Q8D)(t,n.id),"order"],value:(null==n?void 0:n.order)+1})})}var m=(0,a.QE)(t,e.inversePatches);d.current.redoList.push(e);var f=(0,l.IRg)(e.options);if((null==f?void 0:f.insertRowColOp)&&(f.restoreDeletedCells=!0),null===(o=e.options)||void 0===o?void 0:o.addSheetOp){var h,v=(0,l.Q8D)(t,e.options.addSheet.id);f.addSheet={id:e.options.addSheet.id,index:v,value:c().cloneDeep(t.luckysheetfile[v])},f.addSheet.value.celldata=T(null===(h=f.addSheet.value)||void 0===h?void 0:h.data),delete f.addSheet.value.data}return F(m,e.inversePatches,f,!0),m})},[F]),P=(0,o.useCallback)(function(){var e=d.current.redoList.pop();e&&N(function(t){var n=(0,a.QE)(t,e.patches);return d.current.undoList.push(e),F(n,e.patches,e.options),n})},[F]);(0,o.useEffect)(function(){if(null!=w.luckysheet_select_save){var e,t;null===(e=I.hooks)||void 0===e||null===(t=e.afterSelectionChange)||void 0===t||t.call(e,w.currentSheetId,w.luckysheet_select_save[0])}},[w.currentSheetId,w.luckysheet_select_save,I.hooks]);var W=(0,o.useMemo)(function(){return{context:w,setContext:B,settings:I,handleUndo:A,handleRedo:P,refs:b}},[w,P,A,I,b,B]);(0,o.useEffect)(function(){c().isEmpty(w.luckysheetfile)||null==r||r(w.luckysheetfile)},[w.luckysheetfile,r]),(0,o.useEffect)(function(){B(function(e){if(e.defaultcolumnNum=I.column,e.defaultrowNum=I.row,e.defaultFontSize=I.defaultFontSize,c().isEmpty(e.luckysheetfile)){var t,n,o,r,i,s,d,m,f,h,v,p,y,k,g,E=(0,a.ZP)(u,function(e){(0,l.$ig)(e,I.generateSheetId)});e.luckysheetfile=E,E.forEach(function(t){var n,o=(0,l.Q8D)(e,t.id),a=null===(n=e.luckysheetfile)||void 0===n?void 0:n[o];D(e,a,o)})}I.devicePixelRatio>0&&(e.devicePixelRatio=I.devicePixelRatio),e.lang=I.lang,e.allowEdit=I.allowEdit,e.hooks=I.hooks,c().isEmpty(e.currentSheetId)&&(0,l.OPT)(e);var C=(0,l.Q8D)(e,e.currentSheetId);if(null==C&&(null!==(o=null===(r=e.luckysheetfile)||void 0===r?void 0:r.length)&&void 0!==o?o:0)>0&&(C=0,e.currentSheetId=e.luckysheetfile[0].id),null!=C){var b=null===(t=e.luckysheetfile)||void 0===t?void 0:t[C];if(b){var x=b.data;if(c().isEmpty(x)){var w=D(e,b,C);c().isNull(w)||(x=w)}if(c().isEmpty(e.luckysheet_select_save)&&!c().isEmpty(b.luckysheet_select_save)&&(e.luckysheet_select_save=b.luckysheet_select_save),(null===(n=e.luckysheet_select_save)||void 0===n?void 0:n.length)===0&&((null===(i=x)||void 0===i?void 0:null===(s=i[0])||void 0===s?void 0:null===(d=s[0])||void 0===d?void 0:d.mc)&&!c().isNil(null===(m=x)||void 0===m?void 0:null===(f=m[0])||void 0===f?void 0:null===(h=f[0])||void 0===h?void 0:null===(v=h.mc)||void 0===v?void 0:v.rs)&&!c().isNil(null===(p=x)||void 0===p?void 0:null===(y=p[0])||void 0===y?void 0:null===(k=y[0])||void 0===k?void 0:null===(g=k.mc)||void 0===g?void 0:g.cs)?e.luckysheet_select_save=[{row:[0,x[0][0].mc.rs-1],column:[0,x[0][0].mc.cs-1]}]:e.luckysheet_select_save=[{row:[0,0],column:[0,0]}]),e.config=c().isNil(b.config)?{}:b.config,e.insertedImgs=b.images,e.zoomRatio=c().isNil(b.zoomRatio)?1:b.zoomRatio,e.rowHeaderWidth=I.rowHeaderWidth*e.zoomRatio,e.columnHeaderHeight=I.columnHeaderHeight*e.zoomRatio,c().isNil(b.defaultRowHeight)?e.defaultrowlen=I.defaultRowHeight:e.defaultrowlen=Number(b.defaultRowHeight),c().isNil(b.addRows)?e.addDefaultRows=I.addRows:e.addDefaultRows=Number(b.addRows),c().isNil(b.defaultColWidth)?e.defaultcollen=I.defaultColWidth:e.defaultcollen=Number(b.defaultColWidth),c().isNil(b.showGridLines))e.showGridLines=!0;else{var N=b.showGridLines;0===N||!1===N?e.showGridLines=!1:e.showGridLines=!0}if(c().isNil(I.lang)){var _=navigator.languages&&navigator.languages[0]||navigator.language||navigator.userLanguage;e.lang=_}}}},{noHistory:!0})},[w.currentSheetId,w.luckysheetfile.length,u,I.defaultRowHeight,I.defaultColWidth,I.column,I.row,I.defaultFontSize,I.devicePixelRatio,I.lang,I.allowEdit,I.hooks,I.generateSheetId,B,D,I.rowHeaderWidth,I.columnHeaderHeight,I.addRows]);var O=(0,o.useCallback)(function(e){var t=e.nativeEvent;if((e.ctrlKey||e.metaKey)&&"KeyZ"===e.code){e.shiftKey?P():A(),e.stopPropagation();return}if((e.ctrlKey||e.metaKey)&&"KeyY"===e.code){P(),e.stopPropagation(),e.preventDefault();return}B(function(e){(0,l.U8x)(e,m.current,v.current,t,d.current,A,P,p.current.getContext("2d"))})},[P,A,B]),U=(0,o.useCallback)(function(e){var t;if(m.current===document.activeElement||(null===(t=document.activeElement)||void 0===t?void 0:t.className)==="fortune-sheet-overlay"){var n=e.clipboardData;n||(n=window.clipboardData);var o=n.getData("text/html")||n.getData("text/plain"),a=document.createElement("div");a.innerHTML=o;var r=a.querySelectorAll("table tr").length+w.luckysheet_select_save[0].row[0]-w.luckysheetfile[(0,l.Q8D)(w,w.currentSheetId)].data.length,c=w.luckysheet_select_save;if(r>0){var i={type:"row",index:w.luckysheetfile[(0,l.Q8D)(w,w.currentSheetId)].data.length-1,count:r,direction:"rightbottom",id:w.currentSheetId};B(function(e){(0,l.mco)(e,i),e.luckysheet_select_save=c},{insertRowColOp:i})}B(function(t){try{(0,l.a9q)(t,e)}catch(e){console.error(e)}})}},[w,B]),Z=(0,o.useCallback)(function(){S(null)},[]);(0,o.useEffect)(function(){return document.addEventListener("paste",U),function(){document.removeEventListener("paste",U)}},[U]),(0,o.useImperativeHandle)(t,function(){var e,t,n;return e=m.current,t=y.current,n=g.current,{applyOp:function(e){B(function(t){var n=f((0,l.BO7)(t,e),2),o=n[0],r=n[1];if(r.length>0){var i=f(r,1)[0];if("insertRowCol"===i.op)try{(0,l.mco)(t,i.value,!1)}catch(e){console.error(e)}else if("deleteRowCol"===i.op)(0,l.Omi)(t,i.value);else if("addSheet"===i.op){var u,s,d,m,h,v,p,y,k=null===(v=o.filter(function(e){return"name"===e.path[0]}))||void 0===v?void 0:null===(p=v[0])||void 0===p?void 0:p.value;(null===(y=i.value)||void 0===y?void 0:y.id)&&(0,l.AaX)(t,I,i.value.id,!1,k,i.value);var g=(0,l.Q8D)(t,i.value.id);l.hi0.initSheetData(t,g,i.value)}else"deleteSheet"===i.op&&((0,l.s09)(t,i.value.id),o.length=0)}if((null===(u=e[0])||void 0===u?void 0:null===(s=u.path)||void 0===s?void 0:s[0])==="filter_select")t.luckysheet_filter_save=e[0].value;else if((null===(d=e[0])||void 0===d?void 0:null===(m=d.path)||void 0===m?void 0:m[0])==="hide"&&t.currentSheetId===e[0].id){var E=t.luckysheetfile.filter(function(t){return(c().isUndefined(t.hide)||(null==t?void 0:t.hide)!==1)&&t.id!==e[0].id});t.currentSheetId=c().sortBy(E,function(e){return e.order})[0].id}if((0,l.DjA)(t,t.luckysheet_filter_save,null===(h=e[0])||void 0===h?void 0:h.id),0!==o.length)try{(0,a.QE)(t,o)}catch(e){console.error(e)}},{noHistory:!0})},getCellValue:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return l.hi0.getCellValue(w,e,t,n)},setCellValue:function(t,n,o){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return B(function(r){return l.hi0.setCellValue(r,t,n,o,e,a)})},clearCell:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return B(function(o){return l.hi0.clearCell(o,e,t,n)})},setCellFormat:function(e,t,n,o){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return B(function(r){return l.hi0.setCellFormat(r,e,t,n,o,a)})},autoFillCell:function(e,t,n){return B(function(o){return l.hi0.autoFillCell(o,e,t,n)})},freeze:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return B(function(o){return l.hi0.freeze(o,e,t,n)})},insertRowOrColumn:function(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"rightbottom",a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return B(function(r){return l.hi0.insertRowOrColumn(r,e,t,n,o,a)})},deleteRowOrColumn:function(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return B(function(a){return l.hi0.deleteRowOrColumn(a,e,t,n,o)})},setRowHeight:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return B(function(o){return l.hi0.setRowHeight(o,e,t,n)})},setColumnWidth:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return B(function(o){return l.hi0.setColumnWidth(o,e,t,n)})},getRowHeight:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return l.hi0.getRowHeight(w,e,t)},getColumnWidth:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return l.hi0.getColumnWidth(w,e,t)},getSelection:function(){return l.hi0.getSelection(w)},getFlattenRange:function(e){return l.hi0.getFlattenRange(w,e)},getCellsByFlattenRange:function(e){return l.hi0.getCellsByFlattenRange(w,e)},getSelectionCoordinates:function(){return l.hi0.getSelectionCoordinates(w)},getCellsByRange:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return l.hi0.getCellsByRange(w,e,t)},getHtmlByRange:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return l.hi0.getHtmlByRange(w,e,t)},setSelection:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return B(function(n){return l.hi0.setSelection(n,e,t)})},setCellValuesByRange:function(t,n){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return B(function(a){return l.hi0.setCellValuesByRange(a,t,n,e,o)})},setCellFormatByRange:function(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return B(function(a){return l.hi0.setCellFormatByRange(a,e,t,n,o)})},mergeCells:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return B(function(o){return l.hi0.mergeCells(o,e,t,n)})},cancelMerge:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return B(function(n){return l.hi0.cancelMerge(n,e,t)})},getAllSheets:function(){return l.hi0.getAllSheets(w)},getSheet:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return l.hi0.getSheetWithLatestCelldata(w,e)},addSheet:function(){return B(function(e){return l.hi0.addSheet(e,I)})},deleteSheet:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return B(function(t){return l.hi0.deleteSheet(t,e)})},updateSheet:function(e){return B(function(t){return l.hi0.updateSheet(t,e)})},activateSheet:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return B(function(t){return l.hi0.activateSheet(t,e)})},setSheetName:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return B(function(n){return l.hi0.setSheetName(n,e,t)})},setSheetOrder:function(e){return B(function(t){return l.hi0.setSheetOrder(t,e)})},scroll:function(e){return l.hi0.scroll(w,t,n,e)},addPresences:function(e){B(function(t){t.presences=c().differenceBy(t.presences||[],e,function(e){return null==e.userId?e.username:e.userId}).concat(e)})},removePresences:function(e){B(function(t){null!=t.presences&&(t.presences=c().differenceBy(t.presences,e,function(e){return null==e.userId?e.username:e.userId}))})},handleUndo:A,handleRedo:P,calculateFormula:function(){B(function(e){c().forEach(e.luckysheetfile,function(t){l.hi0.calculateSheetFromula(e,t.id)})})},dataToCelldata:function(e){return l.hi0.dataToCelldata(e)},celldataToData:function(e,t,n){return l.hi0.celldataToData(e,t,n)}}},[w,B,A,P,I]);var K=(0,l.Q8D)(w,w.currentSheetId);if(null==K)return null;var q=null===(n=w.luckysheetfile)||void 0===n?void 0:n[K];return q?o.createElement(k.Provider,{value:W},o.createElement(V,null,o.createElement("div",{className:"fortune-container",ref:C,onKeyDown:O},o.createElement(eC,null),o.createElement("div",{className:"fortune-workarea"},I.showToolbar&&o.createElement(es,{moreItemsOpen:null!==M,setMoreItems:S}),I.showFormulaBar&&o.createElement(em,null)),o.createElement(j,{sheet:q}),I.showSheetTabs&&o.createElement(ep,null),o.createElement(eE,null),o.createElement(eM,null),o.createElement(ex,null),w.showSheetList&&o.createElement(eV,null),M&&o.createElement(ew,{onClose:Z},M),!c().isEmpty(w.contextMenu)&&o.createElement("div",{onMouseDown:function(){B(function(e){e.contextMenu={},e.filterContextMenu=void 0,e.showSheetList=void 0})},onMouseMove:function(e){return e.stopPropagation()},onMouseUp:function(e){return e.stopPropagation()},onContextMenu:function(e){e.preventDefault(),e.stopPropagation()},className:"fortune-popover-backdrop"}),o.createElement("div",{className:"fortune-stat-area"},o.createElement("div",{className:"luckysheet-sheet-selection-calInfo"},!!H.count&&o.createElement("div",{style:{width:"60px"}},_.count,": ",H.count),!!H.numberC&&!!H.sum&&o.createElement("div",null,_.sum,": ",H.sum),!!H.numberC&&!!H.average&&o.createElement("div",null,_.average,": ",H.average),!!H.numberC&&!!H.max&&o.createElement("div",null,_.max,": ",H.max),!!H.numberC&&!!H.min&&o.createElement("div",null,_.min,": ",H.min)))))):null})}}]);